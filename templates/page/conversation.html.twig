{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ encore_entry_link_tags('app') }}
{% endblock %}

{% block body %}
    
    <div><a href="/">Back to conversations</a></div>
    <ul id="chat-list">
        {% for message in messages %}

            <li>{{ message.getCreatedBy().getDisplayName() == app.user.displayName ? 'me' : message.getCreatedBy().getDisplayName() }}: {{ message.content }}</li>
        
        {% endfor %}
    </ul>

    <div>
        <textarea id="form-message" placeholder="Your public message here"></textarea>
        <input type="button" id="form-submit" value="Send message"/>

    </div>


    <div>Users in conversation:</div>
    <ul>
        {% for user in conversation.getUsers() %}
            <li>{{ user.username }}</li>
        {% endfor %}
    </ul>

    <div>Available users:</div>
    <ul>
        {% for user in users %}
            <li>{{ user.username }}</li>
        {% endfor %}
    </ul>

{% endblock %}

{% block javascripts %}
    <script type="text/javascript">
        var clientInformation = {
            username: '{{ app.user.username }}',
            wsConversationRoute: 'conversation/{{ conversation.id }}',
            conversationId: {{ conversation.id }},
            displayName: '{{ app.user.displayName }}'
        };
    </script>
    <script type="text/javascript" src="{{ asset('bundles/goswebsocket/js/vendor/autobahn.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/goswebsocket/js/gos_web_socket_client.js') }}"></script>
    {{ encore_entry_script_tags('app') }}
{% endblock %}