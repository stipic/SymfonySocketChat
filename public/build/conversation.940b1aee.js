(window.webpackJsonp=window.webpackJsonp||[]).push([["conversation"],{k6dk:function(e,n,o){(function(e){o("ng4s");var n=window.location.hostname,s=WS.connect("ws://"+n+":5510");s.on("socket/connect",function(n){function o(e){e.scrollTop=e.scrollHeight}o(document.getElementById("content"));var s={appendMessage:function(n){e("#message-zone").append(n),o(document.getElementById("content"))},appendMessageChunk:function(n){e("#message-zone").is(":empty")?(console.log("CHUNK #1"),e("#org-msg-zone .message:last").find(".text").append(n)):(console.log("CHUNK #2"),e("#message-zone .message:last-child").find(".text").append(n)),o(document.getElementById("content"))}};function t(e){n.subscribe(e,function(e,n){"msg_block"==n.msg.msgType?(console.log("Blok"),s.appendMessage(n.msg.template)):(console.log("Chunk"),s.appendMessageChunk(n.msg.template))})}e(document).on("click","#submit-message",function(o){o.preventDefault();var s=e("#form-message").val();s&&e.ajax({url:"/message/"+clientInformation.conversationId+"/new",type:"POST",data:{message:s},complete:function(e){}}),e("#form-message").val(""),n.publish(clientInformation.wsConversationRoute+"/notifications","")}),document.getElementById("form-message").focus(),e(document).on("keypress","#form-message",function(n){13===n.keyCode&&(e("#submit-message").trigger("click"),e("#form-message").val(""))}),e(document).on("input","#form-message",function(o){o.preventDefault();var s=e("#form-message").val();n.publish(clientInformation.wsConversationRoute+"/notifications",s)}),t(clientInformation.wsConversationRoute),e(document).on("click",".discussions li",function(s){s.preventDefault(),e(".discussions li").removeClass("active"),e(this).addClass("active");var i=e(this).attr("data-cid");window.history.pushState({foo:"bar"},"Conversation","/conversation/"+i),n.unsubscribe(clientInformation.wsConversationRoute),clientInformation.wsConversationRoute="conversation/"+i,clientInformation.conversationId=i,t(clientInformation.wsConversationRoute),e.ajax({url:"/message/"+i+"/section",type:"GET",success:function(n){e("#msg-section").remove(),e(n).insertAfter("#sidebar"),o(document.getElementById("content"))}})}),n.subscribe("online",function(n,o){var s=JSON.parse(o);e("li[data-usid]").each(function(n){var o=e(this).attr("data-usid");for(var t in e('li[data-usid="'+o+'"]').find(".user-details").removeClass("online"),s)s.hasOwnProperty(t)&&t==o&&e('li[data-usid="'+o+'"]').find(".user-details").addClass("online")})}),console.log("Successfully Connected!")}),s.on("socket/disconnect",function(e){console.log("Disconnected for "+e.reason+" with code "+e.code)})}).call(this,o("EVdn"))}},[["k6dk","runtime",1,0]]]);