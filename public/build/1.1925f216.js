(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"0m6P":function(e,t,n){(function(n){var i,o,s;o=[],void 0===(s="function"==typeof(i=function(){"use strict";function e(e,t){if(!e)return console.warn("Tagify: ","invalid input element ",e),this;this.applySettings(e,t),this.state={},this.value=[],this.listeners={},this.DOM={},this.extend(this,new this.EventDispatcher(this)),this.build(e),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),e.autofocus&&this.DOM.input.focus()}return e.prototype={isIE:window.document.documentMode,TEXTS:{empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},DEFAULTS:{delimiters:",",pattern:null,maxTags:1/0,callbacks:{},addTagOnBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,keepInvalidTags:!1,autoComplete:!0,mixTagsAllowedAfter:/,|\.|\:|\s/,backspace:!0,dropdown:{classname:"",enabled:2,maxItems:10,itemTemplate:"",fuzzySearch:!1}},customEventsList:["click","add","remove","invalid","input","edit"],applySettings:function(e,t){var n=e.getAttribute("data-whitelist"),i=e.getAttribute("data-blacklist");if(this.settings=this.extend({},this.DEFAULTS,t),this.settings.readonly=e.hasAttribute("readonly"),this.isIE&&(this.settings.autoComplete=!1),i&&(i=i.split(this.settings.delimiters))instanceof Array&&(this.settings.blacklist=i),n&&(n=n.split(this.settings.delimiters))instanceof Array&&(this.settings.whitelist=n),e.pattern)try{this.settings.pattern=new RegExp(e.pattern)}catch(e){}if(this.settings&&this.settings.delimiters)try{this.settings.delimiters=new RegExp("["+this.settings.delimiters+"]","g")}catch(e){}},parseHTML:function(e){return(new DOMParser).parseFromString(e.trim(),"text/html").body.firstElementChild},escapeHtml:function(e){var t=document.createTextNode(e),n=document.createElement("p");return n.appendChild(t),n.innerHTML},build:function(e){var t=this.DOM,n='<tags class="tagify '+(this.settings.mode?"tagify--mix":"")+" "+e.className+'" '+(this.settings.readonly?"readonly":"")+'>\n                            <span contenteditable data-placeholder="'+(e.placeholder||"&#8203;")+'" class="tagify__input"></span>\n                        </tags>';t.originalInput=e,t.scope=this.parseHTML(n),t.input=t.scope.querySelector("[contenteditable]"),e.parentNode.insertBefore(t.scope,e),0<=this.settings.dropdown.enabled&&this.dropdown.init.call(this)},destroy:function(){this.DOM.scope.parentNode.removeChild(this.DOM.scope)},loadOriginalValues:function(){var e=this.DOM.originalInput.value;if(e){try{e=JSON.parse(e)}catch(e){}"mix"==this.settings.mode?this.parseMixTags(e):this.addTags(e).forEach(function(e){e&&e.classList.add("tagify--noAnim")})}},extend:function(e,t,n){function i(e){var t=Object.prototype.toString.call(e).split(" ")[1].slice(0,-1);return e===Object(e)&&"Array"!=t&&"Function"!=t&&"RegExp"!=t&&"HTMLUnknownElement"!=t}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(i(t[n])?i(e[n])?o(e[n],t[n]):e[n]=Object.assign({},t[n]):e[n]=t[n])}return e instanceof Object||(e={}),o(e,t),n&&o(e,n),e},EventDispatcher:function(e){var t=document.createTextNode("");this.off=function(e,n){return n&&t.removeEventListener.call(t,e,n),this},this.on=function(e,n){return n&&t.addEventListener.call(t,e,n),this},this.trigger=function(i,o){var s;if(i)if(e.settings.isJQueryPlugin)n(e.DOM.originalInput).triggerHandler(i,[o]);else{try{s=new CustomEvent(i,{detail:o})}catch(i){console.warn(i)}t.dispatchEvent(s)}}},events:{customBinding:function(){var e=this;this.customEventsList.forEach(function(t){e.on(t,e.settings.callbacks[t])})},binding:function(){var e,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],i=this.events.callbacks,o=t?"addEventListener":"removeEventListener";for(var s in t&&!this.listeners.main&&(this.DOM.input.addEventListener(this.isIE?"keydown":"input",i[this.isIE?"onInputIE":"onInput"].bind(this)),this.settings.isJQueryPlugin&&n(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{paste:["input",i.onPaste.bind(this)],focus:["input",i.onFocusBlur.bind(this)],blur:["input",i.onFocusBlur.bind(this)],keydown:["input",i.onKeydown.bind(this)],click:["scope",i.onClickScope.bind(this)],dblclick:["scope",i.onDoubleClickScope.bind(this)]})this.DOM[e[s][0]][o](s,e[s][1])},callbacks:{onFocusBlur:function(e){var t=e.target.textContent.trim();"mix"!=this.settings.mode&&("focus"==e.type?(this.DOM.scope.classList.add("tagify--focus"),0===this.settings.dropdown.enabled&&this.dropdown.show.call(this)):"blur"==e.type?(this.DOM.scope.classList.remove("tagify--focus"),t&&this.settings.addTagOnBlur&&this.addTags(t,!0).length):(this.DOM.input.removeAttribute("style"),this.dropdown.hide.call(this)))},onKeydown:function(e){var t,n,i=this,o=e.target.textContent;if("mix"==this.settings.mode){switch(e.key){case"Backspace":var s=[];n=this.DOM.input.children,setTimeout(function(){[].forEach.call(n,function(e){return s.push(e.getAttribute("value"))}),i.value=i.value.filter(function(e){return-1!=s.indexOf(e.value)})},20);break;case"Enter":e.preventDefault()}return!0}switch(e.key){case"Backspace":""!=o&&8203!=o.charCodeAt(0)||(t=(t=this.DOM.scope.querySelectorAll("tag:not(.tagify--hide):not([readonly])"))[t.length-1],!0===this.settings.backspace?this.removeTag(t):"edit"==this.settings.backspace&&this.editTag(t));break;case"Esc":case"Escape":this.input.set.call(this),e.target.blur();break;case"ArrowRight":case"Tab":if(!o)return!0;case"Enter":e.preventDefault(),this.addTags(this.input.value,!0)}},onInput:function(e){var t=this.input.normalize.call(this),n=t.length>=this.settings.dropdown.enabled;if("mix"==this.settings.mode)return this.events.callbacks.onMixTagsInput.call(this,e);t?this.input.value!=t&&(this.input.set.call(this,t,!1),this.trigger("input",t),-1!=t.search(this.settings.delimiters)?this.addTags(t).length&&this.input.set.call(this):0<=this.settings.dropdown.enabled&&this.dropdown[n?"show":"hide"].call(this,t)):this.input.set.call(this,"")},onMixTagsInput:function(e){var t,n,i,o,s;if(this.maxTagsReached())return!0;window.getSelection&&0<(t=window.getSelection()).rangeCount&&((n=t.getRangeAt(0).cloneRange()).collapse(!0),n.setStart(window.getSelection().focusNode,0),(o=(i=n.toString().split(this.settings.mixTagsAllowedAfter))[i.length-1].match(this.settings.pattern))&&(this.state.tag={prefix:o[0],value:o.input.split(o[0])[1]},o=this.state.tag,s=this.state.tag.value.length>=this.settings.dropdown.enabled)),this.update(),this.trigger("input",this.extend({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[s?"show":"hide"].call(this,this.state.tag.value)},onInputIE:function(e){var t=this;setTimeout(function(){t.events.callbacks.onInput.call(t,e)})},onPaste:function(e){},onClickScope:function(e){var t,n=e.target.closest("tag");"TAGS"==e.target.tagName?this.DOM.input.focus():"X"==e.target.tagName?this.removeTag(e.target.parentNode):n&&(t=this.getNodeIndex(n),this.trigger("click",{tag:n,index:t,data:this.value[t]}))},onEditTagInput:function(e){var t=e.closest("tag"),n=this.getNodeIndex(t),i=this.input.normalize(e),o=i==e.originalValue||this.validateTag(i);t.classList.toggle("tagify--invalid",!0!==o),t.isValid=o,this.trigger("input",{tag:t,index:n,data:this.extend({},this.value[n],{newValue:i})})},onEditTagBlur:function(e){var t,n=e.closest("tag"),i=this.getNodeIndex(n),o=this.input.normalize(e)||e.originalValue,s=n.isValid;void 0!==s&&!0!==s||(e.textContent=o,this.value[i].value=o,this.update(),(t=e.cloneNode(!0)).removeAttribute("contenteditable"),n.title=o,n.classList.remove("tagify--editable"),e.parentNode.replaceChild(t,e),this.trigger("edit",{tag:n,index:i,data:this.value[i]}))},onEditTagkeydown:function(e){switch(e.key){case"Esc":case"Escape":e.target.textContent=e.target.originalValue;case"Enter":case"Tab":e.preventDefault(),e.target.blur()}},onDoubleClickScope:function(e){var t=e.target.closest("tag"),n=this.settings;"mix"==n.mode||n.readonly||n.enforceWhitelist||!t||t.classList.contains("tagify--editable")||t.hasAttribute("readonly")||this.editTag(t)}}},editTag:function(e){var t=this,n=e.querySelector(".tagify__tag-text"),i=this.events.callbacks;n?(e.classList.add("tagify--editable"),n.originalValue=n.textContent,n.setAttribute("contenteditable",!0),n.addEventListener("blur",i.onEditTagBlur.bind(this,n)),n.addEventListener("input",i.onEditTagInput.bind(this,n)),n.addEventListener("keydown",function(e){return i.onEditTagkeydown.call(t,e)}),n.focus()):console.warn("Cannot find element in Tag template: ",".tagify__tag-text")},input:{value:"",set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.input.value=e,t&&(this.DOM.input.innerHTML=e),e||this.dropdown.hide.call(this),e.length<2&&this.input.autocomplete.suggest.call(this,""),this.input.validate.call(this)},setRangeAtStartEnd:function(){var e,t,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0],i=arguments[1];document.createRange&&((e=document.createRange()).selectNodeContents(i||this.DOM.input),e.collapse(n),(t=window.getSelection()).removeAllRanges(),t.addRange(e))},validate:function(){var e=!this.input.value||this.validateTag.call(this,this.input.value);this.DOM.input.classList.toggle("tagify__input--invalid",!0!==e)},normalize:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.DOM.input).innerText;return"settings"in this&&(e=e.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(1))),e=e.replace(/\s/g," ").replace(/^\s+/,"")},autocomplete:{suggest:function(e){e&&this.input.value?this.DOM.input.setAttribute("data-suggest",e.substring(this.input.value.length)):this.DOM.input.removeAttribute("data-suggest")},set:function(e){var t=this.DOM.input.getAttribute("data-suggest"),n=e||(t?this.input.value+t:null);return!!n&&(this.input.set.call(this,n),this.input.autocomplete.suggest.call(this,""),this.dropdown.hide.call(this),this.input.setRangeAtStartEnd.call(this),!0)}}},getNodeIndex:function(e){var t=0;if(e)for(;e=e.previousElementSibling;)t++;return t},isTagDuplicate:function(e){return this.value.findIndex(function(t){return e.trim().toLowerCase()===t.value.toLowerCase()})},getTagIndexByValue:function(e){var t=[];return this.DOM.scope.querySelectorAll("tag").forEach(function(n,i){n.textContent.trim().toLowerCase()==e.toLowerCase()&&t.push(i)}),t},getTagElmByValue:function(e){var t=this.getTagIndexByValue(e)[0];return this.DOM.scope.querySelectorAll("tag")[t]},markTagByValue:function(e,t){return!!(t=t||this.getTagElmByValue(e))&&(t.classList.add("tagify--mark"),t)},isTagBlacklisted:function(e){return e=e.toLowerCase().trim(),this.settings.blacklist.filter(function(t){return e==t.toLowerCase()}).length},isTagWhitelisted:function(e){return this.settings.whitelist.some(function(t){if((t.value||t).toLowerCase()===e.toLowerCase())return!0})},validateTag:function(e){var t=e.trim(),n=!0;return t?this.settings.pattern&&!this.settings.pattern.test(t)?n=this.TEXTS.pattern:this.settings.duplicates||-1===this.isTagDuplicate(t)?(this.isTagBlacklisted(t)||this.settings.enforceWhitelist&&!this.isTagWhitelisted(t))&&(n=this.TEXTS.notAllowed):n=this.TEXTS.duplicate:n=this.TEXTS.empty,n},maxTagsReached:function(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},normalizeTags:function(e){var t=this,n=this.settings.whitelist[0]instanceof Object,i=e instanceof Array&&e[0]instanceof Object&&"value"in e[0],o=[];if(i)return e;if("number"==typeof e&&(e=e.toString()),"string"==typeof e){if(!e.trim())return[];e=e.split(this.settings.delimiters).filter(function(e){return e}).map(function(e){return{value:e.trim()}})}else e instanceof Array&&(e=e.map(function(e){return{value:e.trim()}}));return n?(e.forEach(function(e){var n=t.settings.whitelist.filter(function(t){return t.value.toLowerCase()==e.value.toLowerCase()});n[0]?o.push(n[0]):"mix"!=t.settings.mode&&o.push(e)}),o):e},parseMixTags:function(e){var t=this;return e.split(this.settings.mixTagsAllowedAfter).filter(function(e){return e.match(t.settings.pattern)}).forEach(function(n){var i,o=n.replace(t.settings.pattern,"");t.isTagWhitelisted(o)&&!t.settings.duplicates&&-1==t.isTagDuplicate(o)&&(i=t.normalizeTags.call(t,o)[0],e=t.replaceMixStringWithTag(e,n,i).s)}),this.DOM.input.innerHTML=e,this.update(),e},replaceMixStringWithTag:function(e,t,n,i){return n&&e&&-1!=e.indexOf(t)&&(i=this.createTagElem(n),this.value.push(n),e=e.replace(t,i.outerHTML+"&#8288;")),{s:e,tagElm:i}},addMixTag:function(e){if(e&&this.state.tag){for(var t,n,i,o,s=this.state.tag.prefix+this.state.tag.value,r=document.createNodeIterator(this.DOM.input,NodeFilter.SHOW_TEXT),a=100;(t=r.nextNode())&&a--;)if(t.nodeType===Node.TEXT_NODE){if(-1==(i=t.nodeValue.indexOf(s)))continue;o=t.splitText(i),n=this.createTagElem(e),o.nodeValue=o.nodeValue.replace(s,""),t.parentNode.insertBefore(n,o),n.insertAdjacentHTML("afterend","&#8288;")}n&&(this.value.push(e),this.update(),this.trigger("add",this.extend({},{index:this.value.length,tag:n},e))),this.state.tag=null}},addTags:function(e,t){var n=this,i=[];return e=this.normalizeTags.call(this,e),"mix"==this.settings.mode?this.addMixTag(e[0]):(this.DOM.input.removeAttribute("style"),e.forEach(function(e){var t,o;e=Object.assign({},e),"function"==typeof n.settings.transformTag&&(e.value=n.settings.transformTag.call(n,e.value)||e.value),!0!==(t=n.maxTagsReached()||n.validateTag.call(n,e.value))&&(e.class=(e.class||"")+" tagify--notAllowed",e.title=t,n.markTagByValue(e.value),n.trigger("invalid",{data:e,index:n.value.length,message:t})),o=n.createTagElem(e),i.push(o),function(e){var t=this.DOM.scope.lastElementChild;t===this.DOM.input?this.DOM.scope.insertBefore(e,t):this.DOM.scope.appendChild(e)}.call(n,o),!0===t?(n.value.push(e),n.update(),n.DOM.scope.classList.toggle("hasMaxTags",n.value.length>=n.settings.maxTags),n.trigger("add",{tag:o,index:n.value.length-1,data:e})):n.settings.keepInvalidTags||setTimeout(function(){n.removeTag(o,!0)},1e3)}),e.length&&t&&this.input.set.call(this),i)},minify:function(e){return e.replace(new RegExp(">[\r\n ]+<","g"),"><")},createTagElem:function(e){var t,n=this.escapeHtml(e.value),i="<tag title='"+n+"' contenteditable='false' spellcheck=\"false\">\n                            <x title=''></x><div><span class='tagify__tag-text'>"+n+"</span></div>\n                        </tag>";if("function"==typeof this.settings.tagTemplate)try{i=this.settings.tagTemplate(n,e)}catch(e){}return this.settings.readonly&&(e.readonly=!0),i=this.minify(i),function(e,t){var n,i=Object.keys(t);for(n=i.length;n--;){var o=i[n];if(!t.hasOwnProperty(o))return;e.setAttribute(o,t[o])}}(t=this.parseHTML(i),e),t},removeTag:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:250;if(e&&e instanceof HTMLElement){"string"==typeof e&&(e=this.getTagElmByValue(e));var i,o=this.getNodeIndex(e);n&&10<n?(e.style.width=parseFloat(window.getComputedStyle(e).width)+"px",document.body.clientTop,e.classList.add("tagify--hide"),setTimeout(s,400)):s(),t||(i=this.value.splice(o,1)[0],this.update(),this.trigger("remove",{tag:e,index:o,data:i}))}function s(){e.parentNode&&e.parentNode.removeChild(e)}},removeAllTags:function(){this.value=[],this.update(),Array.prototype.slice.call(this.DOM.scope.querySelectorAll("tag")).forEach(function(e){return e.parentNode.removeChild(e)})},update:function(){this.DOM.originalInput.value="mix"==this.settings.mode?this.DOM.input.textContent:JSON.stringify(this.value)},dropdown:{init:function(){this.DOM.dropdown=this.dropdown.build.call(this)},build:function(){var e='<div class="'+("tagify__dropdown "+this.settings.dropdown.classname).trim()+'"></div>';return this.parseHTML(e)},show:function(e){var t,n=this;if(this.settings.whitelist.length){if(this.suggestedListItems=e?this.dropdown.filterListItems.call(this,e):this.settings.whitelist.filter(function(e){return-1==n.isTagDuplicate(e.value||e)}),!this.suggestedListItems.length)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide.call(this);t=this.dropdown.createListHTML.call(this,this.suggestedListItems),this.DOM.dropdown.innerHTML=t,this.dropdown.highlightOption.call(this,this.DOM.dropdown.querySelector(".tagify__dropdown__item")),this.dropdown.position.call(this),!this.DOM.dropdown.parentNode!=document.body&&(document.body.appendChild(this.DOM.dropdown),this.events.binding.call(this,!1),this.dropdown.events.binding.call(this))}},hide:function(){this.DOM.dropdown&&this.DOM.dropdown.parentNode==document.body&&(document.body.removeChild(this.DOM.dropdown),window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),this.events.binding.call(this))},position:function(){var e=this.DOM.scope.getBoundingClientRect();this.DOM.dropdown.style.cssText="left: "+(e.left+window.pageXOffset)+"px;                                                top: "+(e.top+e.height-1+window.pageYOffset)+"px;                                                width: "+e.width+"px"},events:{binding:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this),onKeyDown:this.dropdown.events.callbacks.onKeyDown.bind(this),onMouseOver:this.dropdown.events.callbacks.onMouseOver.bind(this),onClick:this.dropdown.events.callbacks.onClick.bind(this)},n=e?"addEventListener":"removeEventListener";window[n]("resize",t.position),window[n]("keydown",t.onKeyDown),window[n]("mousedown",t.onClick),this.DOM.dropdown[n]("mouseover",t.onMouseOver)},callbacks:{onKeyDown:function(e){var t=this.DOM.dropdown.querySelector("[class$='--active']")||this.DOM.dropdown.children[0],n="";switch(e.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":e.preventDefault(),t&&(t=t[("ArrowUp"==e.key||"Up"==e.key?"previous":"next")+"ElementSibling"]),t||(t=this.DOM.dropdown.children["ArrowUp"==e.key||"Up"==e.key?this.DOM.dropdown.children.length-1:0]),this.dropdown.highlightOption.call(this,t,!0);break;case"Escape":case"Esc":this.dropdown.hide.call(this);break;case"ArrowRight":case"Tab":if(e.preventDefault(),!this.input.autocomplete.set.call(this,t?t.textContent:null))return!1;case"Enter":return e.preventDefault(),n=this.suggestedListItems[this.getNodeIndex(t)]||this.input.value,this.addTags([n],!0),this.dropdown.hide.call(this),!1}},onMouseOver:function(e){e.target.className.includes("__item")&&this.dropdown.highlightOption.call(this,e.target)},onClick:function(e){var t,n,i=this,o=function(){return i.dropdown.hide.call(i)};if(0==e.button){if(e.target==document.documentElement)return o();(n=[e.target,e.target.parentNode].filter(function(e){return e.className.includes("tagify__dropdown__item")})[0])?(t=this.suggestedListItems[this.getNodeIndex(n)]||this.input.value,this.addTags([t],!0),this.dropdown.hide.call(this)):o()}}}},highlightOption:function(e,t){if(e){var n,i="tagify__dropdown__item--active";[].forEach.call(this.DOM.dropdown.querySelectorAll("[class$='--active']"),function(e){return e.classList.remove(i)}),e.classList.add(i),t&&(e.parentNode.scrollTop=e.clientHeight+e.offsetTop-e.parentNode.clientHeight),this.settings.autoComplete&&!this.settings.dropdown.fuzzySearch&&(n=this.suggestedListItems[this.getNodeIndex(e)].value||this.input.value,this.input.autocomplete.suggest.call(this,n))}},filterListItems:function(e){if(!e)return"";for(var t,n,i,o,s=[],r=this.settings.whitelist,a=this.settings.dropdown.maxItems||1/0,l=0;l<r.length&&(i=(t=r[l]instanceof Object?r[l]:{value:r[l]}).value.toLowerCase().indexOf(e.toLowerCase()),n=this.settings.dropdown.fuzzySearch?0<=i:0==i,o=!this.settings.duplicates&&-1<this.isTagDuplicate(t.value),n&&!o&&a--&&s.push(t),0!=a);l++);return s},createListHTML:function(e){var t=this.settings.dropdown.itemTemplate||function(e){return"<div class='tagify__dropdown__item "+(e.class?e.class:"")+"' "+function(e){var t,n=Object.keys(e),i="";for(t=n.length;t--;){var o=n[t];if("class"!=o&&!e.hasOwnProperty(o))return;i+=" "+o+(e[o]?"="+e[o]:"")}return i}(e)+">"+(e.value||e)+"</div>"};return e.map(t).join("")}}},e})?i.apply(t,o):i)||(e.exports=s)}).call(this,n("EVdn"))},"4w6A":function(e,t,n){
/*!
 * Toastify js 1.3.2
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */
var i,o;i=this,o=function(e){var t=function(e){return new t.lib.init(e)};function n(e,t){return!(!e||"string"!=typeof t)&&!!(e.className&&e.className.trim().split(/\s+/gi).indexOf(t)>-1)}return t.lib=t.prototype={toastify:"1.3.2",constructor:t,init:function(e){return e||(e={}),this.options={},this.options.text=e.text||"Hi there!",this.options.duration=e.duration||3e3,this.options.selector=e.selector,this.options.callback=e.callback||function(){},this.options.destination=e.destination,this.options.newWindow=e.newWindow||!1,this.options.close=e.close||!1,this.options.gravity="bottom"==e.gravity?"toastify-bottom":"toastify-top",this.options.positionLeft=e.positionLeft||!1,this.options.backgroundColor=e.backgroundColor,this.options.avatar=e.avatar||"",this.options.className=e.className||"",this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var e=document.createElement("div");if(e.className="toastify on "+this.options.className,!0===this.options.positionLeft?e.className+=" toastify-left":e.className+=" toastify-right",e.className+=" "+this.options.gravity,this.options.backgroundColor&&(e.style.background=this.options.backgroundColor),e.innerHTML=this.options.text,""!==this.options.avatar){var t=document.createElement("img");t.src=this.options.avatar,t.className="toastify-avatar",!0===this.options.positionLeft?e.appendChild(t):e.insertAdjacentElement("beforeend",t)}if(!0===this.options.close){var n=document.createElement("span");n.innerHTML="&#10006;",n.className="toast-close",n.addEventListener("click",function(e){e.stopPropagation(),this.removeElement(e.target.parentElement),window.clearTimeout(e.target.parentElement.timeOutValue)}.bind(this));var i=window.innerWidth>0?window.innerWidth:screen.width;!0===this.options.positionLeft&&i>360?e.insertAdjacentElement("afterbegin",n):e.appendChild(n)}return void 0!==this.options.destination&&e.addEventListener("click",function(e){e.stopPropagation(),!0===this.options.newWindow?window.open(this.options.destination,"_blank"):window.location=this.options.destination}.bind(this)),e},showToast:function(){var e,n=this.buildToast();if(!(e=void 0===this.options.selector?document.body:document.getElementById(this.options.selector)))throw"Root element is not defined";return e.insertBefore(n,e.firstChild),t.reposition(),n.timeOutValue=window.setTimeout(function(){this.removeElement(n)}.bind(this),this.options.duration),this},removeElement:function(e){e.className=e.className.replace(" on",""),window.setTimeout(function(){e.parentNode.removeChild(e),this.options.callback.call(e),t.reposition()}.bind(this),400)}},t.reposition=function(){for(var e,t={top:15,bottom:15},i={top:15,bottom:15},o={top:15,bottom:15},s=document.getElementsByClassName("toastify"),r=0;r<s.length;r++){e=!0===n(s[r],"toastify-top")?"toastify-top":"toastify-bottom";var a=s[r].offsetHeight;e=e.substr(9,e.length-1);(window.innerWidth>0?window.innerWidth:screen.width)<=360?(s[r].style[e]=o[e]+"px",o[e]+=a+15):!0===n(s[r],"toastify-left")?(s[r].style[e]=t[e]+"px",t[e]+=a+15):(s[r].style[e]=i[e]+"px",i[e]+=a+15)}return this},t.lib.init.prototype=t.lib,t},e.exports?(n("CARs"),e.exports=o()):i.Toastify=o()},"8KW/":function(e,t,n){},A59O:function(e,t,n){},CARs:function(e,t,n){},"M/oN":function(e,t,n){(function(i){var o,s;void 0===(s="function"==typeof(o=function(){var e=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};e.prototype.tokenize=function(e){if(!(e=s(String(e||"").toLowerCase()))||!e.length)return[];var t,n,i,o,a=[],u=e.split(/ +/);for(t=0,n=u.length;t<n;t++){if(i=r(u[t]),this.settings.diacritics)for(o in l)l.hasOwnProperty(o)&&(i=i.replace(new RegExp(o,"g"),l[o]));a.push({string:u[t],regex:new RegExp(i,"i")})}return a},e.prototype.iterator=function(e,t){(a(e)?Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e(this[t],t,this)}:function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)}).apply(e,[t])},e.prototype.getScoreFunction=function(e,t){var n,i,s,r;e=this.prepareSearch(e,t),i=e.tokens,n=e.options.fields,s=i.length,r=e.options.nesting;var a,l=function(e,t){var n,i;return e?(e=String(e||""),-1===(i=e.search(t.regex))?0:(n=t.string.length/e.length,0===i&&(n+=.5),n)):0},u=(a=n.length)?1===a?function(e,t){return l(o(t,n[0],r),e)}:function(e,t){for(var i=0,s=0;i<a;i++)s+=l(o(t,n[i],r),e);return s/a}:function(){return 0};return s?1===s?function(e){return u(i[0],e)}:"and"===e.options.conjunction?function(e){for(var t,n=0,o=0;n<s;n++){if((t=u(i[n],e))<=0)return 0;o+=t}return o/s}:function(e){for(var t=0,n=0;t<s;t++)n+=u(i[t],e);return n/s}:function(){return 0}},e.prototype.getSortFunction=function(e,n){var i,s,r,a,l,u,c,d,p,h,f;if(e=(r=this).prepareSearch(e,n),f=!e.query&&n.sort_empty||n.sort,p=function(e,t){return"$score"===e?t.score:o(r.items[t.id],e,n.nesting)},l=[],f)for(i=0,s=f.length;i<s;i++)(e.query||"$score"!==f[i].field)&&l.push(f[i]);if(e.query){for(h=!0,i=0,s=l.length;i<s;i++)if("$score"===l[i].field){h=!1;break}h&&l.unshift({field:"$score",direction:"desc"})}else for(i=0,s=l.length;i<s;i++)if("$score"===l[i].field){l.splice(i,1);break}for(d=[],i=0,s=l.length;i<s;i++)d.push("desc"===l[i].direction?-1:1);return(u=l.length)?1===u?(a=l[0].field,c=d[0],function(e,n){return c*t(p(a,e),p(a,n))}):function(e,n){var i,o,s;for(i=0;i<u;i++)if(s=l[i].field,o=d[i]*t(p(s,e),p(s,n)))return o;return 0}:null},e.prototype.prepareSearch=function(e,t){if("object"==typeof e)return e;var i=(t=n({},t)).fields,o=t.sort,s=t.sort_empty;return i&&!a(i)&&(t.fields=[i]),o&&!a(o)&&(t.sort=[o]),s&&!a(s)&&(t.sort_empty=[s]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},e.prototype.search=function(e,t){var n,i,o,s;return i=this.prepareSearch(e,t),t=i.options,e=i.query,s=t.score||this.getScoreFunction(i),e.length?this.iterator(this.items,function(e,o){n=s(e),(!1===t.filter||n>0)&&i.items.push({score:n,id:o})}):this.iterator(this.items,function(e,t){i.items.push({score:1,id:t})}),(o=this.getSortFunction(i,t))&&i.items.sort(o),i.total=i.items.length,"number"==typeof t.limit&&(i.items=i.items.slice(0,t.limit)),i};var t=function(e,t){return"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=u(String(e||"")),t=u(String(t||"")),e>t?1:t>e?-1:0)},n=function(e,t){var n,i,o,s;for(n=1,i=arguments.length;n<i;n++)if(s=arguments[n])for(o in s)s.hasOwnProperty(o)&&(e[o]=s[o]);return e},o=function(e,t,n){if(e&&t){if(!n)return e[t];for(var i=t.split(".");i.length&&(e=e[i.shift()]););return e}},s=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},r=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},a=Array.isArray||void 0!==i&&i.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},l={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},u=function(){var e,t,n,i,o="",s={};for(n in l)if(l.hasOwnProperty(n))for(i=l[n].substring(2,l[n].length-1),o+=i,e=0,t=i.length;e<t;e++)s[i.charAt(e)]=n;var r=new RegExp("["+o+"]","g");return function(e){return e.replace(r,function(e){return s[e]}).toLowerCase()}}();return e})?o.call(t,n,t,e):o)||(e.exports=s)}).call(this,n("EVdn"))},NNF2:function(e,t,n){},QMhP:function(e,t,n){"use strict";e.exports=n("uQcr")},QPhV:function(e,t,n){var i,o,s;o=[n("EVdn"),n("M/oN"),n("nif5")],void 0===(s="function"==typeof(i=function(e,t,n){"use strict";var i=function(e,t){if("string"!=typeof t||t.length){var n="string"==typeof t?new RegExp(t,"i"):t,i=function(e){var t=0;if(3===e.nodeType){var o=e.data.search(n);if(o>=0&&e.data.length>0){var s=e.data.match(n),r=document.createElement("span");r.className="highlight";var a=e.splitText(o),l=(a.splitText(s[0].length),a.cloneNode(!0));r.appendChild(l),a.parentNode.replaceChild(r,a),t=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName))for(var u=0;u<e.childNodes.length;++u)u+=i(e.childNodes[u]);return t};return e.each(function(){i(this)})}};e.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var e=this.parentNode;e.replaceChild(this.firstChild,this),e.normalize()}).end()};var o=function(){};o.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[e]:(this._events=this._events||{},void(e in this._events!=0&&this._events[e].splice(this._events[e].indexOf(t),1)))},trigger:function(e){if(this._events=this._events||{},e in this._events!=0)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},o.mixin=function(e){for(var t=["on","off","trigger"],n=0;n<t.length;n++)e.prototype[t[n]]=o.prototype[t[n]]};var s,r,a=/Mac/.test(navigator.userAgent),l=a?91:17,u=a?18:17,c=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,d=function(e){return void 0!==e},p=function(e){return null==e?null:"boolean"==typeof e?e?"1":"0":e+""},h=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},f={before:function(e,t,n){var i=e[t];e[t]=function(){return n.apply(e,arguments),i.apply(e,arguments)}},after:function(e,t,n){var i=e[t];e[t]=function(){var t=i.apply(e,arguments);return n.apply(e,arguments),t}}},g=function(e,t,n){var i,o=e.trigger,s={};for(i in e.trigger=function(){var n=arguments[0];if(-1===t.indexOf(n))return o.apply(e,arguments);s[n]=arguments},n.apply(e,[]),e.trigger=o,s)s.hasOwnProperty(i)&&o.apply(e,s[i])},m=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var n=document.selection.createRange(),i=document.selection.createRange().text.length;n.moveStart("character",-e.value.length),t.start=n.text.length-i,t.length=i}return t},q=function(n,i){var o,s,r,a;(a=n[0]).selectize=this;var l,u,c,d=window.getComputedStyle&&window.getComputedStyle(a,null);if(r=(r=d?d.getPropertyValue("direction"):a.currentStyle&&a.currentStyle.direction)||n.parents("[dir]:first").attr("dir")||"",e.extend(this,{order:0,settings:i,$input:n,tabIndex:n.attr("tabindex")||"",tagType:"select"===a.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(r),eventNS:".selectize"+ ++q.count,highlightedValue:null,isBlurring:!1,isOpen:!1,isDisabled:!1,isRequired:n.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===i.loadThrottle?this.onSearchChange:(l=this.onSearchChange,u=i.loadThrottle,function(){var e=this,t=arguments;window.clearTimeout(c),c=window.setTimeout(function(){l.apply(e,t)},u)})}),this.sifter=new t(this.options,{diacritics:i.diacritics}),this.settings.options){for(o=0,s=this.settings.options.length;o<s;o++)this.registerOption(this.settings.options[o]);delete this.settings.options}if(this.settings.optgroups){for(o=0,s=this.settings.optgroups.length;o<s;o++)this.registerOptionGroup(this.settings.optgroups[o]);delete this.settings.optgroups}this.settings.mode=this.settings.mode||(1===this.settings.maxItems?"single":"multi"),"boolean"!=typeof this.settings.hideSelected&&(this.settings.hideSelected="multi"===this.settings.mode),this.initializePlugins(this.settings.plugins),this.setupCallbacks(),this.setupTemplates(),this.setup()};return o.mixin(q),void 0!==n?n.mixin(q):(s="Dependency MicroPlugin is missing",(r={explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'})||(r={}),console.error("Selectize: "+s),r.explanation&&(console.group&&console.group(),console.error(r.explanation),console.group&&console.groupEnd())),e.extend(q.prototype,{setup:function(){var t,n,i,o,s,r,d,p,h,f,g,v,_,b,y=this,w=y.settings,x=y.eventNS,S=e(window),C=e(document),F=y.$input;if(d=y.settings.mode,p=F.attr("class")||"",t=e("<div>").addClass(w.wrapperClass).addClass(p).addClass(d),n=e("<div>").addClass(w.inputClass).addClass("items").appendTo(t),i=e('<input type="text" autocomplete="off" />').appendTo(n).attr("tabindex",F.is(":disabled")?"-1":y.tabIndex),r=e(w.dropdownParent||t),o=e("<div>").addClass(w.dropdownClass).addClass(d).hide().appendTo(r),s=e("<div>").addClass(w.dropdownContentClass).appendTo(o),(f=F.attr("id"))&&(i.attr("id",f+"-selectized"),e("label[for='"+f+"']").attr("for",f+"-selectized")),y.settings.copyClassesToDropdown&&o.addClass(p),t.css({width:F[0].style.width}),y.plugins.names.length&&(h="plugin-"+y.plugins.names.join(" plugin-"),t.addClass(h),o.addClass(h)),(null===w.maxItems||w.maxItems>1)&&1===y.tagType&&F.attr("multiple","multiple"),y.settings.placeholder&&i.attr("placeholder",w.placeholder),!y.settings.splitOn&&y.settings.delimiter){var I=y.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");y.settings.splitOn=new RegExp("\\s*"+I+"+\\s*")}F.attr("autocorrect")&&i.attr("autocorrect",F.attr("autocorrect")),F.attr("autocapitalize")&&i.attr("autocapitalize",F.attr("autocapitalize")),i[0].type=F[0].type,y.$wrapper=t,y.$control=n,y.$control_input=i,y.$dropdown=o,y.$dropdown_content=s,o.on("mouseenter mousedown click","[data-disabled]>[data-selectable]",function(e){e.stopImmediatePropagation()}),o.on("mouseenter","[data-selectable]",function(){return y.onOptionHover.apply(y,arguments)}),o.on("mousedown click","[data-selectable]",function(){return y.onOptionSelect.apply(y,arguments)}),v="mousedown",_="*:not(input)",b=function(){return y.onItemSelect.apply(y,arguments)},(g=n).on(v,_,function(e){for(var t=e.target;t&&t.parentNode!==g[0];)t=t.parentNode;return e.currentTarget=t,b.apply(this,[e])}),function(t){var n=null,i=function(i,o){var s,r,a,l,u,c,d,p,h,f;i=i||window.event||{},o=o||{},i.metaKey||i.altKey||(o.force||!1!==t.data("grow"))&&(s=t.val(),i.type&&"keydown"===i.type.toLowerCase()&&(r=i.keyCode,a=r>=48&&r<=57||r>=65&&r<=90||r>=96&&r<=111||r>=186&&r<=222||32===r,46===r||8===r?(p=m(t[0])).length?s=s.substring(0,p.start)+s.substring(p.start+p.length):8===r&&p.start?s=s.substring(0,p.start-1)+s.substring(p.start+1):46===r&&void 0!==p.start&&(s=s.substring(0,p.start)+s.substring(p.start+1)):a&&(c=i.shiftKey,d=String.fromCharCode(i.keyCode),d=c?d.toUpperCase():d.toLowerCase(),s+=d)),l=t.attr("placeholder"),!s&&l&&(s=l),f=t,(u=((h=s)?(q.$testInput||(q.$testInput=e("<span />").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).appendTo("body")),q.$testInput.text(h),function(e,t,n){var i,o,s={};if(n)for(i=0,o=n.length;i<o;i++)s[n[i]]=e.css(n[i]);else s=e.css();t.css(s)}(f,q.$testInput,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]),q.$testInput.width()):0)+4)!==n&&(n=u,t.width(u),t.triggerHandler("resize")))};t.on("keydown keyup update blur",i),i()}(i),n.on({mousedown:function(){return y.onMouseDown.apply(y,arguments)},click:function(){return y.onClick.apply(y,arguments)}}),i.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return y.onKeyDown.apply(y,arguments)},keyup:function(){return y.onKeyUp.apply(y,arguments)},keypress:function(){return y.onKeyPress.apply(y,arguments)},resize:function(){y.positionDropdown.apply(y,[])},blur:function(){return y.onBlur.apply(y,arguments)},focus:function(){return y.ignoreBlur=!1,y.onFocus.apply(y,arguments)},paste:function(){return y.onPaste.apply(y,arguments)}}),C.on("keydown"+x,function(e){y.isCmdDown=e[a?"metaKey":"ctrlKey"],y.isCtrlDown=e[a?"altKey":"ctrlKey"],y.isShiftDown=e.shiftKey}),C.on("keyup"+x,function(e){e.keyCode===u&&(y.isCtrlDown=!1),16===e.keyCode&&(y.isShiftDown=!1),e.keyCode===l&&(y.isCmdDown=!1)}),C.on("mousedown"+x,function(e){if(y.isFocused){if(e.target===y.$dropdown[0]||e.target.parentNode===y.$dropdown[0])return!1;y.$control.has(e.target).length||e.target===y.$control[0]||y.blur(e.target)}}),S.on(["scroll"+x,"resize"+x].join(" "),function(){y.isOpen&&y.positionDropdown.apply(y,arguments)}),S.on("mousemove"+x,function(){y.ignoreHover=!1}),this.revertSettings={$children:F.children().detach(),tabindex:F.attr("tabindex")},F.attr("tabindex",-1).hide().after(y.$wrapper),e.isArray(w.items)&&(y.setValue(w.items),delete w.items),c&&F.on("invalid"+x,function(e){e.preventDefault(),y.isInvalid=!0,y.refreshState()}),y.updateOriginalInput(),y.refreshItems(),y.refreshState(),y.updatePlaceholder(),y.isSetup=!0,F.is(":disabled")&&y.disable(),y.on("change",this.onChange),F.data("selectize",y),F.addClass("selectized"),y.trigger("initialize"),!0===w.preload&&y.onSearchChange("")},setupTemplates:function(){var t=this.settings.labelField,n=this.settings.optgroupLabelField,i={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[n])+"</div>"},option:function(e,n){return'<div class="option">'+n(e[t])+"</div>"},item:function(e,n){return'<div class="item">'+n(e[t])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};this.settings.render=e.extend({},i,this.settings.render)},setupCallbacks:function(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n)n.hasOwnProperty(e)&&(t=this.settings[n[e]])&&this.on(e,t)},onClick:function(e){this.isFocused&&this.isOpen||(this.focus(),e.preventDefault())},onMouseDown:function(t){var n=this,i=t.isDefaultPrevented();if(e(t.target),n.isFocused){if(t.target!==n.$control_input[0])return"single"===n.settings.mode?n.isOpen?n.close():n.open():i||n.setActiveItem(null),!1}else i||window.setTimeout(function(){n.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(t){var n=this;n.isFull()||n.isInputHidden||n.isLocked?t.preventDefault():n.settings.splitOn&&setTimeout(function(){var t=n.$control_input.val();if(t.match(n.settings.splitOn))for(var i=e.trim(t).split(n.settings.splitOn),o=0,s=i.length;o<s;o++)n.createItem(i[o])},0)},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&t===this.settings.delimiter?(this.createItem(),e.preventDefault(),!1):void 0},onKeyDown:function(e){if(e.target,this.$control_input[0],this.isLocked)9!==e.keyCode&&e.preventDefault();else{switch(e.keyCode){case 65:if(this.isCmdDown)return void this.selectAll();break;case 27:return void(this.isOpen&&(e.preventDefault(),e.stopPropagation(),this.close()));case 78:if(!e.ctrlKey||e.altKey)break;case 40:if(!this.isOpen&&this.hasOptions)this.open();else if(this.$activeOption){this.ignoreHover=!0;var t=this.getAdjacentOption(this.$activeOption,1);t.length&&this.setActiveOption(t,!0,!0)}return void e.preventDefault();case 80:if(!e.ctrlKey||e.altKey)break;case 38:if(this.$activeOption){this.ignoreHover=!0;var n=this.getAdjacentOption(this.$activeOption,-1);n.length&&this.setActiveOption(n,!0,!0)}return void e.preventDefault();case 13:return void(this.isOpen&&this.$activeOption&&(this.onOptionSelect({currentTarget:this.$activeOption}),e.preventDefault()));case 37:return void this.advanceSelection(-1,e);case 39:return void this.advanceSelection(1,e);case 9:return this.settings.selectOnTab&&this.isOpen&&this.$activeOption&&(this.onOptionSelect({currentTarget:this.$activeOption}),this.isFull()||e.preventDefault()),void(this.settings.create&&this.createItem()&&e.preventDefault());case 8:case 46:return void this.deleteSelection(e)}!this.isFull()&&!this.isInputHidden||(a?e.metaKey:e.ctrlKey)||e.preventDefault()}},onKeyUp:function(e){if(this.isLocked)return e&&e.preventDefault();var t=this.$control_input.val()||"";this.lastValue!==t&&(this.lastValue=t,this.onSearchChange(t),this.refreshOptions(),this.trigger("type",t))},onSearchChange:function(e){var t=this,n=t.settings.load;n&&(t.loadedSearches.hasOwnProperty(e)||(t.loadedSearches[e]=!0,t.load(function(i){n.apply(t,[e,i])})))},onFocus:function(e){var t=this.isFocused;if(this.isDisabled)return this.blur(),e&&e.preventDefault(),!1;this.ignoreFocus||(this.isFocused=!0,"focus"===this.settings.preload&&this.onSearchChange(""),t||this.trigger("focus"),this.$activeItems.length||(this.showInput(),this.setActiveItem(null),this.refreshOptions(!!this.settings.openOnFocus)),this.refreshState())},onBlur:function(e,t){var n=this;if(n.isFocused&&(n.isFocused=!1,!n.ignoreFocus)){if(!n.ignoreBlur&&document.activeElement===n.$dropdown_content[0])return n.ignoreBlur=!0,void n.onFocus(e);var i=function(){n.close(),n.setTextboxValue(""),n.setActiveItem(null),n.setActiveOption(null),n.setCaret(n.items.length),n.refreshState(),t&&t.focus&&t.focus(),n.isBlurring=!1,n.ignoreFocus=!1,n.trigger("blur")};n.isBlurring=!0,n.ignoreFocus=!0,n.settings.create&&n.settings.createOnBlur?n.createItem(null,!1,i):i()}},onOptionHover:function(e){this.ignoreHover||this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(t){var n,i,o=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),(i=e(t.currentTarget)).hasClass("create")?o.createItem(null,function(){o.settings.closeAfterSelect&&o.close()}):void 0!==(n=i.attr("data-value"))&&(o.lastQuery=null,o.setTextboxValue(""),o.addItem(n),o.settings.closeAfterSelect?o.close():!o.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&o.setActiveOption(o.getOption(n)))},onItemSelect:function(e){this.isLocked||"multi"===this.settings.mode&&(e.preventDefault(),this.setActiveItem(e.currentTarget,e))},load:function(e){var t=this,n=t.$wrapper.addClass(t.settings.loadingClass);t.loading++,e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0),e&&e.length&&(t.addOption(e),t.refreshOptions(t.isFocused&&!t.isInputHidden)),t.loading||n.removeClass(t.settings.loadingClass),t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$control_input;t.val()!==e&&(t.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(e,t){g(this,t?[]:["change"],function(){this.clear(t),this.addItems(e,t)})},setActiveItem:function(t,n){var i,o,s,r,a,l,u,c;if("single"!==this.settings.mode){if(!(t=e(t)).length)return e(this.$activeItems).removeClass("active"),this.$activeItems=[],void(this.isFocused&&this.showInput());if("mousedown"===(i=n&&n.type.toLowerCase())&&this.isShiftDown&&this.$activeItems.length){for(c=this.$control.children(".active:last"),(r=Array.prototype.indexOf.apply(this.$control[0].childNodes,[c[0]]))>(a=Array.prototype.indexOf.apply(this.$control[0].childNodes,[t[0]]))&&(u=r,r=a,a=u),o=r;o<=a;o++)l=this.$control[0].childNodes[o],-1===this.$activeItems.indexOf(l)&&(e(l).addClass("active"),this.$activeItems.push(l));n.preventDefault()}else"mousedown"===i&&this.isCtrlDown||"keydown"===i&&this.isShiftDown?t.hasClass("active")?(s=this.$activeItems.indexOf(t[0]),this.$activeItems.splice(s,1),t.removeClass("active")):this.$activeItems.push(t.addClass("active")[0]):(e(this.$activeItems).removeClass("active"),this.$activeItems=[t.addClass("active")[0]]);this.hideInput(),this.isFocused||this.focus()}},setActiveOption:function(t,n,i){var o,s,r,a,l;this.$activeOption&&this.$activeOption.removeClass("active"),this.$activeOption=null,(t=e(t)).length&&(this.$activeOption=t.addClass("active"),!n&&d(n)||(o=this.$dropdown_content.height(),s=this.$activeOption.outerHeight(!0),n=this.$dropdown_content.scrollTop()||0,a=r=this.$activeOption.offset().top-this.$dropdown_content.offset().top+n,l=r-o+s,r+s>o+n?this.$dropdown_content.stop().animate({scrollTop:l},i?this.settings.scrollDuration:0):r<n&&this.$dropdown_content.stop().animate({scrollTop:a},i?this.settings.scrollDuration:0)))},selectAll:function(){"single"!==this.settings.mode&&(this.$activeItems=Array.prototype.slice.apply(this.$control.children(":not(input)").addClass("active")),this.$activeItems.length&&(this.hideInput(),this.close()),this.focus())},hideInput:function(){this.setTextboxValue(""),this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1e4:-1e4}),this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.$control_input[0].focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0))},blur:function(e){this.$control_input[0].blur(),this.onBlur(null,e)},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings,t=e.sortField;return"string"==typeof t&&(t=[{field:t}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}},search:function(t){var n,i,o,s=this.settings,r=this.getSearchOptions();if(s.score&&"function"!=typeof(o=this.settings.score.apply(this,[t])))throw new Error('Selectize "score" setting must be a function that returns a function');if(t!==this.lastQuery?(this.lastQuery=t,i=this.sifter.search(t,e.extend(r,{score:o})),this.currentResults=i):i=e.extend(!0,{},this.currentResults),s.hideSelected)for(n=i.items.length-1;n>=0;n--)-1!==this.items.indexOf(p(i.items[n].id))&&i.items.splice(n,1);return i},refreshOptions:function(t){var n,o,s,r,a,l,u,c,d,h,f,g,m,q,v,_;void 0===t&&(t=!0);var b,y,w=this,x=e.trim(w.$control_input.val()),S=w.search(x),C=w.$dropdown_content,F=w.$activeOption&&p(w.$activeOption.attr("data-value"));for(r=S.items.length,"number"==typeof w.settings.maxOptions&&(r=Math.min(r,w.settings.maxOptions)),a={},l=[],n=0;n<r;n++)for(u=w.options[S.items[n].id],c=w.render("option",u),d=u[w.settings.optgroupField]||"",o=0,s=(h=e.isArray(d)?d:[d])&&h.length;o<s;o++)d=h[o],w.optgroups.hasOwnProperty(d)||(d=""),a.hasOwnProperty(d)||(a[d]=document.createDocumentFragment(),l.push(d)),a[d].appendChild(c);for(this.settings.lockOptgroupOrder&&l.sort(function(e,t){return(w.optgroups[e].$order||0)-(w.optgroups[t].$order||0)}),f=document.createDocumentFragment(),n=0,r=l.length;n<r;n++)d=l[n],w.optgroups.hasOwnProperty(d)&&a[d].childNodes.length?((g=document.createDocumentFragment()).appendChild(w.render("optgroup_header",w.optgroups[d])),g.appendChild(a[d]),f.appendChild(w.render("optgroup",e.extend({},w.optgroups[d],{html:(b=g,y=void 0,y=document.createElement("div"),y.appendChild(b.cloneNode(!0)),y.innerHTML),dom:g})))):f.appendChild(a[d]);if(C.html(f),w.settings.highlight&&(C.removeHighlight(),S.query.length&&S.tokens.length))for(n=0,r=S.tokens.length;n<r;n++)i(C,S.tokens[n].regex);if(!w.settings.hideSelected)for(n=0,r=w.items.length;n<r;n++)w.getOption(w.items[n]).addClass("selected");(m=w.canCreate(x))&&(C.prepend(w.render("option_create",{input:x})),_=e(C[0].childNodes[0])),w.hasOptions=S.items.length>0||m,w.hasOptions?(S.items.length>0?((v=F&&w.getOption(F))&&v.length?q=v:"single"===w.settings.mode&&w.items.length&&(q=w.getOption(w.items[0])),q&&q.length||(q=_&&!w.settings.addPrecedence?w.getAdjacentOption(_,1):C.find("[data-selectable]:first"))):q=_,w.setActiveOption(q),t&&!w.isOpen&&w.open()):(w.setActiveOption(null),t&&w.isOpen&&w.close())},addOption:function(t){var n,i,o;if(e.isArray(t))for(n=0,i=t.length;n<i;n++)this.addOption(t[n]);else(o=this.registerOption(t))&&(this.userOptions[o]=!0,this.lastQuery=null,this.trigger("option_add",o,t))},registerOption:function(e){var t=p(e[this.settings.valueField]);return null!=t&&!this.options.hasOwnProperty(t)&&(e.$order=e.$order||++this.order,this.options[t]=e,t)},registerOptionGroup:function(e){var t=p(e[this.settings.optgroupValueField]);return!!t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)},addOptionGroup:function(e,t){t[this.settings.optgroupValueField]=e,(e=this.registerOptionGroup(t))&&this.trigger("optgroup_add",e,t)},removeOptionGroup:function(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.renderCache={},this.trigger("optgroup_remove",e))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(t,n){var i,o,s,r,a,l,u;if(t=p(t),s=p(n[this.settings.valueField]),null!==t&&this.options.hasOwnProperty(t)){if("string"!=typeof s)throw new Error("Value must be set in option data");u=this.options[t].$order,s!==t&&(delete this.options[t],-1!==(r=this.items.indexOf(t))&&this.items.splice(r,1,s)),n.$order=n.$order||u,this.options[s]=n,a=this.renderCache.item,l=this.renderCache.option,a&&(delete a[t],delete a[s]),l&&(delete l[t],delete l[s]),-1!==this.items.indexOf(s)&&(i=this.getItem(t),o=e(this.render("item",n)),i.hasClass("active")&&o.addClass("active"),i.replaceWith(o)),this.lastQuery=null,this.isOpen&&this.refreshOptions(!1)}},removeOption:function(e,t){e=p(e);var n=this.renderCache.item,i=this.renderCache.option;n&&delete n[e],i&&delete i[e],delete this.userOptions[e],delete this.options[e],this.lastQuery=null,this.trigger("option_remove",e),this.removeItem(e,t)},clearOptions:function(){var t=this;t.loadedSearches={},t.userOptions={},t.renderCache={};var n=t.options;e.each(t.options,function(e,i){-1==t.items.indexOf(e)&&delete n[e]}),t.options=t.sifter.items=n,t.lastQuery=null,t.trigger("option_clear")},getOption:function(e){return this.getElementWithValue(e,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,n){var i=this.$dropdown.find("[data-selectable]"),o=i.index(t)+n;return o>=0&&o<i.length?i.eq(o):e()},getElementWithValue:function(t,n){if(null!=(t=p(t)))for(var i=0,o=n.length;i<o;i++)if(n[i].getAttribute("data-value")===t)return e(n[i]);return e()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(t,n){this.buffer=document.createDocumentFragment();for(var i=this.$control[0].childNodes,o=0;o<i.length;o++)this.buffer.appendChild(i[o]);for(var s=e.isArray(t)?t:[t],r=(o=0,s.length);o<r;o++)this.isPending=o<r-1,this.addItem(s[o],n);var a=this.$control[0];a.insertBefore(this.buffer,a.firstChild),this.buffer=null},addItem:function(t,n){g(this,n?[]:["change"],function(){var i,o,s,r,a,l=this.settings.mode;t=p(t),-1===this.items.indexOf(t)?this.options.hasOwnProperty(t)&&("single"===l&&this.clear(n),"multi"===l&&this.isFull()||(i=e(this.render("item",this.options[t])),a=this.isFull(),this.items.splice(this.caretPos,0,t),this.insertAtCaret(i),(!this.isPending||!a&&this.isFull())&&this.refreshState(),this.isSetup&&(s=this.$dropdown_content.find("[data-selectable]"),this.isPending||(o=this.getOption(t),r=this.getAdjacentOption(o,1).attr("data-value"),this.refreshOptions(this.isFocused&&"single"!==l),r&&this.setActiveOption(this.getOption(r))),!s.length||this.isFull()?this.close():this.isPending||this.positionDropdown(),this.updatePlaceholder(),this.trigger("item_add",t,i),this.isPending||this.updateOriginalInput({silent:n})))):"single"===l&&this.close()})},removeItem:function(t,n){var i,o,s;i=t instanceof e?t:this.getItem(t),t=p(i.attr("data-value")),-1!==(o=this.items.indexOf(t))&&(i.remove(),i.hasClass("active")&&(s=this.$activeItems.indexOf(i[0]),this.$activeItems.splice(s,1)),this.items.splice(o,1),this.lastQuery=null,!this.settings.persist&&this.userOptions.hasOwnProperty(t)&&this.removeOption(t,n),o<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updatePlaceholder(),this.updateOriginalInput({silent:n}),this.positionDropdown(),this.trigger("item_remove",t,i))},createItem:function(t,n){var i=this,o=i.caretPos;t=t||e.trim(i.$control_input.val()||"");var s=arguments[arguments.length-1];if("function"!=typeof s&&(s=function(){}),"boolean"!=typeof n&&(n=!0),!i.canCreate(t))return s(),!1;i.lock();var r,a,l="function"==typeof i.settings.create?this.settings.create:function(e){var t={};return t[i.settings.labelField]=e,t[i.settings.valueField]=e,t},u=(r=function(e){if(i.unlock(),!e||"object"!=typeof e)return s();var t=p(e[i.settings.valueField]);if("string"!=typeof t)return s();i.setTextboxValue(""),i.addOption(e),i.setCaret(o),i.addItem(t),i.refreshOptions(n&&"single"!==i.settings.mode),s(e)},a=!1,function(){a||(a=!0,r.apply(this,arguments))}),c=l.apply(this,[t,u]);return void 0!==c&&u(c),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var e=!this.items.length;this.isInvalid=e,this.$control_input.prop("required",e),this.$input.prop("required",!e)},refreshClasses:function(){var t=this.isFull(),n=this.isLocked;this.$wrapper.toggleClass("rtl",this.rtl),this.$control.toggleClass("focus",this.isFocused).toggleClass("disabled",this.isDisabled).toggleClass("required",this.isRequired).toggleClass("invalid",this.isInvalid).toggleClass("locked",n).toggleClass("full",t).toggleClass("not-full",!t).toggleClass("input-active",this.isFocused&&!this.isInputHidden).toggleClass("dropdown-active",this.isOpen).toggleClass("has-options",!e.isEmptyObject(this.options)).toggleClass("has-items",this.items.length>0),this.$control_input.data("grow",!t&&!n)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(e){var t,n,i,o;if(e=e||{},1===this.tagType){for(i=[],t=0,n=this.items.length;t<n;t++)o=this.options[this.items[t]][this.settings.labelField]||"",i.push('<option value="'+h(this.items[t])+'" selected="selected">'+h(o)+"</option>");i.length||this.$input.attr("multiple")||i.push('<option value="" selected="selected"></option>'),this.$input.html(i.join(""))}else this.$input.val(this.getValue()),this.$input.attr("value",this.$input.val());this.isSetup&&(e.silent||this.trigger("change",this.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var e=this.$control_input;this.items.length?e.removeAttr("placeholder"):e.attr("placeholder",this.settings.placeholder),e.triggerHandler("update",{force:!0})}},open:function(){this.isLocked||this.isOpen||"multi"===this.settings.mode&&this.isFull()||(this.focus(),this.isOpen=!0,this.refreshState(),this.$dropdown.css({visibility:"hidden",display:"block"}),this.positionDropdown(),this.$dropdown.css({visibility:"visible"}),this.trigger("dropdown_open",this.$dropdown))},close:function(){var e=this.isOpen;"single"===this.settings.mode&&this.items.length&&(this.hideInput(),this.isBlurring||this.$control_input.blur()),this.isOpen=!1,this.$dropdown.hide(),this.setActiveOption(null),this.refreshState(),e&&this.trigger("dropdown_close",this.$dropdown)},positionDropdown:function(){var e=this.$control,t="body"===this.settings.dropdownParent?e.offset():e.position();t.top+=e.outerHeight(!0),this.$dropdown.css({width:e[0].getBoundingClientRect().width,top:t.top,left:t.left})},clear:function(e){this.items.length&&(this.$control.children(":not(input)").remove(),this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updatePlaceholder(),this.updateOriginalInput({silent:e}),this.refreshState(),this.showInput(),this.trigger("clear"))},insertAtCaret:function(e){var t=Math.min(this.caretPos,this.items.length),n=e[0],i=this.buffer||this.$control[0];0===t?i.insertBefore(n,i.firstChild):i.insertBefore(n,i.childNodes[t]),this.setCaret(t+1)},deleteSelection:function(t){var n,i,o,s,r,a,l,u,c;if(o=t&&8===t.keyCode?-1:1,s=m(this.$control_input[0]),this.$activeOption&&!this.settings.hideSelected&&(l=this.getAdjacentOption(this.$activeOption,-1).attr("data-value")),r=[],this.$activeItems.length){for(c=this.$control.children(".active:"+(o>0?"last":"first")),a=this.$control.children(":not(input)").index(c),o>0&&a++,n=0,i=this.$activeItems.length;n<i;n++)r.push(e(this.$activeItems[n]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(this.isFocused||"single"===this.settings.mode)&&this.items.length&&(o<0&&0===s.start&&0===s.length?r.push(this.items[this.caretPos-1]):o>0&&s.start===this.$control_input.val().length&&r.push(this.items[this.caretPos]));if(!r.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete.apply(this,[r]))return!1;for(void 0!==a&&this.setCaret(a);r.length;)this.removeItem(r.pop());return this.showInput(),this.positionDropdown(),this.refreshOptions(!0),l&&(u=this.getOption(l)).length&&this.setActiveOption(u),!0},advanceSelection:function(e,t){var n,i,o,s,r;0!==e&&(this.rtl&&(e*=-1),n=e>0?"last":"first",i=m(this.$control_input[0]),this.isFocused&&!this.isInputHidden?(s=this.$control_input.val().length,(e<0?0===i.start&&0===i.length:i.start===s)&&!s&&this.advanceCaret(e,t)):(r=this.$control.children(".active:"+n)).length&&(o=this.$control.children(":not(input)").index(r),this.setActiveItem(null),this.setCaret(e>0?o+1:o)))},advanceCaret:function(e,t){var n,i;0!==e&&(n=e>0?"next":"prev",this.isShiftDown?(i=this.$control_input[n]()).length&&(this.hideInput(),this.setActiveItem(i),t&&t.preventDefault()):this.setCaret(this.caretPos+e))},setCaret:function(t){var n,i,o,s;if(t="single"===this.settings.mode?this.items.length:Math.max(0,Math.min(this.items.length,t)),!this.isPending)for(n=0,i=(o=this.$control.children(":not(input)")).length;n<i;n++)s=e(o[n]).detach(),n<t?this.$control_input.before(s):this.$control.append(s);this.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.$input.prop("disabled",!0),this.$control_input.prop("disabled",!0).prop("tabindex",-1),this.isDisabled=!0,this.lock()},enable:function(){this.$input.prop("disabled",!1),this.$control_input.prop("disabled",!1).prop("tabindex",this.tabIndex),this.isDisabled=!1,this.unlock()},destroy:function(){var t=this.eventNS,n=this.revertSettings;this.trigger("destroy"),this.off(),this.$wrapper.remove(),this.$dropdown.remove(),this.$input.html("").append(n.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:n.tabindex}).show(),this.$control_input.removeData("grow"),this.$input.removeData("selectize"),0==--q.count&&q.$testInput&&(q.$testInput.remove(),q.$testInput=void 0),e(window).off(t),e(document).off(t),e(document.body).off(t),delete this.$input[0].selectize},render:function(t,n){var i,o,s="",r=!1;return"option"!==t&&"item"!==t||(r=!!(i=p(n[this.settings.valueField]))),r&&(d(this.renderCache[t])||(this.renderCache[t]={}),this.renderCache[t].hasOwnProperty(i))?this.renderCache[t][i]:(s=e(this.settings.render[t].apply(this,[n,h])),"option"===t||"option_create"===t?n[this.settings.disabledField]||s.attr("data-selectable",""):"optgroup"===t&&(o=n[this.settings.optgroupValueField]||"",s.attr("data-group",o),n[this.settings.disabledField]&&s.attr("data-disabled","")),"option"!==t&&"item"!==t||s.attr("data-value",i||""),r&&(this.renderCache[t][i]=s[0]),s[0])},clearCache:function(e){void 0===e?this.renderCache={}:delete this.renderCache[e]},canCreate:function(e){if(!this.settings.create)return!1;var t=this.settings.createFilter;return e.length&&("function"!=typeof t||t.apply(this,[e]))&&("string"!=typeof t||new RegExp(t).test(e))&&(!(t instanceof RegExp)||t.test(e))}}),q.count=0,q.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},e.fn.selectize=function(t){var n=e.fn.selectize.defaults,i=e.extend({},n,t),o=i.dataAttr,s=i.labelField,r=i.valueField,a=i.disabledField,l=i.optgroupField,u=i.optgroupLabelField,c=i.optgroupValueField;return this.each(function(){if(!this.selectize){var d=e(this),h=this.tagName.toLowerCase(),f=d.attr("placeholder")||d.attr("data-placeholder");f||i.allowEmptyOption||(f=d.children('option[value=""]').text());var g={placeholder:f,options:[],optgroups:[],items:[]};"select"===h?function(t,n){var d,h,f,g,m=n.options,q={},v=function(e){var t=o&&e.attr(o);return"string"==typeof t&&t.length?JSON.parse(t):null},_=function(t,o){t=e(t);var u=p(t.val());if(u||i.allowEmptyOption)if(q.hasOwnProperty(u)){if(o){var c=q[u][l];c?e.isArray(c)?c.push(o):q[u][l]=[c,o]:q[u][l]=o}}else{var d=v(t)||{};d[s]=d[s]||t.text(),d[r]=d[r]||u,d[a]=d[a]||t.prop("disabled"),d[l]=d[l]||o,q[u]=d,m.push(d),t.is(":selected")&&n.items.push(u)}},b=function(t){var i,o,s,r,l;for((s=(t=e(t)).attr("label"))&&((r=v(t)||{})[u]=s,r[c]=s,r[a]=t.prop("disabled"),n.optgroups.push(r)),i=0,o=(l=e("option",t)).length;i<o;i++)_(l[i],s)};for(n.maxItems=t.attr("multiple")?null:1,d=0,h=(g=t.children()).length;d<h;d++)"optgroup"===(f=g[d].tagName.toLowerCase())?b(g[d]):"option"===f&&_(g[d])}(d,g):function(t,n){var a,l,u,c,d=t.attr(o);if(d)for(n.options=JSON.parse(d),a=0,l=n.options.length;a<l;a++)n.items.push(n.options[a][r]);else{var p=e.trim(t.val()||"");if(!i.allowEmptyOption&&!p.length)return;for(a=0,l=(u=p.split(i.delimiter)).length;a<l;a++)(c={})[s]=u[a],c[r]=u[a],n.options.push(c);n.items=u}}(d,g),new q(d,e.extend(!0,{},n,g,t))}})},e.fn.selectize.defaults=q.defaults,e.fn.selectize.support={validity:c},q.define("drag_drop",function(t){if(!e.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var n,i=this;i.lock=(n=i.lock,function(){var e=i.$control.data("sortable");return e&&e.disable(),n.apply(i,arguments)}),i.unlock=function(){var e=i.unlock;return function(){var t=i.$control.data("sortable");return t&&t.enable(),e.apply(i,arguments)}}(),i.setup=function(){var t=i.setup;return function(){t.apply(this,arguments);var n=i.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:i.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),n.css({overflow:"visible"})},stop:function(){n.css({overflow:"hidden"});var t=i.$activeItems?i.$activeItems.slice():null,o=[];n.children("[data-value]").each(function(){o.push(e(this).attr("data-value"))}),i.setValue(o),i.setActiveItem(t)}})}}()}}),q.define("dropdown_header",function(t){var n,i=this;t=e.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a></div></div>'}},t),i.setup=(n=i.setup,function(){n.apply(i,arguments),i.$dropdown_header=e(t.html(t)),i.$dropdown.prepend(i.$dropdown_header)})}),q.define("optgroup_columns",function(t){var n,i=this;t=e.extend({equalizeWidth:!0,equalizeHeight:!0},t),this.getAdjacentOption=function(t,n){var i=t.closest("[data-group]").find("[data-selectable]"),o=i.index(t)+n;return o>=0&&o<i.length?i.eq(o):e()},this.onKeyDown=(n=i.onKeyDown,function(e){var t,o,s,r;return!this.isOpen||37!==e.keyCode&&39!==e.keyCode?n.apply(this,arguments):(i.ignoreHover=!0,t=(r=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),void((o=(s=(r=37===e.keyCode?r.prev("[data-group]"):r.next("[data-group]")).find("[data-selectable]")).eq(Math.min(s.length-1,t))).length&&this.setActiveOption(o)))});var o=function(){var e,t=o.width,n=document;return void 0===t&&((e=n.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,n.body.appendChild(e),t=o.width=e.offsetWidth-e.clientWidth,n.body.removeChild(e)),t},s=function(){var n,s,r,a,l,u,c;if((s=(c=e("[data-group]",i.$dropdown_content)).length)&&i.$dropdown_content.width()){if(t.equalizeHeight){for(r=0,n=0;n<s;n++)r=Math.max(r,c.eq(n).height());c.css({height:r})}t.equalizeWidth&&(u=i.$dropdown_content.innerWidth()-o(),a=Math.round(u/s),c.css({width:a}),s>1&&(l=u-a*(s-1),c.eq(s-1).css({width:l})))}};(t.equalizeHeight||t.equalizeWidth)&&(f.after(this,"positionDropdown",s),f.after(this,"refreshOptions",s))}),q.define("remove_button",function(t){t=e.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t),"single"!==this.settings.mode?function(t,n){var i,o=t,s='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+h(n.title)+'">'+n.label+"</a>";t.setup=(i=o.setup,function(){if(n.append){var r=o.settings.render.item;o.settings.render.item=function(e){return n=r.apply(t,arguments),i=s,o=n.search(/(<\/[^>]+>\s*)$/),n.substring(0,o)+i+n.substring(o);var n,i,o}}i.apply(t,arguments),t.$control.on("click","."+n.className,function(t){if(t.preventDefault(),!o.isLocked){var n=e(t.currentTarget).parent();o.setActiveItem(n),o.deleteSelection()&&o.setCaret(o.items.length)}})})}(this,t):function(t,n){n.className="remove-single";var i,o=t,s='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+h(n.title)+'">'+n.label+"</a>";t.setup=(i=o.setup,function(){if(n.append){var r=e(o.$input.context).attr("id"),a=(e("#"+r),o.settings.render.item);o.settings.render.item=function(n){return i=a.apply(t,arguments),o=s,e("<span>").append(i).append(o);var i,o}}i.apply(t,arguments),t.$control.on("click","."+n.className,function(e){e.preventDefault(),o.isLocked||o.clear()})})}(this,t)}),q.define("restore_on_backspace",function(e){var t,n=this;e.text=e.text||function(e){return e[this.settings.labelField]},this.onKeyDown=(t=n.onKeyDown,function(n){var i,o;return 8===n.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(i=this.caretPos-1)>=0&&i<this.items.length?(o=this.options[this.items[i]],this.deleteSelection(n)&&(this.setTextboxValue(e.text.apply(this,[o])),this.refreshOptions(!0)),void n.preventDefault()):t.apply(this,arguments)})}),q})?i.apply(t,o):i)||(e.exports=s)},nif5:function(e,t,n){var i,o;void 0===(o="function"==typeof(i=function(){var e={mixin:function(e){e.plugins={},e.prototype.initializePlugins=function(e){var n,i,o,s=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},t.isArray(e))for(n=0,i=e.length;n<i;n++)"string"==typeof e[n]?s.push(e[n]):(this.plugins.settings[e[n].name]=e[n].options,s.push(e[n].name));else if(e)for(o in e)e.hasOwnProperty(o)&&(this.plugins.settings[o]=e[o],s.push(o));for(;s.length;)this.require(s.shift())},e.prototype.loadPlugin=function(t){var n=this.plugins,i=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');n.requested[t]=!0,n.loaded[t]=i.fn.apply(this,[this.plugins.settings[t]||{}]),n.names.push(t)},e.prototype.require=function(e){var t=this.plugins;if(!this.plugins.loaded.hasOwnProperty(e)){if(t.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');this.loadPlugin(e)}return t.loaded[e]},e.define=function(t,n){e.plugins[t]={name:t,fn:n}}}},t={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}};return e})?i.call(t,n,t,e):i)||(e.exports=o)},q9lp:function(e,t){
/*! offline-js 0.7.19 */
(function(){var e,t,n,i,o,s;i=function(e,t){var n,i,o;for(n in i=[],t.prototype)try{o=t.prototype[n],null==e[n]&&"function"!=typeof o?i.push(e[n]=o):i.push(void 0)}catch(e){}return i},(e={}).options=window.Offline&&window.Offline.options||{},n={checks:{xhr:{url:function(){return"/favicon.ico?_="+(new Date).getTime()},timeout:5e3,type:"HEAD"},image:{url:function(){return"/favicon.ico?_="+(new Date).getTime()}},active:"xhr"},checkOnLoad:!1,interceptRequests:!0,reconnect:!0,deDupBody:!1},o=function(e,t){var n,i,o,s,r;for(n=e,i=o=0,s=(r=t.split(".")).length;o<s&&"object"==typeof(n=n[r[i]]);i=++o);return i===r.length-1?n:void 0},e.getOption=function(t){var i,s;return"function"==typeof(s=null!=(i=o(e.options,t))?i:o(n,t))?s():s},"function"==typeof window.addEventListener&&window.addEventListener("online",function(){return setTimeout(e.confirmUp,100)},!1),"function"==typeof window.addEventListener&&window.addEventListener("offline",function(){return e.confirmDown()},!1),e.state="up",e.markUp=function(){if(e.trigger("confirmed-up"),"up"!==e.state)return e.state="up",e.trigger("up")},e.markDown=function(){if(e.trigger("confirmed-down"),"down"!==e.state)return e.state="down",e.trigger("down")},s={},e.on=function(t,n,i){var o,r,a,l,u;if((r=t.split(" ")).length>1){for(u=[],a=0,l=r.length;a<l;a++)o=r[a],u.push(e.on(o,n,i));return u}return null==s[t]&&(s[t]=[]),s[t].push([i,n])},e.off=function(e,t){var n,i,o;if(null!=s[e]){if(t){for(n=0,o=[];n<s[e].length;)(i=s[e][n])[0],i[1]===t?o.push(s[e].splice(n,1)):o.push(n++);return o}return s[e]=[]}},e.trigger=function(e){var t,n,i,o,r,a,l;if(null!=s[e]){for(l=[],i=0,o=(r=s[e].slice(0)).length;i<o;i++)t=(a=r[i])[0],n=a[1],l.push(n.call(t));return l}},t=function(e,t,n){var i,o,s,r,a;return a=function(){return e.status&&e.status<12e3?t():n()},null===e.onprogress?(i=e.onerror,e.onerror=function(){return n(),"function"==typeof i?i.apply(null,arguments):void 0},r=e.ontimeout,e.ontimeout=function(){return n(),"function"==typeof r?r.apply(null,arguments):void 0},o=e.onload,e.onload=function(){return a(),"function"==typeof o?o.apply(null,arguments):void 0}):(s=e.onreadystatechange,e.onreadystatechange=function(){return 4===e.readyState?a():0===e.readyState&&n(),"function"==typeof s?s.apply(null,arguments):void 0})},e.checks={},e.checks.xhr=function(){var n;(n=new XMLHttpRequest).offline=!1,n.open(e.getOption("checks.xhr.type"),e.getOption("checks.xhr.url"),!0),null!=n.timeout&&(n.timeout=e.getOption("checks.xhr.timeout")),t(n,e.markUp,e.markDown);try{n.send()}catch(t){e.markDown()}return n},e.checks.image=function(){var t;(t=document.createElement("img")).onerror=e.markDown,t.onload=e.markUp,t.src=e.getOption("checks.image.url")},e.checks.down=e.markDown,e.checks.up=e.markUp,e.check=function(){return e.trigger("checking"),e.checks[e.getOption("checks.active")]()},e.confirmUp=e.confirmDown=e.check,e.onXHR=function(e){var t,n,o;if(o=function(t,n){var i;return i=t.open,t.open=function(o,s,r,a,l){return e({type:o,url:s,async:r,flags:n,user:a,password:l,xhr:t}),i.apply(t,arguments)}},n=window.XMLHttpRequest,window.XMLHttpRequest=function(e){var t,i,s;return s=new n(e),o(s,e),i=s.setRequestHeader,s.headers={},s.setRequestHeader=function(e,t){return s.headers[e]=t,i.call(s,e,t)},t=s.overrideMimeType,s.overrideMimeType=function(e){return s.mimeType=e,t.call(s,e)},s},i(window.XMLHttpRequest,n),null!=window.XDomainRequest)return t=window.XDomainRequest,window.XDomainRequest=function(){var e;return e=new t,o(e),e},i(window.XDomainRequest,t)},setTimeout(function(){if(e.getOption("interceptRequests")&&e.onXHR(function(n){var i;if(!1!==(i=n.xhr).offline)return t(i,e.markUp,e.confirmDown)}),e.getOption("checkOnLoad"))return e.check()},0),window.Offline=e}).call(this),function(){var e,t,n,i,o,s,r,a,l;if(!window.Offline)throw new Error("Offline Reconnect brought in without offline.js");i=Offline.reconnect={},s=null,o=function(){var e;return null!=i.state&&"inactive"!==i.state&&Offline.trigger("reconnect:stopped"),i.state="inactive",i.remaining=i.delay=null!=(e=Offline.getOption("reconnect.initialDelay"))?e:3},t=function(){var e,t;return e=null!=(t=Offline.getOption("reconnect.delay"))?t:Math.min(Math.ceil(1.5*i.delay),3600),i.remaining=i.delay=e},r=function(){if("connecting"!==i.state)return i.remaining-=1,Offline.trigger("reconnect:tick"),0===i.remaining?a():void 0},a=function(){if("waiting"===i.state)return Offline.trigger("reconnect:connecting"),i.state="connecting",Offline.check()},e=function(){if(Offline.getOption("reconnect"))return o(),i.state="waiting",Offline.trigger("reconnect:started"),s=setInterval(r,1e3)},l=function(){return null!=s&&clearInterval(s),o()},n=function(){if(Offline.getOption("reconnect"))return"connecting"===i.state?(Offline.trigger("reconnect:failure"),i.state="waiting",t()):void 0},i.tryNow=a,o(),Offline.on("down",e),Offline.on("confirmed-down",n),Offline.on("up",l)}.call(this),function(){var e,t,n,i,o,s;if(!window.Offline)throw new Error("Requests module brought in without offline.js");n=[],s=!1,i=function(e){if(!1!==Offline.getOption("requests"))return Offline.trigger("requests:capture"),"down"!==Offline.state&&(s=!0),n.push(e)},o=function(e){var t,n,i,o,s,r,a,l,u;if(u=e.xhr,r=e.url,s=e.type,a=e.user,i=e.password,t=e.body,!1!==Offline.getOption("requests")){for(n in u.abort(),u.open(s,r,!0,a,i),o=u.headers)l=o[n],u.setRequestHeader(n,l);return u.mimeType&&u.overrideMimeType(u.mimeType),u.send(t)}},e=function(){return n=[]},t=function(){var t,i,s,r,a,l,u;if(!1!==Offline.getOption("requests")){for(Offline.trigger("requests:flush"),l={},i=0,r=n.length;i<r;i++)u=(a=n[i]).url.replace(/(\?|&)_=[0-9]+/,function(e,t){return"?"===t?t:""}),Offline.getOption("deDupBody")?(t="[object Object]"===(t=a.body).toString()?JSON.stringify(t):t.toString(),l[a.type.toUpperCase()+" - "+u+" - "+t]=a):l[a.type.toUpperCase()+" - "+u]=a;for(s in l)a=l[s],o(a);return e()}},setTimeout(function(){if(!1!==Offline.getOption("requests"))return Offline.on("confirmed-up",function(){if(s)return s=!1,e()}),Offline.on("up",t),Offline.on("down",function(){return s=!1}),Offline.onXHR(function(e){var t,n,o,s,r;if(r=e.xhr,o=e.async,!1!==r.offline&&(s=function(){return i(e)},n=r.send,r.send=function(t){return e.body=t,n.apply(r,arguments)},o))return null===r.onprogress?(r.addEventListener("error",s,!1),r.addEventListener("timeout",s,!1)):(t=r.onreadystatechange,r.onreadystatechange=function(){return 0===r.readyState?s():4===r.readyState&&(0===r.status||r.status>=12e3)&&s(),"function"==typeof t?t.apply(null,arguments):void 0})}),Offline.requests={flush:t,clear:e}},0)}.call(this),function(){var e,t,n,i,o,s;if(!Offline)throw new Error("Offline simulate brought in without offline.js");for(t=0,n=(i=["up","down"]).length;t<n;t++){s=i[t];try{o=document.querySelector("script[data-simulate='"+s+"']")||("undefined"!=typeof localStorage&&null!==localStorage?localStorage.OFFLINE_SIMULATE:void 0)===s}catch(e){o=!1}}o&&(null==Offline.options&&(Offline.options={}),null==(e=Offline.options).checks&&(e.checks={}),Offline.options.checks.active=s)}.call(this),function(){var e,t,n,i,o,s,r,a,l,u,c;if(!window.Offline)throw new Error("Offline UI brought in without offline.js");i=function(e){var t;return(t=document.createElement("div")).innerHTML=e,t.children[0]},o=n=null,t=function(e){return l(e),o.className+=" "+e},l=function(e){return o.className=o.className.replace(new RegExp("(^| )"+e.split(" ").join("|")+"( |$)","gi")," ")},r={},s=function(e,n){return t(e),null!=r[e]&&clearTimeout(r[e]),r[e]=setTimeout(function(){return l(e),delete r[e]},1e3*n)},c=function(e){var t,n,i;for(n in i={day:86400,hour:3600,minute:60,second:1})if(e>=(t=i[n]))return[Math.floor(e/t),n];return["now",""]},u=function(){var e,s;return o=i('<div class="offline-ui"><div class="offline-ui-content"></div></div>'),document.body.appendChild(o),null!=Offline.reconnect&&Offline.getOption("reconnect")&&(o.appendChild(i('<a href class="offline-ui-retry"></a>')),s=function(e){return e.preventDefault(),Offline.reconnect.tryNow()},null!=(e=o.querySelector(".offline-ui-retry")).addEventListener?e.addEventListener("click",s,!1):e.attachEvent("click",s)),t("offline-ui-"+Offline.state),n=o.querySelector(".offline-ui-content")},a=function(){return u(),Offline.on("up",function(){return l("offline-ui-down"),t("offline-ui-up"),s("offline-ui-up-2s",2),s("offline-ui-up-5s",5)}),Offline.on("down",function(){return l("offline-ui-up"),t("offline-ui-down"),s("offline-ui-down-2s",2),s("offline-ui-down-5s",5)}),Offline.on("reconnect:connecting",function(){return t("offline-ui-connecting"),l("offline-ui-waiting")}),Offline.on("reconnect:tick",function(){var e,i,o;return t("offline-ui-waiting"),l("offline-ui-connecting"),i=(e=c(Offline.reconnect.remaining))[0],o=e[1],n.setAttribute("data-retry-in-value",i),n.setAttribute("data-retry-in-unit",o)}),Offline.on("reconnect:stopped",function(){return l("offline-ui-connecting offline-ui-waiting"),n.setAttribute("data-retry-in-value",null),n.setAttribute("data-retry-in-unit",null)}),Offline.on("reconnect:failure",function(){return s("offline-ui-reconnect-failed-2s",2),s("offline-ui-reconnect-failed-5s",5)}),Offline.on("reconnect:success",function(){return s("offline-ui-reconnect-succeeded-2s",2),s("offline-ui-reconnect-succeeded-5s",5)})},"complete"===document.readyState?a():null!=document.addEventListener?document.addEventListener("DOMContentLoaded",a,!1):(e=document.onreadystatechange,document.onreadystatechange=function(){return"complete"===document.readyState&&a(),"function"==typeof e?e.apply(null,arguments):void 0})}.call(this)},uQcr:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global){var qq=function(e){"use strict";return{hide:function(){return e.style.display="none",this},attach:function(t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),function(){qq(e).detach(t,n)}},detach:function(t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n),this},contains:function(t){return!!t&&(e===t||(e.contains?e.contains(t):!!(8&t.compareDocumentPosition(e))))},insertBefore:function(t){return t.parentNode.insertBefore(e,t),this},remove:function(){return e.parentNode.removeChild(e),this},css:function(t){if(null==e.style)throw new qq.Error("Can't apply style to node as it is not on the HTMLElement prototype chain!");return null!=t.opacity&&"string"!=typeof e.style.opacity&&void 0!==e.filters&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t),this},hasClass:function(t,n){var i=new RegExp("(^| )"+t+"( |$)");return i.test(e.className)||!(!n||!i.test(e.parentNode.className))},addClass:function(t){return qq(e).hasClass(t)||(e.className+=" "+t),this},removeClass:function(t){var n=new RegExp("(^| )"+t+"( |$)");return e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t,n){var i,o=[];return n&&e.querySelector?e.querySelector("."+t):e.querySelectorAll?e.querySelectorAll("."+t):(i=e.getElementsByTagName("*"),qq.each(i,function(e,n){qq(n).hasClass(t)&&o.push(n)}),n?o[0]:o)},getFirstByClass:function(t){return qq(e).getByClass(t,!0)},children:function(){for(var t=[],n=e.firstChild;n;)1===n.nodeType&&t.push(n),n=n.nextSibling;return t},setText:function(t){return e.innerText=t,e.textContent=t,this},clearText:function(){return qq(e).setText("")},hasAttribute:function(t){var n;return e.hasAttribute?!!e.hasAttribute(t)&&null==/^false$/i.exec(e.getAttribute(t)):void 0!==(n=e[t])&&null==/^false$/i.exec(n)}}},ExifRestorer;!function(){"use strict";var div;qq.canvasToBlob=function(e,t,n){return qq.dataUriToBlob(e.toDataURL(t,n))},qq.dataUriToBlob=function(e){var t,n,i,o,s,r,a,l;return n=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURI(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],t=new ArrayBuffer(n.length),i=new Uint8Array(t),qq.each(n,function(e,t){i[e]=t.charCodeAt(0)}),s=t,r=o,a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,(l=a&&new a)?(l.append(s),l.getBlob(r)):new Blob([s],{type:r})},qq.log=function(e,t){window.console&&(t&&"info"!==t?window.console[t]?window.console[t](e):window.console.log("<"+t+"> "+e):window.console.log(e))},qq.isObject=function(e){return e&&!e.nodeType&&"[object Object]"===Object.prototype.toString.call(e)},qq.isFunction=function(e){return"function"==typeof e},qq.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)||e&&window.ArrayBuffer&&e.buffer&&e.buffer.constructor===ArrayBuffer},qq.isItemList=function(e){return"[object DataTransferItemList]"===Object.prototype.toString.call(e)},qq.isNodeList=function(e){return"[object NodeList]"===Object.prototype.toString.call(e)||e.item&&e.namedItem},qq.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},qq.trimStr=function(e){return String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},qq.format=function(e){var t=Array.prototype.slice.call(arguments,1),n=e,i=n.indexOf("{}");return qq.each(t,function(e,t){var o=n.substring(0,i),s=n.substring(i+2);if((i=(n=o+t+s).indexOf("{}",i+t.length))<0)return!1}),n},qq.isFile=function(e){return window.File&&"[object File]"===Object.prototype.toString.call(e)},qq.isFileList=function(e){return window.FileList&&"[object FileList]"===Object.prototype.toString.call(e)},qq.isFileOrInput=function(e){return qq.isFile(e)||qq.isInput(e)},qq.isInput=function(e,t){var n=function(e){var n=e.toLowerCase();return t?"file"!==n:"file"===n};return!!(window.HTMLInputElement&&"[object HTMLInputElement]"===Object.prototype.toString.call(e)&&e.type&&n(e.type))||!!(e.tagName&&"input"===e.tagName.toLowerCase()&&e.type&&n(e.type))},qq.isBlob=function(e){if(window.Blob&&"[object Blob]"===Object.prototype.toString.call(e))return!0},qq.isXhrUploadSupported=function(){var e=document.createElement("input");return e.type="file",void 0!==e.multiple&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&void 0!==qq.createXhrInstance().upload},qq.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return qq.log("Neither XHR or ActiveX are supported!","error"),null}},qq.isFolderDropSupported=function(e){return e.items&&e.items.length>0&&e.items[0].webkitGetAsEntry},qq.isFileChunkingSupported=function(){return!qq.androidStock()&&qq.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)},qq.sliceBlob=function(e,t,n){return(e.slice||e.mozSlice||e.webkitSlice).call(e,t,n)},qq.arrayBufferToHex=function(e){var t="",n=new Uint8Array(e);return qq.each(n,function(e,n){var i=n.toString(16);i.length<2&&(i="0"+i),t+=i}),t},qq.readBlobToHex=function(e,t,n){var i=qq.sliceBlob(e,t,t+n),o=new FileReader,s=new qq.Promise;return o.onload=function(){s.success(qq.arrayBufferToHex(o.result))},o.onerror=s.failure,o.readAsArrayBuffer(i),s},qq.extend=function(e,t,n){return qq.each(t,function(t,i){n&&qq.isObject(i)?(void 0===e[t]&&(e[t]={}),qq.extend(e[t],i,!0)):e[t]=i}),e},qq.override=function(e,t){var n={},i=t(n);return qq.each(i,function(t,i){void 0!==e[t]&&(n[t]=e[t]),e[t]=i}),e},qq.indexOf=function(e,t,n){if(e.indexOf)return e.indexOf(t,n);n=n||0;var i=e.length;for(n<0&&(n+=i);n<i;n+=1)if(e.hasOwnProperty(n)&&e[n]===t)return n;return-1},qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},qq.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")||-1!==navigator.userAgent.indexOf("Trident")},qq.ie7=function(){return-1!==navigator.userAgent.indexOf("MSIE 7")},qq.ie8=function(){return-1!==navigator.userAgent.indexOf("MSIE 8")},qq.ie10=function(){return-1!==navigator.userAgent.indexOf("MSIE 10")},qq.ie11=function(){return qq.ie()&&-1!==navigator.userAgent.indexOf("rv:11")},qq.edge=function(){return navigator.userAgent.indexOf("Edge")>=0},qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")},qq.opera=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Opera")},qq.firefox=function(){return!qq.edge()&&!qq.ie11()&&-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor},qq.windows=function(){return"Win32"===navigator.platform},qq.android=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")},qq.androidStock=function(){return qq.android()&&navigator.userAgent.toLowerCase().indexOf("chrome")<0},qq.ios6=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 6_")},qq.ios7=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 7_")},qq.ios8=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_")},qq.ios800=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_0 ")},qq.ios=function(){return-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("iPod")||-1!==navigator.userAgent.indexOf("iPhone")},qq.iosChrome=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf("CriOS")},qq.iosSafari=function(){return qq.ios()&&!qq.iosChrome()&&-1!==navigator.userAgent.indexOf("Safari")},qq.iosSafariWebView=function(){return qq.ios()&&!qq.iosChrome()&&!qq.iosSafari()},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.toElement=(div=document.createElement("div"),function(e){div.innerHTML=e;var t=div.firstChild;return div.removeChild(t),t}),qq.each=function(e,t){var n;if(e)if(window.Storage&&e.constructor===window.Storage)for(n=0;n<e.length&&!1!==t(e.key(n),e.getItem(e.key(n)));n++);else if(qq.isArray(e)||qq.isItemList(e)||qq.isNodeList(e))for(n=0;n<e.length&&!1!==t(n,e[n]);n++);else if(qq.isString(e))for(n=0;n<e.length&&!1!==t(n,e.charAt(n));n++);else for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!1===t(n,e[n]))break},qq.bind=function(e,t){if(qq.isFunction(e)){var n=Array.prototype.slice.call(arguments,2);return function(){var i=qq.extend([],n);return arguments.length&&(i=i.concat(Array.prototype.slice.call(arguments))),e.apply(t,i)}}throw new Error("first parameter must be a function!")},qq.obj2url=function(e,t,n){var i=[],o="&",s=function(e,n){var o=t?/\[\]$/.test(t)?t:t+"["+n+"]":n;"undefined"!==o&&"undefined"!==n&&i.push("object"==typeof e?qq.obj2url(e,o,!0):"[object Function]"===Object.prototype.toString.call(e)?encodeURIComponent(o)+"="+encodeURIComponent(e()):encodeURIComponent(o)+"="+encodeURIComponent(e))};return!n&&t?(o=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",i.push(t),i.push(qq.obj2url(e))):"[object Array]"===Object.prototype.toString.call(e)&&void 0!==e?qq.each(e,function(e,t){s(t,e)}):null!=e&&"object"==typeof e?qq.each(e,function(e,t){s(t,e)}):i.push(encodeURIComponent(t)+"="+encodeURIComponent(e)),t?i.join(o):i.join(o).replace(/^&/,"").replace(/%20/g,"+")},qq.obj2FormData=function(e,t,n){return t||(t=new FormData),qq.each(e,function(e,i){e=n?n+"["+e+"]":e,qq.isObject(i)?qq.obj2FormData(i,t,e):qq.isFunction(i)?t.append(e,i()):t.append(e,i)}),t},qq.obj2Inputs=function(e,t){var n;return t||(t=document.createElement("form")),qq.obj2FormData(e,{append:function(e,i){(n=document.createElement("input")).setAttribute("name",e),n.setAttribute("value",i),t.appendChild(n)}}),t},qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")},qq.getExtension=function(e){var t=e.lastIndexOf(".")+1;if(t>0)return e.substr(t,e.length-t)},qq.getFilename=function(e){return qq.isInput(e)?e.value.replace(/.*(\/|\\)/,""):qq.isFile(e)&&null!==e.fileName&&void 0!==e.fileName?e.fileName:e.name},qq.DisposeSupport=function(){var e=[];return{dispose:function(){var t;do{(t=e.shift())&&t()}while(t)},attach:function(){var e=arguments;this.addDisposer(qq(e[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(t){e.push(t)}}}}(),function(){"use strict";void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return qq}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(),function(){"use strict";qq.Error=function(e){this.message="[Fine Uploader "+qq.version+"] "+e},qq.Error.prototype=new Error}(),qq.version="5.16.2",qq.supportedFeatures=function(){"use strict";var e,t,n,i,o,s,r,a,l,u,c,d,p,h,f,g,m;function q(){return!!window.XMLHttpRequest&&void 0!==qq.createXhrInstance().withCredentials}function v(){return void 0!==window.XDomainRequest}return e=function(){var e,t=!0;try{(e=document.createElement("input")).type="file",qq(e).hide(),e.disabled&&(t=!1)}catch(e){t=!1}return t}(),t=(i=e&&qq.isXhrUploadSupported())&&!qq.androidStock(),o=(n=i&&(("draggable"in(g=document.createElement("span"))||"ondragstart"in g&&"ondrop"in g)&&!qq.android()&&!qq.ios()))&&((m=document.createElement("input")).type="file",!!("webkitdirectory"in(m||document.querySelectorAll("input[type=file]")[0]))),s=i&&qq.isFileChunkingSupported(),r=i&&s&&function(){try{return!!window.localStorage&&qq.isFunction(window.localStorage.setItem)}catch(e){return!1}}(),a=i&&(qq.chrome()||qq.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/),l=e&&(void 0!==window.postMessage||i),c=q(),u=v(),d=!!q()||v(),p=void 0!==document.createElement("input").webkitdirectory,h=i&&void 0!==window.FileReader,f=!!i&&!qq.androidStock()&&!qq.iosChrome(),{ajaxUploading:i,blobUploading:t,canDetermineSize:i,chunking:s,deleteFileCors:d,deleteFileCorsXdr:u,deleteFileCorsXhr:c,dialogElement:!!window.HTMLDialogElement,fileDrop:n,folderDrop:o,folderSelection:p,imagePreviews:h,imageValidation:h,itemSizeValidation:i,pause:s,progressBar:f,resume:r,scaling:h&&t,tiffPreviews:qq.safari(),unlimitedScaledImageSize:!qq.ios(),uploading:e,uploadCors:l,uploadCustomHeaders:i,uploadNonMultipart:i,uploadViaPaste:a}}(),qq.isGenericPromise=function(e){"use strict";return!!(e&&e.then&&qq.isFunction(e.then))},qq.Promise=function(){"use strict";var e,t,n=[],i=[],o=[],s=0;qq.extend(this,{then:function(o,r){return 0===s?(o&&n.push(o),r&&i.push(r)):-1===s?r&&r.apply(null,t):o&&o.apply(null,e),this},done:function(n){return 0===s?o.push(n):n.apply(null,void 0===t?e:t),this},success:function(){return s=1,e=arguments,n.length&&qq.each(n,function(t,n){n.apply(null,e)}),o.length&&qq.each(o,function(t,n){n.apply(null,e)}),this},failure:function(){return s=-1,t=arguments,i.length&&qq.each(i,function(e,n){n.apply(null,t)}),o.length&&qq.each(o,function(e,n){n.apply(null,t)}),this}})},qq.BlobProxy=function(e,t){"use strict";qq.extend(this,{referenceBlob:e,create:function(){return t(e)}})},qq.UploadButton=function(e){"use strict";var t,n,i=this,o=new qq.DisposeSupport,s={acceptFiles:null,element:null,focusClass:"qq-upload-button-focus",folders:!1,hoverClass:"qq-upload-button-hover",ios8BrowserCrashWorkaround:!1,multiple:!1,name:"qqfile",onChange:function(e){},title:null};function r(){var e=document.createElement("input");return e.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME,n),e.setAttribute("title",s.title),i.setMultiple(s.multiple,e),s.folders&&qq.supportedFeatures.folderSelection&&e.setAttribute("webkitdirectory",""),s.acceptFiles&&e.setAttribute("accept",s.acceptFiles),e.setAttribute("type","file"),e.setAttribute("name",s.name),qq(e).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:qq.ie()&&!qq.ie8()?"3500px":"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),!qq.ie7()&&qq(e).css({height:"100%"}),s.element.appendChild(e),o.attach(e,"change",function(){s.onChange(e)}),o.attach(e,"mouseover",function(){qq(s.element).addClass(s.hoverClass)}),o.attach(e,"mouseout",function(){qq(s.element).removeClass(s.hoverClass)}),o.attach(e,"focus",function(){qq(s.element).addClass(s.focusClass)}),o.attach(e,"blur",function(){qq(s.element).removeClass(s.focusClass)}),e}qq.extend(s,e),n=qq.getUniqueId(),qq(s.element).css({position:"relative",overflow:"hidden",direction:"ltr"}),qq.extend(this,{getInput:function(){return t},getButtonId:function(){return n},setMultiple:function(e,t){var n=t||this.getInput();s.ios8BrowserCrashWorkaround&&qq.ios8()&&(qq.iosChrome()||qq.iosSafariWebView())?n.setAttribute("multiple",""):e?n.setAttribute("multiple",""):n.removeAttribute("multiple")},setAcceptFiles:function(e){e!==s.acceptFiles&&t.setAttribute("accept",e)},reset:function(){t.parentNode&&qq(t).remove(),qq(s.element).removeClass(s.focusClass),t=null,t=r()}}),t=r()},qq.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id",qq.UploadData=function(e){"use strict";var t=[],n={},i={},o={},s={};function r(e){if(qq.isArray(e)){var n=[];return qq.each(e,function(e,i){n.push(t[i])}),n}return t[e]}qq.extend(this,{addFile:function(r){var a=r.status||qq.status.SUBMITTING,l=t.push({name:r.name,originalName:r.name,uuid:r.uuid,size:null==r.size?-1:r.size,status:a,file:r.file})-1;return r.batchId&&(t[l].batchId=r.batchId,void 0===s[r.batchId]&&(s[r.batchId]=[]),s[r.batchId].push(l)),r.proxyGroupId&&(t[l].proxyGroupId=r.proxyGroupId,void 0===o[r.proxyGroupId]&&(o[r.proxyGroupId]=[]),o[r.proxyGroupId].push(l)),t[l].id=l,n[r.uuid]=l,void 0===i[a]&&(i[a]=[]),i[a].push(l),r.onBeforeStatusChange&&r.onBeforeStatusChange(l),e.onStatusChange(l,null,a),l},retrieve:function(e){return qq.isObject(e)&&t.length?void 0!==e.id?r(e.id):void 0!==e.uuid?function(e){if(qq.isArray(e)){var i=[];return qq.each(e,function(e,o){i.push(t[n[o]])}),i}return t[n[e]]}(e.uuid):e.status?(o=e.status,s=[],a=[].concat(o),qq.each(a,function(e,n){var o=i[n];void 0!==o&&qq.each(o,function(e,n){s.push(t[n])})}),s):void 0:qq.extend([],t,!0);var o,s,a},removeFileRef:function(e){var t=r(e);t&&delete t.file},reset:function(){t=[],n={},i={},s={}},setStatus:function(n,o){var s=t[n].status,r=qq.indexOf(i[s],n);i[s].splice(r,1),t[n].status=o,void 0===i[o]&&(i[o]=[]),i[o].push(n),e.onStatusChange(n,s,o)},uuidChanged:function(e,i){var o=t[e].uuid;t[e].uuid=i,n[i]=e,delete n[o]},updateName:function(e,n){t[e].name=n},updateSize:function(e,n){t[e].size=n},setParentId:function(e,n){t[e].parentId=n},getIdsInProxyGroup:function(e){var n=t[e].proxyGroupId;return n?o[n]:[]},getIdsInBatch:function(e){var n=t[e].batchId;return s[n]}})},qq.status={SUBMITTING:"submitting",SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",PAUSED:"paused",UPLOADING:"uploading",UPLOAD_FINALIZING:"upload finalizing",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"},function(){"use strict";qq.basePublicApi={addBlobs:function(e,t,n){this.addFiles(e,t,n)},addInitialFiles:function(e){var t=this;qq.each(e,function(e,n){t._addCannedFile(n)})},addFiles:function(e,t,n){this._maybeHandleIos8SafariWorkaround();var i=0===this._storedIds.length?qq.getUniqueId():this._currentBatchId,o=qq.bind(function(e){this._handleNewFile({blob:e,name:this._options.blobs.defaultName},i,c)},this),s=qq.bind(function(e){this._handleNewFile(e,i,c)},this),r=qq.bind(function(e){var t=qq.canvasToBlob(e);this._handleNewFile({blob:t,name:this._options.blobs.defaultName+".png"},i,c)},this),a=qq.bind(function(e){var t=e.quality&&e.quality/100,n=qq.canvasToBlob(e.canvas,e.type,t);this._handleNewFile({blob:n,name:e.name},i,c)},this),l=qq.bind(function(e){if(qq.isInput(e)&&qq.supportedFeatures.ajaxUploading){var t=Array.prototype.slice.call(e.files),n=this;qq.each(t,function(e,t){n._handleNewFile(t,i,c)})}else this._handleNewFile(e,i,c)},this),u=this,c=[];this._currentBatchId=i,e&&(qq.isFileList(e)&&(e=Array.prototype.slice.call(e)),e=[].concat(e),qq.each(e,function(e,t){qq.isFileOrInput(t)?l(t):qq.isBlob(t)?o(t):qq.isObject(t)?t.blob&&t.name?s(t):t.canvas&&t.name&&a(t):t.tagName&&"canvas"===t.tagName.toLowerCase()?r(t):u.log(t+" is not a valid file container!  Ignoring!","warn")}),this.log("Received "+c.length+" files."),this._prepareItemsForUpload(c,t,n))},cancel:function(e){var t=this._uploadData.retrieve({id:e});t&&t.status===qq.status.UPLOAD_FINALIZING?this.log(qq.format("Ignoring cancel for file ID {} ({}).  Finalizing upload.",e,this.getName(e)),"error"):this._handler.cancel(e)},cancelAll:function(){var e=[],t=this;qq.extend(e,this._storedIds),qq.each(e,function(e,n){t.cancel(n)}),this._handler.cancelAll()},clearStoredFiles:function(){this._storedIds=[]},continueUpload:function(e){var t=this._uploadData.retrieve({id:e});return!(!qq.supportedFeatures.pause||!this._options.chunking.enabled)&&(t.status===qq.status.PAUSED?(this.log(qq.format("Paused file ID {} ({}) will be continued.  Not paused.",e,this.getName(e))),this._uploadFile(e),!0):(this.log(qq.format("Ignoring continue for file ID {} ({}).  Not paused.",e,this.getName(e)),"error"),!1))},deleteFile:function(e){return this._onSubmitDelete(e)},doesExist:function(e){return this._handler.isValid(e)},drawThumbnail:function(e,t,n,i,o){var s,r,a=new qq.Promise;return this._imageGenerator?(s=this._thumbnailUrls[e],r={customResizeFunction:o,maxSize:n>0?n:null,scale:n>0},!i&&qq.supportedFeatures.imagePreviews&&(s=this.getFile(e)),null==s?a.failure({container:t,error:"File or URL not found."}):this._imageGenerator.generate(s,t,r).then(function(e){a.success(e)},function(e,t){a.failure({container:e,error:t||"Problem generating thumbnail"})})):a.failure({container:t,error:"Missing image generator module"}),a},getButton:function(e){return this._getButton(this._buttonIdsForFileIds[e])},getEndpoint:function(e){return this._endpointStore.get(e)},getFile:function(e){var t,n=this._handler.getFile(e);return n||(t=this._uploadData.retrieve({id:e}))&&(n=t.file),n||null},getInProgress:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED]}).length},getName:function(e){return this._uploadData.retrieve({id:e}).name},getParentId:function(e){var t=this.getUploads({id:e}),n=null;return t&&void 0!==t.parentId&&(n=t.parentId),n},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(e){return this._uploadData.retrieve({id:e}).size},getNetUploads:function(){return this._netUploaded},getRemainingAllowedItems:function(){var e=this._currentItemLimit;return e>0?e-this._netUploadedOrQueued:null},getUploads:function(e){return this._uploadData.retrieve(e)},getUuid:function(e){return this._uploadData.retrieve({id:e}).uuid},isResumable:function(e){return this._handler.hasResumeRecord(e)},log:function(e,t){!this._options.debug||t&&"info"!==t?t&&"info"!==t&&qq.log("[Fine Uploader "+qq.version+"] "+e,t):qq.log("[Fine Uploader "+qq.version+"] "+e)},pauseUpload:function(e){var t=this._uploadData.retrieve({id:e});if(!qq.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(qq.indexOf([qq.status.UPLOADING,qq.status.UPLOAD_RETRYING],t.status)>=0){if(this._handler.pause(e))return this._uploadData.setStatus(e,qq.status.PAUSED),!0;this.log(qq.format("Unable to pause file ID {} ({}).",e,this.getName(e)),"error")}else this.log(qq.format("Ignoring pause for file ID {} ({}).  Not in progress.",e,this.getName(e)),"error");return!1},removeFileRef:function(e){this._handler.expunge(e),this._uploadData.removeFileRef(e)},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],qq.each(this._buttons,function(e,t){t.reset()}),this._paramsStore.reset(),this._endpointStore.reset(),this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData.reset(),this._buttonIdsForFileIds=[],this._pasteHandler&&this._pasteHandler.reset(),this._options.session.refreshOnReset&&this._refreshSessionData(),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[],this._totalProgress&&this._totalProgress.reset(),this._customResumeDataStore.reset()},retry:function(e){return this._manualRetry(e)},scaleImage:function(e,t){return qq.Scaler.prototype.scaleImage(e,t,{log:qq.bind(this.log,this),getFile:qq.bind(this.getFile,this),uploadData:this._uploadData})},setCustomHeaders:function(e,t){this._customHeadersStore.set(e,t)},setCustomResumeData:function(e,t){this._customResumeDataStore.set(t,e)},setDeleteFileCustomHeaders:function(e,t){this._deleteFileCustomHeadersStore.set(e,t)},setDeleteFileEndpoint:function(e,t){this._deleteFileEndpointStore.set(e,t)},setDeleteFileParams:function(e,t){this._deleteFileParamsStore.set(e,t)},setEndpoint:function(e,t){this._endpointStore.set(e,t)},setForm:function(e){this._updateFormSupportAndParams(e)},setItemLimit:function(e){this._currentItemLimit=e},setName:function(e,t){this._uploadData.updateName(e,t)},setParams:function(e,t){this._paramsStore.set(e,t)},setUuid:function(e,t){return this._uploadData.uuidChanged(e,t)},setStatus:function(e,t){if(!this.getUploads({id:e}))throw new qq.Error(e+" is not a valid file ID.");switch(t){case qq.status.DELETED:this._onDeleteComplete(e,null,!1);break;case qq.status.DELETE_FAILED:this._onDeleteComplete(e,null,!0);break;default:var n="Method setStatus called on '"+name+"' not implemented yet for "+t;throw this.log(n),new qq.Error(n)}},uploadStoredFiles:function(){0===this._storedIds.length?this._itemError("noFilesError"):this._uploadStoredFiles()}},qq.basePrivateApi={_addCannedFile:function(e){var t=this;return this._uploadData.addFile({uuid:e.uuid,name:e.name,size:e.size,status:qq.status.UPLOAD_SUCCESSFUL,onBeforeStatusChange:function(n){e.deleteFileEndpoint&&t.setDeleteFileEndpoint(e.deleteFileEndpoint,n),e.deleteFileParams&&t.setDeleteFileParams(e.deleteFileParams,n),e.thumbnailUrl&&(t._thumbnailUrls[n]=e.thumbnailUrl),t._netUploaded++,t._netUploadedOrQueued++}})},_annotateWithButtonId:function(e,t){qq.isFile(e)&&(e.qqButtonId=this._getButtonId(t))},_batchError:function(e){this._options.callbacks.onError(null,null,e,void 0)},_createDeleteHandler:function(){var e=this;return new qq.DeleteFileAjaxRequester({method:this._options.deleteFile.method.toUpperCase(),maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._deleteFileCustomHeadersStore,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,cors:this._options.cors,log:qq.bind(e.log,e),onDelete:function(t){e._onDelete(t),e._options.callbacks.onDelete(t)},onDeleteComplete:function(t,n,i){e._onDeleteComplete(t,n,i),e._options.callbacks.onDeleteComplete(t,n,i)}})},_createPasteHandler:function(){var e=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:qq.bind(e.log,e),pasteReceived:function(t){e._handleCheckedCallback({name:"onPasteReceived",callback:qq.bind(e._options.callbacks.onPasteReceived,e,t),onSuccess:qq.bind(e._handlePasteSuccess,e,t),identifier:"pasted image"})}}})},_createStore:function(e,t){var n={},i=e,o={},s=t,r=function(e){return qq.isObject(e)?qq.extend({},e):e},a=function(e,t){s&&qq.isObject(t)&&qq.extend(t,qq.isFunction(s)?s():s),o[e]&&qq.extend(t,o[e])};return{set:function(e,t){null==t?(n={},i=r(e)):n[t]=r(e)},get:function(e){var t;return t=null!=e&&n[e]?n[e]:r(i),a(e,t),r(t)},addReadOnly:function(e,t){qq.isObject(n)&&(null===e?qq.isFunction(t)?s=t:(s=s||{},qq.extend(s,t)):(o[e]=o[e]||{},qq.extend(o[e],t)))},remove:function(e){return delete n[e]},reset:function(){n={},o={},i=e}}},_createUploadDataTracker:function(){var e=this;return new qq.UploadData({getName:function(t){return e.getName(t)},getUuid:function(t){return e.getUuid(t)},getSize:function(t){return e.getSize(t)},onStatusChange:function(t,n,i){e._onUploadStatusChange(t,n,i),e._options.callbacks.onStatusChange(t,n,i),e._maybeAllComplete(t,i),e._totalProgress&&setTimeout(function(){e._totalProgress.onStatusChange(t,n,i)},0)}})},_createUploadButton:function(e){var t,n=this,i=e.accept||this._options.validation.acceptFiles,o=e.allowedExtensions||this._options.validation.allowedExtensions;return t=new qq.UploadButton({acceptFiles:i,element:e.element,focusClass:this._options.classes.buttonFocus,folders:e.folders,hoverClass:this._options.classes.buttonHover,ios8BrowserCrashWorkaround:this._options.workarounds.ios8BrowserCrash,multiple:!!qq.supportedFeatures.ajaxUploading&&!(n._options.workarounds.iosEmptyVideos&&qq.ios()&&!qq.ios6()&&n._isAllowedExtension(o,".mov"))&&(void 0===e.multiple?n._options.multiple:e.multiple),name:this._options.request.inputName,onChange:function(e){n._onInputChange(e)},title:null==e.title?this._options.text.fileInputTitle:e.title}),this._disposeSupport.addDisposer(function(){t.dispose()}),n._buttons.push(t),t},_createUploadHandler:function(e,t){var n=this,i={},o={debug:this._options.debug,maxConnections:this._options.maxConnections,cors:this._options.cors,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:qq.bind(n.log,n),preventRetryParam:this._options.retry.preventRetryResponseProperty,onProgress:function(e,t,o,s){o<0||s<0||(i[e]&&i[e].loaded===o&&i[e].total===s||(n._onProgress(e,t,o,s),n._options.callbacks.onProgress(e,t,o,s)),i[e]={loaded:o,total:s})},onComplete:function(e,t,o,s){delete i[e];var r,a=n.getUploads({id:e}).status;a!==qq.status.UPLOAD_SUCCESSFUL&&a!==qq.status.UPLOAD_FAILED&&((r=n._onComplete(e,t,o,s))instanceof qq.Promise?r.done(function(){n._options.callbacks.onComplete(e,t,o,s)}):n._options.callbacks.onComplete(e,t,o,s))},onCancel:function(e,t,i){var o=new qq.Promise;return n._handleCheckedCallback({name:"onCancel",callback:qq.bind(n._options.callbacks.onCancel,n,e,t),onFailure:o.failure,onSuccess:function(){i.then(function(){n._onCancel(e,t)}),o.success()},identifier:e}),o},onUploadPrep:qq.bind(this._onUploadPrep,this),onUpload:function(e,t){n._onUpload(e,t);var i=n._options.callbacks.onUpload(e,t);return qq.isGenericPromise(i)?(n.log(qq.format("onUpload for {} returned a Promise - waiting for resolution.",e)),i):(new qq.Promise).success()},onUploadChunk:function(e,t,i){n._onUploadChunk(e,i);var o=n._options.callbacks.onUploadChunk(e,t,i);return qq.isGenericPromise(o)?(n.log(qq.format("onUploadChunk for {}.{} returned a Promise - waiting for resolution.",e,i.partIndex)),o):(new qq.Promise).success()},onUploadChunkSuccess:function(e,t,i,o){n._onUploadChunkSuccess(e,t),n._options.callbacks.onUploadChunkSuccess.apply(n,arguments)},onResume:function(e,t,i,o){return n._options.callbacks.onResume(e,t,i,o)},onAutoRetry:function(e,t,i,o){return n._onAutoRetry.apply(n,arguments)},onUuidChanged:function(e,t){n.log("Server requested UUID change from '"+n.getUuid(e)+"' to '"+t+"'"),n.setUuid(e,t)},getName:qq.bind(n.getName,n),getUuid:qq.bind(n.getUuid,n),getSize:qq.bind(n.getSize,n),setSize:qq.bind(n._setSize,n),getDataByUuid:function(e){return n.getUploads({uuid:e})},isQueued:function(e){var t=n.getUploads({id:e}).status;return t===qq.status.QUEUED||t===qq.status.SUBMITTED||t===qq.status.UPLOAD_RETRYING||t===qq.status.PAUSED},getIdsInProxyGroup:n._uploadData.getIdsInProxyGroup,getIdsInBatch:n._uploadData.getIdsInBatch,isInProgress:function(e){return n.getUploads({id:e}).status===qq.status.UPLOADING},getCustomResumeData:qq.bind(n._getCustomResumeData,n),setStatus:function(e,t){n._uploadData.setStatus(e,t)}};return qq.each(this._options.request,function(e,t){o[e]=t}),o.customHeaders=this._customHeadersStore,e&&qq.each(e,function(e,t){o[e]=t}),new qq.UploadHandlerController(o,t)},_fileOrBlobRejected:function(e){this._netUploadedOrQueued--,this._uploadData.setStatus(e,qq.status.REJECTED)},_formatSize:function(e){if(0===e)return e+this._options.text.sizeSymbols[0];var t=-1;do{e/=1e3,t++}while(e>999);return Math.max(e,.1).toFixed(1)+this._options.text.sizeSymbols[t]},_generateExtraButtonSpecs:function(){var e=this;this._extraButtonSpecs={},qq.each(this._options.extraButtons,function(t,n){var i=n.multiple,o=qq.extend({},e._options.validation,!0),s=qq.extend({},n);void 0===i&&(i=e._options.multiple),s.validation&&qq.extend(o,n.validation,!0),qq.extend(s,{multiple:i,validation:o},!0),e._initExtraButton(s)})},_getButton:function(e){var t=this._extraButtonSpecs[e];return t?t.element:e===this._defaultButtonId?this._options.button:void 0},_getButtonId:function(e){var t,n,i=e;if(i instanceof qq.BlobProxy&&(i=i.referenceBlob),i&&!qq.isBlob(i)){if(qq.isFile(i))return i.qqButtonId;if("input"===i.tagName.toLowerCase()&&"file"===i.type.toLowerCase())return i.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);if(t=i.getElementsByTagName("input"),qq.each(t,function(e,t){if("file"===t.getAttribute("type"))return n=t,!1}),n)return n.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME)}},_getCustomResumeData:function(e){return this._customResumeDataStore.get(e)},_getNotFinished:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED,qq.status.SUBMITTING,qq.status.SUBMITTED,qq.status.PAUSED]}).length},_getValidationBase:function(e){var t=this._extraButtonSpecs[e];return t?t.validation:this._options.validation},_getValidationDescriptor:function(e){return e.file instanceof qq.BlobProxy?{name:qq.getFilename(e.file.referenceBlob),size:e.file.referenceBlob.size}:{name:this.getUploads({id:e.id}).name,size:this.getUploads({id:e.id}).size}},_getValidationDescriptors:function(e){var t=this,n=[];return qq.each(e,function(e,i){n.push(t._getValidationDescriptor(i))}),n},_handleCameraAccess:function(){if(this._options.camera.ios&&qq.ios()){var e=this._options.camera.button,t=e?this._getButtonId(e):this._defaultButtonId,n=this._options;t&&t!==this._defaultButtonId&&(n=this._extraButtonSpecs[t]),n.multiple=!1,null===n.validation.acceptFiles?n.validation.acceptFiles="image/*;capture=camera":n.validation.acceptFiles+=",image/*;capture=camera",qq.each(this._buttons,function(e,i){if(i.getButtonId()===t)return i.setMultiple(n.multiple),i.setAcceptFiles(n.acceptFiles),!1})}},_handleCheckedCallback:function(e){var t=this,n=e.callback();return qq.isGenericPromise(n)?(this.log(e.name+" - waiting for "+e.name+" promise to be fulfilled for "+e.identifier),n.then(function(n){t.log(e.name+" promise success for "+e.identifier),e.onSuccess(n)},function(){e.onFailure?(t.log(e.name+" promise failure for "+e.identifier),e.onFailure()):t.log(e.name+" promise failure for "+e.identifier)})):(!1!==n?e.onSuccess(n):e.onFailure?(this.log(e.name+" - return value was 'false' for "+e.identifier+".  Invoking failure callback."),e.onFailure()):this.log(e.name+" - return value was 'false' for "+e.identifier+".  Will not proceed."),n)},_handleNewFile:function(e,t,n){var i=this,o=qq.getUniqueId(),s=-1,r=qq.getFilename(e),a=e.blob||e,l=this._customNewFileHandler?this._customNewFileHandler:qq.bind(i._handleNewFileGeneric,i);!qq.isInput(a)&&a.size>=0&&(s=a.size),l(a,r,o,s,n,t,this._options.request.uuidName,{uploadData:i._uploadData,paramsStore:i._paramsStore,addFileToHandler:function(e,t){i._handler.add(e,t),i._netUploadedOrQueued++,i._trackButton(e)}})},_handleNewFileGeneric:function(e,t,n,i,o,s){var r=this._uploadData.addFile({uuid:n,name:t,size:i,batchId:s,file:e});this._handler.add(r,e),this._trackButton(r),this._netUploadedOrQueued++,o.push({id:r,file:e})},_handlePasteSuccess:function(e,t){var n=e.type.split("/")[1],i=t;null==i&&(i=this._options.paste.defaultName),i+="."+n,this.addFiles({name:i,blob:e})},_handleDeleteSuccess:function(e){if(this.getUploads({id:e}).status!==qq.status.DELETED){var t=this.getName(e);this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(e),this._uploadData.setStatus(e,qq.status.DELETED),this.log("Delete request for '"+t+"' has succeeded.")}},_handleDeleteFailed:function(e,t){var n=this.getName(e);this._uploadData.setStatus(e,qq.status.DELETE_FAILED),this.log("Delete request for '"+n+"' has failed.","error"),t&&void 0!==t.withCredentials?this._options.callbacks.onError(e,n,"Delete request failed with response code "+t.status,t):this._options.callbacks.onError(e,n,"Delete request failed",t)},_initExtraButton:function(e){var t=this._createUploadButton({accept:e.validation.acceptFiles,allowedExtensions:e.validation.allowedExtensions,element:e.element,folders:e.folders,multiple:e.multiple,title:e.fileInputTitle});this._extraButtonSpecs[t.getButtonId()]=e},_initFormSupportAndParams:function(){this._formSupport=qq.FormSupport&&new qq.FormSupport(this._options.form,qq.bind(this.uploadStoredFiles,this),qq.bind(this.log,this)),this._formSupport&&this._formSupport.attachedToForm?(this._paramsStore=this._createStore(this._options.request.params,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&(this._options.request.endpoint=this._formSupport.newEndpoint)):this._paramsStore=this._createStore(this._options.request.params)},_isDeletePossible:function(){return!(!qq.DeleteFileAjaxRequester||!this._options.deleteFile.enabled)&&(!this._options.cors.expected||(!!qq.supportedFeatures.deleteFileCorsXhr||!(!qq.supportedFeatures.deleteFileCorsXdr||!this._options.cors.allowXdr)))},_isAllowedExtension:function(e,t){var n=!1;return!e.length||(qq.each(e,function(e,i){if(qq.isString(i)){var o=new RegExp("\\."+i+"$","i");if(null!=t.match(o))return n=!0,!1}}),n)},_itemError:function(e,t,n){var i,o,s=this._options.messages[e],r=[],a=[].concat(t),l=a[0],u=this._getButtonId(n),c=this._getValidationBase(u);function d(e,t){s=s.replace(e,t)}return qq.each(c.allowedExtensions,function(e,t){qq.isString(t)&&r.push(t)}),i=r.join(", ").toLowerCase(),d("{file}",this._options.formatFileName(l)),d("{extensions}",i),d("{sizeLimit}",this._formatSize(c.sizeLimit)),d("{minSizeLimit}",this._formatSize(c.minSizeLimit)),null!==(o=s.match(/(\{\w+\})/g))&&qq.each(o,function(e,t){d(t,a[e])}),this._options.callbacks.onError(null,l,s,void 0),s},_manualRetry:function(e,t){if(this._onBeforeManualRetry(e))return this._netUploadedOrQueued++,this._uploadData.setStatus(e,qq.status.UPLOAD_RETRYING),t?t(e):this._handler.retry(e),!0},_maybeAllComplete:function(e,t){var n=this,i=this._getNotFinished();t===qq.status.UPLOAD_SUCCESSFUL?this._succeededSinceLastAllComplete.push(e):t===qq.status.UPLOAD_FAILED&&this._failedSinceLastAllComplete.push(e),0===i&&(this._succeededSinceLastAllComplete.length||this._failedSinceLastAllComplete.length)&&setTimeout(function(){n._onAllComplete(n._succeededSinceLastAllComplete,n._failedSinceLastAllComplete)},0)},_maybeHandleIos8SafariWorkaround:function(){var e=this;if(this._options.workarounds.ios8SafariUploads&&qq.ios800()&&qq.iosSafari())throw setTimeout(function(){window.alert(e._options.messages.unsupportedBrowserIos8Safari)},0),new qq.Error(this._options.messages.unsupportedBrowserIos8Safari)},_maybeParseAndSendUploadError:function(e,t,n,i){if(!n.success)if(i&&200!==i.status&&!n.error)this._options.callbacks.onError(e,t,"XHR returned response code "+i.status,i);else{var o=n.error?n.error:this._options.text.defaultResponseError;this._options.callbacks.onError(e,t,o,i)}},_maybeProcessNextItemAfterOnValidateCallback:function(e,t,n,i,o){var s=this;if(t.length>n)if(e||!this._options.validation.stopOnFirstInvalidFile)setTimeout(function(){var e=s._getValidationDescriptor(t[n]),r=s._getButtonId(t[n].file),a=s._getButton(r);s._handleCheckedCallback({name:"onValidate",callback:qq.bind(s._options.callbacks.onValidate,s,e,a),onSuccess:qq.bind(s._onValidateCallbackSuccess,s,t,n,i,o),onFailure:qq.bind(s._onValidateCallbackFailure,s,t,n,i,o),identifier:"Item '"+e.name+"', size: "+e.size})},0);else if(!e)for(;n<t.length;n++)s._fileOrBlobRejected(t[n].id)},_onAllComplete:function(e,t){this._totalProgress&&this._totalProgress.onAllComplete(e,t,this._preventRetries),this._options.callbacks.onAllComplete(qq.extend([],e),qq.extend([],t)),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[]},_onAutoRetry:function(e,t,n,i,o){var s=this;if(s._preventRetries[e]=n[s._options.retry.preventRetryResponseProperty],s._shouldAutoRetry(e)){var r=1e3*s._options.retry.autoAttemptDelay;return s._maybeParseAndSendUploadError.apply(s,arguments),s._options.callbacks.onAutoRetry(e,t,s._autoRetries[e]),s._onBeforeAutoRetry(e,t),s._uploadData.setStatus(e,qq.status.UPLOAD_RETRYING),s._retryTimeouts[e]=setTimeout(function(){s.log("Starting retry for "+t+"..."),o?o(e):s._handler.retry(e)},r),!0}},_onBeforeAutoRetry:function(e,t){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+t+"...")},_onBeforeManualRetry:function(e){var t,n=this._currentItemLimit;return this._preventRetries[e]?(this.log("Retries are forbidden for id "+e,"warn"),!1):this._handler.isValid(e)?(t=this.getName(e),!1!==this._options.callbacks.onManualRetry(e,t)&&(n>0&&this._netUploadedOrQueued+1>n?(this._itemError("retryFailTooManyItems"),!1):(this.log("Retrying upload for '"+t+"' (id: "+e+")..."),!0))):(this.log("'"+e+"' is not a valid file ID","error"),!1)},_onCancel:function(e,t){this._netUploadedOrQueued--,clearTimeout(this._retryTimeouts[e]);var n=qq.indexOf(this._storedIds,e);!this._options.autoUpload&&n>=0&&this._storedIds.splice(n,1),this._uploadData.setStatus(e,qq.status.CANCELED)},_onComplete:function(e,t,n,i){return n.success?(n.thumbnailUrl&&(this._thumbnailUrls[e]=n.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(e,qq.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(e,qq.status.UPLOAD_FAILED),!0===n[this._options.retry.preventRetryResponseProperty]&&(this._preventRetries[e]=!0)),this._maybeParseAndSendUploadError(e,t,n,i),!!n.success},_onDelete:function(e){this._uploadData.setStatus(e,qq.status.DELETING)},_onDeleteComplete:function(e,t,n){this.getName(e);n?this._handleDeleteFailed(e,t):this._handleDeleteSuccess(e)},_onInputChange:function(e){var t;if(qq.supportedFeatures.ajaxUploading){for(t=0;t<e.files.length;t++)this._annotateWithButtonId(e.files[t],e);this.addFiles(e.files)}else e.value.length>0&&this.addFiles(e);qq.each(this._buttons,function(e,t){t.reset()})},_onProgress:function(e,t,n,i){this._totalProgress&&this._totalProgress.onIndividualProgress(e,n,i)},_onSubmit:function(e,t){},_onSubmitCallbackSuccess:function(e,t){this._onSubmit.apply(this,arguments),this._uploadData.setStatus(e,qq.status.SUBMITTED),this._onSubmitted.apply(this,arguments),this._options.autoUpload?(this._options.callbacks.onSubmitted.apply(this,arguments),this._uploadFile(e)):(this._storeForLater(e),this._options.callbacks.onSubmitted.apply(this,arguments))},_onSubmitDelete:function(e,t,n){var i,o=this.getUuid(e);return t&&(i=qq.bind(t,this,e,o,n)),this._isDeletePossible()?(this._handleCheckedCallback({name:"onSubmitDelete",callback:qq.bind(this._options.callbacks.onSubmitDelete,this,e),onSuccess:i||qq.bind(this._deleteHandler.sendDelete,this,e,o,n),identifier:e}),!0):(this.log("Delete request ignored for ID "+e+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onSubmitted:function(e){},_onTotalProgress:function(e,t){this._options.callbacks.onTotalProgress(e,t)},_onUploadPrep:function(e){},_onUpload:function(e,t){this._uploadData.setStatus(e,qq.status.UPLOADING)},_onUploadChunk:function(e,t){},_onUploadChunkSuccess:function(e,t){!this._preventRetries[e]&&this._options.retry.enableAuto&&(this._autoRetries[e]=0)},_onUploadStatusChange:function(e,t,n){n===qq.status.PAUSED&&clearTimeout(this._retryTimeouts[e])},_onValidateBatchCallbackFailure:function(e){var t=this;qq.each(e,function(e,n){t._fileOrBlobRejected(n.id)})},_onValidateBatchCallbackSuccess:function(e,t,n,i,o){var s,r=this._currentItemLimit,a=this._netUploadedOrQueued;0===r||a<=r?t.length>0?this._handleCheckedCallback({name:"onValidate",callback:qq.bind(this._options.callbacks.onValidate,this,e[0],o),onSuccess:qq.bind(this._onValidateCallbackSuccess,this,t,0,n,i),onFailure:qq.bind(this._onValidateCallbackFailure,this,t,0,n,i),identifier:"Item '"+t[0].file.name+"', size: "+t[0].file.size}):this._itemError("noFilesError"):(this._onValidateBatchCallbackFailure(t),s=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,a).replace(/\{itemLimit\}/g,r),this._batchError(s))},_onValidateCallbackFailure:function(e,t,n,i){var o=t+1;this._fileOrBlobRejected(e[t].id,e[t].file.name),this._maybeProcessNextItemAfterOnValidateCallback(!1,e,o,n,i)},_onValidateCallbackSuccess:function(e,t,n,i){var o=this,s=t+1,r=this._getValidationDescriptor(e[t]);this._validateFileOrBlobData(e[t],r).then(function(){o._upload(e[t].id,n,i),o._maybeProcessNextItemAfterOnValidateCallback(!0,e,s,n,i)},function(){o._maybeProcessNextItemAfterOnValidateCallback(!1,e,s,n,i)})},_prepareItemsForUpload:function(e,t,n){if(0!==e.length){var i=this._getValidationDescriptors(e),o=this._getButtonId(e[0].file),s=this._getButton(o);this._handleCheckedCallback({name:"onValidateBatch",callback:qq.bind(this._options.callbacks.onValidateBatch,this,i,s),onSuccess:qq.bind(this._onValidateBatchCallbackSuccess,this,i,e,t,n,s),onFailure:qq.bind(this._onValidateBatchCallbackFailure,this,e),identifier:"batch validation"})}else this._itemError("noFilesError")},_preventLeaveInProgress:function(){var e=this;this._disposeSupport.attach(window,"beforeunload",function(t){if(e.getInProgress())return(t=t||window.event).returnValue=e._options.messages.onLeave,e._options.messages.onLeave})},_refreshSessionData:function(){var e=this,t=this._options.session;qq.Session&&null!=this._options.session.endpoint&&(this._session||(qq.extend(t,{cors:this._options.cors}),t.log=qq.bind(this.log,this),t.addFileRecord=qq.bind(this._addCannedFile,this),this._session=new qq.Session(t)),setTimeout(function(){e._session.refresh().then(function(t,n){e._sessionRequestComplete(),e._options.callbacks.onSessionRequestComplete(t,!0,n)},function(t,n){e._options.callbacks.onSessionRequestComplete(t,!1,n)})},0))},_sessionRequestComplete:function(){},_setSize:function(e,t){this._uploadData.updateSize(e,t),this._totalProgress&&this._totalProgress.onNewSize(e)},_shouldAutoRetry:function(e){var t=this._uploadData.retrieve({id:e});return!!(!this._preventRetries[e]&&this._options.retry.enableAuto&&t.status!==qq.status.PAUSED&&(void 0===this._autoRetries[e]&&(this._autoRetries[e]=0),this._autoRetries[e]<this._options.retry.maxAutoAttempts))&&(this._autoRetries[e]+=1,!0)},_storeForLater:function(e){this._storedIds.push(e)},_trackButton:function(e){var t;(t=qq.supportedFeatures.ajaxUploading?this._handler.getFile(e).qqButtonId:this._getButtonId(this._handler.getInput(e)))&&(this._buttonIdsForFileIds[e]=t)},_updateFormSupportAndParams:function(e){this._options.form.element=e,this._formSupport=qq.FormSupport&&new qq.FormSupport(this._options.form,qq.bind(this.uploadStoredFiles,this),qq.bind(this.log,this)),this._formSupport&&this._formSupport.attachedToForm&&(this._paramsStore.addReadOnly(null,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&this.setEndpoint(this._formSupport.newEndpoint))},_upload:function(e,t,n){var i=this.getName(e);t&&this.setParams(t,e),n&&this.setEndpoint(n,e),this._handleCheckedCallback({name:"onSubmit",callback:qq.bind(this._options.callbacks.onSubmit,this,e,i),onSuccess:qq.bind(this._onSubmitCallbackSuccess,this,e,i),onFailure:qq.bind(this._fileOrBlobRejected,this,e,i),identifier:e})},_uploadFile:function(e){this._handler.upload(e)||this._uploadData.setStatus(e,qq.status.QUEUED)},_uploadStoredFiles:function(){for(var e,t,n=this;this._storedIds.length;)e=this._storedIds.shift(),this._uploadFile(e);(t=this.getUploads({status:qq.status.SUBMITTING}).length)&&(qq.log("Still waiting for "+t+" files to clear submit queue. Will re-parse stored IDs array shortly."),setTimeout(function(){n._uploadStoredFiles()},1e3))},_validateFileOrBlobData:function(e,t){var n=this,i=e.file instanceof qq.BlobProxy?e.file.referenceBlob:e.file,o=t.name,s=t.size,r=this._getButtonId(e.file),a=this._getValidationBase(r),l=new qq.Promise;return l.then(function(){},function(){n._fileOrBlobRejected(e.id,o)}),qq.isFileOrInput(i)&&!this._isAllowedExtension(a.allowedExtensions,o)?(this._itemError("typeError",o,i),l.failure()):this._options.validation.allowEmpty||0!==s?s>0&&a.sizeLimit&&s>a.sizeLimit?(this._itemError("sizeError",o,i),l.failure()):s>0&&s<a.minSizeLimit?(this._itemError("minSizeError",o,i),l.failure()):(qq.ImageValidation&&qq.supportedFeatures.imagePreviews&&qq.isFile(i)?new qq.ImageValidation(i,qq.bind(n.log,n)).validate(a.image).then(l.success,function(e){n._itemError(e+"ImageError",o,i),l.failure()}):l.success(),l):(this._itemError("emptyError",o,i),l.failure())},_wrapCallbacks:function(){var e,t,n;for(n in e=this,t=function(t,n,i){var o;try{return n.apply(e,i)}catch(n){o=n.message||n.toString(),e.log("Caught exception in '"+t+"' callback - "+o,"error")}},this._options.callbacks)!function(){var i,o;i=n,o=e._options.callbacks[i],e._options.callbacks[i]=function(){return t(i,o,arguments)}}()}}}(),function(){"use strict";qq.FineUploaderBasic=function(e){var t=this;this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,warnBeforeUnload:!0,request:{customHeaders:{},endpoint:"/server/upload",filenameParam:"qqfilename",forceMultipart:!0,inputName:"qqfile",method:"POST",omitDefaultParams:!1,params:{},paramsInBody:!0,requireSuccessJson:!0,totalFileSizeName:"qqtotalfilesize",uuidName:"qquuid"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null,image:{maxHeight:0,maxWidth:0,minHeight:0,minWidth:0},allowEmpty:!1},callbacks:{onSubmit:function(e,t){},onSubmitted:function(e,t){},onComplete:function(e,t,n,i){},onAllComplete:function(e,t){},onCancel:function(e,t){},onUpload:function(e,t){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,t,n,i){},onResume:function(e,t,n,i){},onProgress:function(e,t,n,i){},onTotalProgress:function(e,t){},onError:function(e,t,n,i){},onAutoRetry:function(e,t,n){},onManualRetry:function(e,t){},onValidateBatch:function(e){},onValidate:function(e){},onSubmitDelete:function(e){},onDelete:function(e){},onDeleteComplete:function(e,t,n){},onPasteReceived:function(e){},onStatusChange:function(e,t,n){},onSessionRequestComplete:function(e,t,n){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",maxHeightImageError:"Image is too tall.",maxWidthImageError:"Image is too wide.",minHeightImageError:"Image is not tall enough.",minWidthImageError:"Image is not wide enough.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be canceled.",unsupportedBrowserIos8Safari:"Unrecoverable error - this browser does not permit file uploading of any kind due to serious bugs in iOS8 Safari.  Please use iOS8 Chrome until Apple fixes these issues."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,concurrent:{enabled:!1},mandatory:!1,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"},partSize:function(e){return 2e6},success:{endpoint:null,headers:function(e){return null},jsonPayload:!1,method:"POST",params:function(e){return null},resetOnStatus:[]}},resume:{enabled:!1,recordsExpireIn:7,paramNames:{resuming:"qqresume"},customKeys:function(e){return[]}},formatFileName:function(e){return e},text:{defaultResponseError:"Upload failure reason unknown",fileInputTitle:"file input",sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[],session:{endpoint:null,params:{},customHeaders:{},refreshOnReset:!0},form:{element:"qq-form",autoUpload:!1,interceptSubmit:!0},scaling:{customResizer:null,sendOriginal:!0,orient:!0,defaultType:null,defaultQuality:80,failureText:"Failed to scale",includeExif:!1,sizes:[]},workarounds:{iosEmptyVideos:!0,ios8SafariUploads:!0,ios8BrowserCrash:!1}},qq.extend(this._options,e,!0),this._buttons=[],this._extraButtonSpecs={},this._buttonIdsForFileIds=[],this._wrapCallbacks(),this._disposeSupport=new qq.DisposeSupport,this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData=this._createUploadDataTracker(),this._initFormSupportAndParams(),this._customHeadersStore=this._createStore(this._options.request.customHeaders),this._deleteFileCustomHeadersStore=this._createStore(this._options.deleteFile.customHeaders),this._deleteFileParamsStore=this._createStore(this._options.deleteFile.params),this._endpointStore=this._createStore(this._options.request.endpoint),this._deleteFileEndpointStore=this._createStore(this._options.deleteFile.endpoint),this._handler=this._createUploadHandler(),this._deleteHandler=qq.DeleteFileAjaxRequester&&this._createDeleteHandler(),this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button,title:this._options.text.fileInputTitle}).getButtonId()),this._generateExtraButtonSpecs(),this._handleCameraAccess(),this._options.paste.targetElement&&(qq.PasteSupport?this._pasteHandler=this._createPasteHandler():this.log("Paste support module not found","error")),this._options.warnBeforeUnload&&this._preventLeaveInProgress(),this._imageGenerator=qq.ImageGenerator&&new qq.ImageGenerator(qq.bind(this.log,this)),this._refreshSessionData(),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[],this._scaler=qq.Scaler&&new qq.Scaler(this._options.scaling,qq.bind(this.log,this))||{},this._scaler.enabled&&(this._customNewFileHandler=qq.bind(this._scaler.handleNewFile,this._scaler)),qq.TotalProgress&&qq.supportedFeatures.progressBar&&(this._totalProgress=new qq.TotalProgress(qq.bind(this._onTotalProgress,this),function(e){var n=t._uploadData.retrieve({id:e});return n&&n.size||0})),this._currentItemLimit=this._options.validation.itemLimit,this._customResumeDataStore=this._createStore()},qq.FineUploaderBasic.prototype=qq.basePublicApi,qq.extend(qq.FineUploaderBasic.prototype,qq.basePrivateApi)}(),qq.AjaxRequester=function(e){"use strict";var t,n,i=[],o={},s={acceptHeader:null,validMethods:["PATCH","POST","PUT"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},mandatedParams:{},allowXRequestedWithAndCacheControl:!0,successfulResponseCodes:{DELETE:[200,202,204],PATCH:[200,201,202,203,204],POST:[200,201,202,203,204],PUT:[200,201,202,203,204],GET:[200]},cors:{expected:!1,sendCredentials:!1},log:function(e,t){},onSend:function(e){},onComplete:function(e,t,n){},onProgress:null};if(qq.extend(s,e),t=s.log,qq.indexOf(s.validMethods,s.method)<0)throw new Error("'"+s.method+"' is not a supported method for this type of request!");function r(e){return s.cors.expected&&void 0===e.withCredentials}function a(e,t){var n=o[e]&&o[e].xhr;return n||(n=t||(s.cors.expected?function(){var e;return(window.XMLHttpRequest||window.ActiveXObject)&&void 0===(e=qq.createXhrInstance()).withCredentials&&((e=new XDomainRequest).onload=function(){},e.onerror=function(){},e.ontimeout=function(){},e.onprogress=function(){}),e}():qq.createXhrInstance()),o[e].xhr=n),n}function l(e){var t=qq.indexOf(i,e),n=s.maxConnections;delete o[e],i.splice(t,1),i.length>=n&&t<n&&c(i[n-1])}function u(e,n){var i,o=a(e),u=s.method,c=!0===n;l(e),c?t(u+" request for "+e+" has failed","error"):r(o)||(i=o.status,qq.indexOf(s.successfulResponseCodes[s.method],i)>=0)||(c=!0,t(u+" request for "+e+" has failed - response code "+o.status,"error")),s.onComplete(e,o,c)}function c(e,i){var l,c=a(e,i),d=s.method,p=function(e){var t,n=o[e].additionalParams,i=s.mandatedParams;return s.paramsStore.get&&(t=s.paramsStore.get(e)),n&&qq.each(n,function(e,n){(t=t||{})[e]=n}),i&&qq.each(i,function(e,n){(t=t||{})[e]=n}),t}(e),h=o[e].payload;return s.onSend(e),l=function(e,t,i){var r=s.endpointStore.get(e),a=o[e].addToPath;null!=a&&(r+="/"+a);n&&t&&(r=qq.obj2url(t,r));i&&(r=qq.obj2url(i,r));return r}(e,p,o[e].additionalQueryParams),r(c)?(c.onload=function(e){return function(){u(e)}}(e),c.onerror=function(e){return function(){u(e,!0)}}(e)):c.onreadystatechange=function(e){return function(){4===a(e).readyState&&u(e)}}(e),function(e){var t=s.onProgress;t&&(a(e).upload.onprogress=function(n){n.lengthComputable&&t(e,n.loaded,n.total)})}(e),c.open(d,l,!0),s.cors.expected&&s.cors.sendCredentials&&!r(c)&&(c.withCredentials=!0),function(e){var t=a(e),n=s.customHeaders,i=o[e].additionalHeaders||{},l=s.method,u={};r(t)||(s.acceptHeader&&t.setRequestHeader("Accept",s.acceptHeader),s.allowXRequestedWithAndCacheControl&&(s.cors.expected&&qq.indexOf(["GET","POST","HEAD"],s.method)>=0&&(c=!1,qq.each(c,function(e,t){if(qq.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],t)<0)return c=!0,!1}),!c)||(t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.setRequestHeader("Cache-Control","no-cache"))),!s.contentType||"POST"!==l&&"PUT"!==l||t.setRequestHeader("Content-Type",s.contentType),qq.extend(u,qq.isFunction(n)?n(e):n),qq.extend(u,i),qq.each(u,function(e,n){t.setRequestHeader(e,n)}));var c}(e),t("Sending "+d+" request for "+e),h?c.send(h):n||!p?c.send():p&&s.contentType&&s.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")>=0?c.send(qq.obj2url(p,"")):p&&s.contentType&&s.contentType.toLowerCase().indexOf("application/json")>=0?c.send(JSON.stringify(p)):c.send(p),c}n="GET"===s.method||"DELETE"===s.method,qq.extend(this,{initTransport:function(e){var t,n,r,a,l,u;return{withPath:function(e){return t=e,this},withParams:function(e){return n=e,this},withQueryParams:function(e){return u=e,this},withHeaders:function(e){return r=e,this},withPayload:function(e){return a=e,this},withCacheBuster:function(){return l=!0,this},send:function(d){return l&&qq.indexOf(["GET","DELETE"],s.method)>=0&&(n.qqtimestamp=(new Date).getTime()),function(e,t,n,r,a,l,u){if(o[e]={addToPath:n,additionalParams:r,additionalQueryParams:a,additionalHeaders:l,payload:u},i.push(e)<=s.maxConnections)return c(e,t)}(e,d,t,n,u,r,a)}}},canceled:function(e){l(e)}})},qq.UploadHandler=function(e){"use strict";var t=e.proxy,n={},i=t.onCancel,o=t.getName;qq.extend(this,{add:function(e,t){n[e]=t,n[e].temp={}},cancel:function(e){var t=this,s=new qq.Promise;i(e,o(e),s).then(function(){t.isValid(e)&&(n[e].canceled=!0,t.expunge(e)),s.success()})},expunge:function(e){delete n[e]},getThirdPartyFileId:function(e){return n[e].key},isValid:function(e){return void 0!==n[e]},reset:function(){n={}},_getFileState:function(e){return n[e]},_setThirdPartyFileId:function(e,t){n[e].key=t},_wasCanceled:function(e){return!!n[e].canceled}})},qq.UploadHandlerController=function(e,t){"use strict";var n,i,o,s,r=this,a=!1,l=!1,u={paramsStore:{},maxConnections:3,chunking:{enabled:!1,multiple:{enabled:!1}},log:function(e,t){},onProgress:function(e,t,n,i){},onComplete:function(e,t,n,i){},onCancel:function(e,t){},onUploadPrep:function(e){},onUpload:function(e,t){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,t,n,i){},onAutoRetry:function(e,t,n,i){},onResume:function(e,t,n,i){},onUuidChanged:function(e,t){},getName:function(e){},setSize:function(e,t){},isQueued:function(e){},getIdsInProxyGroup:function(e){},getIdsInBatch:function(e){},isInProgress:function(e){}},c={done:function(e,t,n,i){var s=o._getChunkData(e,t);o._getFileState(e).attemptingResume=!1,delete o._getFileState(e).temp.chunkProgress[t],o._getFileState(e).loaded+=s.size,u.onUploadChunkSuccess(e,o._getChunkDataForCallback(s),n,i)},finalize:function(e){var t=u.getSize(e),n=u.getName(e);i("All chunks have been uploaded for "+e+" - finalizing...."),o.finalizeChunks(e).then(function(s,r){i("Finalize successful for "+e);var a=h.normalizeResponse(s,!0);u.onProgress(e,n,t,t),o._maybeDeletePersistedChunkData(e),h.cleanup(e,a,r)},function(t,o){var s=h.normalizeResponse(t,!1);i("Problem finalizing chunks for file ID "+e+" - "+s.error,"error"),(s.reset||o&&u.chunking.success.resetOnStatus.indexOf(o.status)>=0)&&c.reset(e),u.onAutoRetry(e,n,s,o)||h.cleanup(e,s,o)})},handleFailure:function(e,t,n,s){var r=u.getName(t);i("Chunked upload request failed for "+t+", chunk "+e),o.clearCachedChunk(t,e);var a,p=h.normalizeResponse(n,!1);if(p.reset)c.reset(t);else{var f=o._getFileState(t).chunking.inProgress;(a=f?qq.indexOf(f,e):-1)>=0&&(o._getFileState(t).chunking.inProgress.splice(a,1),o._getFileState(t).chunking.remaining.unshift(e))}o._getFileState(t).temp.ignoreFailure||(l&&(o._getFileState(t).temp.ignoreFailure=!0,i(qq.format("Going to attempt to abort these chunks: {}. These are currently in-progress: {}.",JSON.stringify(Object.keys(o._getXhrs(t))),JSON.stringify(o._getFileState(t).chunking.inProgress))),qq.each(o._getXhrs(t),function(e,n){i(qq.format("Attempting to abort file {}.{}. XHR readyState {}. ",t,e,n.readyState)),n.abort(),n._cancelled=!0}),o.moveInProgressToRemaining(t),d.free(t,!0)),u.onAutoRetry(t,r,p,s)||h.cleanup(t,p,s))},hasMoreParts:function(e){return!!o._getFileState(e).chunking.remaining.length},nextPart:function(e){var t=o._getFileState(e).chunking.remaining.shift();return t>=o._getTotalChunks(e)&&(t=null),t},reset:function(e){i("Server or callback has ordered chunking effort to be restarted on next attempt for item ID "+e,"error"),o._maybeDeletePersistedChunkData(e),o.reevaluateChunking(e),o._getFileState(e).loaded=0,o._getFileState(e).attemptingResume=!1},sendNext:function(e){var t=u.getSize(e),n=u.getName(e),s=c.nextPart(e),r=o._getChunkData(e,s),a=o._getFileState(e),p=a.attemptingResume,f=a.chunking.inProgress||[];(null==a.loaded&&(a.loaded=0),p&&!1===u.onResume(e,n,r,a.customResumeData)&&(c.reset(e),s=c.nextPart(e),r=o._getChunkData(e,s),p=!1),null==s&&0===f.length)?c.finalize(e):(f.push(s),o._getFileState(e).chunking.inProgress=f,l&&d.open(e,s),l&&d.available()&&o._getFileState(e).chunking.remaining.length&&c.sendNext(e),0===r.blob.size&&(i(qq.format("Chunk {} for file {} will not be uploaded, zero sized chunk.",s,e),"error"),c.handleFailure(s,e,"File is no longer available",null)),u.onUploadChunk(e,n,o._getChunkDataForCallback(r)).then(function(n){if(u.isInProgress(e)){i(qq.format("Sending chunked upload request for item {}.{}, bytes {}-{} of {}.",e,s,r.start+1,r.end,t));var a={chunkIdx:s,id:e,overrides:n,resuming:p};o.uploadChunk(a).then(function(t,n){i("Chunked upload request succeeded for "+e+", chunk "+s),o.clearCachedChunk(e,s);var r=o._getFileState(e).chunking.inProgress||[],a=h.normalizeResponse(t,!0),l=qq.indexOf(r,s);i(qq.format("Chunk {} for file {} uploaded successfully.",s,e)),c.done(e,s,a,n),l>=0&&r.splice(l,1),o._maybePersistChunkedState(e),c.hasMoreParts(e)||0!==r.length?c.hasMoreParts(e)?c.sendNext(e):i(qq.format("File ID {} has no more chunks to send and these chunk indexes are still marked as in-progress: {}",e,JSON.stringify(r))):c.finalize(e)},function(t,n){c.handleFailure(s,e,t,n)}).done(function(){o.clearXhr(e,s)})}else i(qq.format("Not sending chunked upload request for item {}.{} - no longer in progress.",e,s))},function(t){c.handleFailure(s,e,t,null)}))}},d={_open:[],_openChunks:{},_waiting:[],available:function(){var e=u.maxConnections,t=0,n=0;return qq.each(d._openChunks,function(e,i){t++,n+=i.length}),e-(d._open.length-t+n)},free:function(e,t){var n,s=!t,r=qq.indexOf(d._waiting,e),a=qq.indexOf(d._open,e);delete d._openChunks[e],h.getProxyOrBlob(e)instanceof qq.BlobProxy&&(i("Generated blob upload has ended for "+e+", disposing generated blob."),delete o._getFileState(e).file),r>=0?d._waiting.splice(r,1):s&&a>=0&&(d._open.splice(a,1),(n=d._waiting.shift())>=0&&(d._open.push(n),h.start(n)))},getWaitingOrConnected:function(){var e=[];return qq.each(d._openChunks,function(t,n){n&&n.length&&e.push(parseInt(t))}),qq.each(d._open,function(t,n){d._openChunks[n]||e.push(parseInt(n))}),e=e.concat(d._waiting)},isUsingConnection:function(e){return qq.indexOf(d._open,e)>=0},open:function(e,t){return null==t&&d._waiting.push(e),!!d.available()&&(null==t?(d._waiting.pop(),d._open.push(e)):((n=d._openChunks[e]||[]).push(t),d._openChunks[e]=n),!0);var n},reset:function(){d._waiting=[],d._open=[]}},p=function(e,t){var n=o._getFileState(e);n?(n.loaded=0,i("Sending simple upload request for "+e),o.uploadFile(e).then(function(n,o){i("Simple upload request succeeded for "+e);var s=h.normalizeResponse(n,!0),r=u.getSize(e);u.onProgress(e,t,r,r),h.maybeNewUuid(e,s),h.cleanup(e,s,o)},function(n,o){i("Simple upload request failed for "+e);var s=h.normalizeResponse(n,!1);u.onAutoRetry(e,t,s,o)||h.cleanup(e,s,o)})):i("Ignoring send request as this upload may have been cancelled, File ID "+e,"warn")},h={cancel:function(e){i("Cancelling "+e),u.paramsStore.remove(e),d.free(e)},cleanup:function(e,t,n){var i=u.getName(e);u.onComplete(e,i,t,n),o._getFileState(e)&&o._clearXhrs&&o._clearXhrs(e),d.free(e)},getProxyOrBlob:function(e){return o.getProxy&&o.getProxy(e)||o.getFile&&o.getFile(e)},initHandler:function(){var e=t?qq[t]:qq.traditional,n=qq.supportedFeatures.ajaxUploading?"Xhr":"Form";(o=new e[n+"UploadHandler"](u,{getCustomResumeData:u.getCustomResumeData,getDataByUuid:u.getDataByUuid,getName:u.getName,getSize:u.getSize,getUuid:u.getUuid,log:i,onCancel:u.onCancel,onProgress:u.onProgress,onUuidChanged:u.onUuidChanged,onFinalizing:function(e){u.setStatus(e,qq.status.UPLOAD_FINALIZING)}}))._removeExpiredChunkingRecords&&o._removeExpiredChunkingRecords()},isDeferredEligibleForUpload:function(e){return u.isQueued(e)},maybeDefer:function(e,t){return t&&!o.getFile(e)&&t instanceof qq.BlobProxy?(u.onUploadPrep(e),i("Attempting to generate a blob on-demand for "+e),t.create().then(function(t){i("Generated an on-demand blob for "+e),o.updateBlob(e,t),u.setSize(e,t.size),o.reevaluateChunking(e),h.maybeSendDeferredFiles(e)},function(t){var o={};t&&(o.error=t),i(qq.format("Failed to generate blob for ID {}.  Error message: {}.",e,t),"error"),u.onComplete(e,u.getName(e),qq.extend(o,n),null),h.maybeSendDeferredFiles(e),d.free(e)}),!1):h.maybeSendDeferredFiles(e)},maybeSendDeferredFiles:function(e){var t=u.getIdsInProxyGroup(e),n=!1;return t&&t.length?(i("Maybe ready to upload proxy group file "+e),qq.each(t,function(t,i){if(h.isDeferredEligibleForUpload(i)&&o.getFile(i))n=i===e,h.now(i);else if(h.isDeferredEligibleForUpload(i))return!1})):(n=!0,h.now(e)),n},maybeNewUuid:function(e,t){void 0!==t.newUuid&&u.onUuidChanged(e,t.newUuid)},normalizeResponse:function(e,t){var n=e;return qq.isObject(e)||(n={},qq.isString(e)&&!t&&(n.error=e)),n.success=t,n},now:function(e){var t=u.getName(e);if(!r.isValid(e))throw new qq.Error(e+" is not a valid file ID to upload!");u.onUpload(e,t).then(function(n){n&&n.pause?(u.setStatus(e,qq.status.PAUSED),o.pause(e),d.free(e)):a&&o._shouldChunkThisFile(e)?c.sendNext(e):p(e,t)},function(n){if(i(e+" upload start aborted due to rejected onUpload Promise - details: "+(n=n||{}),"error"),!u.onAutoRetry(e,t,n.responseJSON||{})){var o=h.normalizeResponse(n.responseJSON,!1);h.cleanup(e,o)}})},start:function(e){var t=h.getProxyOrBlob(e);return t?h.maybeDefer(e,t):(h.now(e),!0)}};qq.extend(this,{add:function(e,t){o.add.apply(this,arguments)},upload:function(e){return!!d.open(e)&&h.start(e)},retry:function(e){return l&&(o._getFileState(e).temp.ignoreFailure=!1),d.isUsingConnection(e)?h.start(e):r.upload(e)},cancel:function(e){var t=o.cancel(e);qq.isGenericPromise(t)?t.then(function(){h.cancel(e)}):!1!==t&&h.cancel(e)},cancelAll:function(){var e,t=d.getWaitingOrConnected();if(t.length)for(e=t.length-1;e>=0;e--)r.cancel(t[e]);d.reset()},getFile:function(e){return o.getProxy&&o.getProxy(e)?o.getProxy(e).referenceBlob:o.getFile&&o.getFile(e)},isProxied:function(e){return!(!o.getProxy||!o.getProxy(e))},getInput:function(e){if(o.getInput)return o.getInput(e)},reset:function(){i("Resetting upload handler"),r.cancelAll(),d.reset(),o.reset()},expunge:function(e){if(r.isValid(e))return o.expunge(e)},isValid:function(e){return o.isValid(e)},hasResumeRecord:function(e){var t=o.isValid(e)&&o._getLocalStorageId&&o._getLocalStorageId(e);return!!t&&!!localStorage.getItem(t)},getResumableFilesData:function(){return o.getResumableFilesData?o.getResumableFilesData():[]},getThirdPartyFileId:function(e){if(r.isValid(e))return o.getThirdPartyFileId(e)},pause:function(e){return!!(r.isResumable(e)&&o.pause&&r.isValid(e)&&o.pause(e))&&(d.free(e),o.moveInProgressToRemaining(e),!0)},isAttemptingResume:function(e){return!!o.isAttemptingResume&&o.isAttemptingResume(e)},isResumable:function(e){return!!o.isResumable&&o.isResumable(e)}}),qq.extend(u,e),i=u.log,a=u.chunking.enabled&&qq.supportedFeatures.chunking,l=a&&u.chunking.concurrent.enabled,(s={})[u.preventRetryParam]=!0,n=s,h.initHandler()},qq.WindowReceiveMessage=function(e){"use strict";var t={};qq.extend({log:function(e,t){}},e),qq.extend(this,{receiveMessage:function(e,n){window.postMessage?t[e]=qq(window).attach("message",function(e){n(e.data)}):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(e){if(window.postMessage){var n=t[e];n&&n()}}})},qq.FormUploadHandler=function(e){"use strict";var t=e.options,n=this,i=e.proxy,o=qq.getUniqueId(),s={},r={},a={},l=t.isCors,u=t.inputName,c=i.getUuid,d=i.log,p=new qq.WindowReceiveMessage({log:d});function h(e){return e.split("_")[0]}qq.extend(this,new qq.UploadHandler(e)),qq.override(this,function(e){return{add:function(t,n){e.add(t,{input:n}),n.setAttribute("name",u),n.parentNode&&qq(n).remove()},expunge:function(t){!function(e){delete r[e],l&&(clearTimeout(a[e]),delete a[e],p.stopReceivingMessages(e));var t=document.getElementById(n._getIframeName(e));t&&(t.setAttribute("src","javascript:false;"),qq(t).remove())}(t),e.expunge(t)},isValid:function(t){return e.isValid(t)&&void 0!==n._getFileState(t).input}}}),qq.extend(this,{getInput:function(e){return n._getFileState(e).input},_attachLoadEvent:function(e,t){var i;l?function(e,t){var i=e.id,o=h(i),l=c(o);s[l]=t,r[o]=qq(e).attach("load",function(){n.getInput(o)&&(d("Received iframe load event for CORS upload request (iframe name "+i+")"),a[i]=setTimeout(function(){var e="No valid message received from loaded iframe for iframe name "+i;d(e,"error"),t({error:e})},1e3))}),p.receiveMessage(i,function(e){d("Received the following window message: '"+e+"'"),h(i);var t,o=n._parseJsonResponse(e),r=o.uuid;r&&s[r]?(d("Handling response for iframe name "+i),clearTimeout(a[i]),delete a[i],n._detachLoadEvent(i),t=s[r],delete s[r],p.stopReceivingMessages(i),t(o)):r||d("'"+e+"' does not contain a UUID - ignoring.")})}(e,t):r[e.id]=qq(e).attach("load",function(){if(d("Received response for "+e.id),e.parentNode){try{if(e.contentDocument&&e.contentDocument.body&&"false"==e.contentDocument.body.innerHTML)return}catch(e){d("Error when attempting to access iframe during handling of upload response ("+e.message+")","error"),i={success:!1}}t(i)}})},_createIframe:function(e){var t,i,o=n._getIframeName(e);return t=o,(i=qq.toElement("<iframe src='javascript:false;' name='"+t+"' />")).setAttribute("id",t),i.style.display="none",document.body.appendChild(i),i},_detachLoadEvent:function(e){void 0!==r[e]&&(r[e](),delete r[e])},_getIframeName:function(e){return e+"_"+o},_initFormForUpload:function(e){var t=e.method,n=e.endpoint,i=e.params,o=e.paramsInBody,s=e.targetName,r=qq.toElement("<form method='"+t+"' enctype='multipart/form-data'></form>"),a=n;return o?qq.obj2Inputs(i,r):a=qq.obj2url(i,n),r.setAttribute("action",a),r.setAttribute("target",s),r.style.display="none",document.body.appendChild(r),r},_parseJsonResponse:function(e){var t={};try{t=qq.parseJson(e)}catch(e){d("Error when attempting to parse iframe upload response ("+e.message+")","error")}return t}})},qq.XhrUploadHandler=function(e){"use strict";var t=this,n=e.options.namespace,i=e.proxy,o=e.options.chunking,s=function(e){var n=t._getFileState(e);if(n.chunkSize)return n.chunkSize;var i=o.partSize;return qq.isFunction(i)&&(i=i(e,c(e))),n.chunkSize=i,i},r=e.options.resume,a=o&&e.options.chunking.enabled&&qq.supportedFeatures.chunking,l=r&&e.options.resume.enabled&&a&&qq.supportedFeatures.resume,u=i.getName,c=i.getSize,d=i.getUuid,p=i.getEndpoint,h=i.getDataByUuid,f=i.onUuidChanged,g=i.onProgress,m=i.log,q=i.getCustomResumeData;function v(e){qq.each(t._getXhrs(e),function(n,i){var o=t._getAjaxRequester(e,n);i.onreadystatechange=null,i.upload.onprogress=null,i.abort(),o&&o.canceled&&o.canceled(e)})}qq.extend(this,new qq.UploadHandler(e)),qq.override(this,function(e){return{add:function(n,i){if(qq.isFile(i)||qq.isBlob(i))e.add(n,{file:i});else{if(!(i instanceof qq.BlobProxy))throw new Error("Passed obj is not a File, Blob, or proxy");e.add(n,{proxy:i})}t._initTempState(n),l&&t._maybePrepareForResume(n)},expunge:function(n){v(n),t._maybeDeletePersistedChunkData(n),t._clearXhrs(n),e.expunge(n)}}}),qq.extend(this,{clearCachedChunk:function(e,n){var i=t._getFileState(e);i&&delete i.temp.cachedChunks[n]},clearXhr:function(e,n){var i=t._getFileState(e).temp;i.xhrs&&delete i.xhrs[n],i.ajaxRequesters&&delete i.ajaxRequesters[n]},finalizeChunks:function(e,n){var i=t._getTotalChunks(e)-1,o=t._getXhr(e,i);return n?(new qq.Promise).success(n(o),o):(new qq.Promise).success({},o)},getFile:function(e){return t.isValid(e)&&t._getFileState(e).file},getProxy:function(e){return t.isValid(e)&&t._getFileState(e).proxy},getResumableFilesData:function(){var e=[];return t._iterateResumeRecords(function(n,i){t.moveInProgressToRemaining(null,i.chunking.inProgress,i.chunking.remaining);var o={name:i.name,remaining:i.chunking.remaining,size:i.size,uuid:i.uuid};i.key&&(o.key=i.key),i.customResumeData&&(o.customResumeData=i.customResumeData),e.push(o)}),e},isAttemptingResume:function(e){return t._getFileState(e).attemptingResume},isResumable:function(e){return!!o&&t.isValid(e)&&!t._getFileState(e).notResumable},moveInProgressToRemaining:function(e,n,i){var o=(t._getFileState(e)||{}).chunking||{},s=n||o.inProgress,r=i||o.remaining;s&&(m(qq.format("Moving these chunks from in-progress {}, to remaining.",JSON.stringify(s))),s.reverse(),qq.each(s,function(e,t){r.unshift(t)}),s.length=0)},pause:function(e){if(t.isValid(e))return m(qq.format("Aborting XHR upload for {} '{}' due to pause instruction.",e,u(e))),t._getFileState(e).paused=!0,v(e),!0},reevaluateChunking:function(e){if(o&&t.isValid(e)){var n,i,s=t._getFileState(e);if(delete s.chunking,s.chunking={},(n=t._getTotalChunks(e))>1||o.mandatory){for(s.chunking.enabled=!0,s.chunking.parts=n,s.chunking.remaining=[],i=0;i<n;i++)s.chunking.remaining.push(i);t._initTempState(e)}else s.chunking.enabled=!1}},updateBlob:function(e,n){t.isValid(e)&&(t._getFileState(e).file=n)},_clearXhrs:function(e){var n=t._getFileState(e).temp;qq.each(n.ajaxRequesters,function(e){delete n.ajaxRequesters[e]}),qq.each(n.xhrs,function(e){delete n.xhrs[e]})},_createXhr:function(e,n){return t._registerXhr(e,n,qq.createXhrInstance())},_getAjaxRequester:function(e,n){var i=null==n?-1:n;return t._getFileState(e).temp.ajaxRequesters[i]},_getChunkData:function(e,n){var i=s(e),o=c(e),r=t.getFile(e),a=i*n,l=a+i>=o?o:a+i,u=t._getTotalChunks(e),d=this._getFileState(e).temp.cachedChunks,p=d[n]||qq.sliceBlob(r,a,l);return d[n]=p,{part:n,start:a,end:l,count:u,blob:p,size:l-a}},_getChunkDataForCallback:function(e){return{partIndex:e.part,startByte:e.start+1,endByte:e.end,totalParts:e.count}},_getLocalStorageId:function(e){var t=u(e),i=c(e),o=s(e),a=p(e),l=r.customKeys(e),d=qq.format("qq{}resume{}-{}-{}-{}-{}",n,"5.0",t,i,o,a);return l.forEach(function(e){d+="-"+e}),d},_getMimeType:function(e){return t.getFile(e).type},_getPersistableData:function(e){return t._getFileState(e).chunking},_getTotalChunks:function(e){if(o){var t=c(e),n=s(e);return Math.ceil(t/n)}},_getXhr:function(e,n){var i=null==n?-1:n;return t._getFileState(e).temp.xhrs[i]},_getXhrs:function(e){return t._getFileState(e).temp.xhrs},_iterateResumeRecords:function(e){l&&qq.each(localStorage,function(t,i){if(0===t.indexOf(qq.format("qq{}resume",n))){var o=JSON.parse(i);e(t,o)}})},_initTempState:function(e){t._getFileState(e).temp={ajaxRequesters:{},chunkProgress:{},xhrs:{},cachedChunks:{}}},_markNotResumable:function(e){t._getFileState(e).notResumable=!0},_maybeDeletePersistedChunkData:function(e){var n;return!!(l&&t.isResumable(e)&&(n=t._getLocalStorageId(e))&&localStorage.getItem(n))&&(localStorage.removeItem(n),!0)},_maybePrepareForResume:function(e){var n,i,o=t._getFileState(e);l&&void 0===o.key&&(n=t._getLocalStorageId(e),(i=localStorage.getItem(n))&&(i=JSON.parse(i),h(i.uuid)?t._markNotResumable(e):(m(qq.format("Identified file with ID {} and name of {} as resumable.",e,u(e))),f(e,i.uuid),o.key=i.key,o.chunking=i.chunking,o.loaded=i.loaded,o.customResumeData=i.customResumeData,o.attemptingResume=!0,t.moveInProgressToRemaining(e))))},_maybePersistChunkedState:function(e){var n,i,o=t._getFileState(e);if(l&&t.isResumable(e)){var s=q(e);n=t._getLocalStorageId(e),i={name:u(e),size:c(e),uuid:d(e),key:o.key,chunking:o.chunking,loaded:o.loaded,lastUpdated:Date.now()},s&&(i.customResumeData=s);try{localStorage.setItem(n,JSON.stringify(i))}catch(t){m(qq.format("Unable to save resume data for '{}' due to error: '{}'.",e,t.toString()),"warn")}}},_registerProgressHandler:function(e,n,i){var o=t._getXhr(e,n),s=u(e),r={simple:function(t,n){var i=c(e);g(e,s,t===n?i:t>=i?i-1:t,i)},chunked:function(o,r){var a=t._getFileState(e).temp.chunkProgress,l=t._getFileState(e).loaded,u=o,d=r,p=c(e),h=u-(d-i),f=l;a[n]=h,qq.each(a,function(e,t){f+=t}),g(e,s,f,p)}};o.upload.onprogress=function(e){e.lengthComputable&&r[null==i?"simple":"chunked"](e.loaded,e.total)}},_registerXhr:function(e,n,i,o){var s=null==n?-1:n,r=t._getFileState(e).temp;return r.xhrs=r.xhrs||{},r.ajaxRequesters=r.ajaxRequesters||{},r.xhrs[s]=i,o&&(r.ajaxRequesters[s]=o),i},_removeExpiredChunkingRecords:function(){var e=r.recordsExpireIn;t._iterateResumeRecords(function(t,n){var i=new Date(n.lastUpdated);i.setDate(i.getDate()+e),i.getTime()<=Date.now()&&(m("Removing expired resume record with key "+t),localStorage.removeItem(t))})},_shouldChunkThisFile:function(e){var n=t._getFileState(e);if(n)return n.chunking||t.reevaluateChunking(e),n.chunking.enabled}})},qq.DeleteFileAjaxRequester=function(e){"use strict";var t,n={method:"DELETE",uuidParamName:"qquuid",endpointStore:{},maxConnections:3,customHeaders:function(e){return{}},paramsStore:{},cors:{expected:!1,sendCredentials:!1},log:function(e,t){},onDelete:function(e){},onDeleteComplete:function(e,t,n){}};qq.extend(n,e),t=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["POST","DELETE"],method:n.method,endpointStore:n.endpointStore,paramsStore:n.paramsStore,mandatedParams:"POST"===n.method.toUpperCase()?{_method:"DELETE"}:{},maxConnections:n.maxConnections,customHeaders:function(e){return n.customHeaders.get(e)},log:n.log,onSend:n.onDelete,onComplete:n.onDeleteComplete,cors:n.cors})),qq.extend(this,{sendDelete:function(e,i,o){var s=o||{};n.log("Submitting delete file request for "+e),"DELETE"===n.method?t.initTransport(e).withPath(i).withParams(s).send():(s[n.uuidParamName]=i,t.initTransport(e).withParams(s).send())}})},function(){function e(e,n,i,o,s){var r,a=e.naturalWidth,l=e.naturalHeight,u=o.width,c=o.height,d=i.getContext("2d"),p=new qq.Promise;return d.save(),o.resize?function(e){var n=e.blob,i=e.image,o=e.imageHeight,s=e.imageWidth,r=e.orientation,a=new qq.Promise,l=e.resize,u=document.createElement("canvas"),c=u.getContext("2d"),d=e.canvas,p=e.targetHeight,h=e.targetWidth;return t(u,s,o,r),d.height=p,d.width=h,c.drawImage(i,0,0),l({blob:n,height:p,image:i,sourceCanvas:u,targetCanvas:d,width:h}).then(function(){d.qqImageRendered&&d.qqImageRendered(),a.success()},a.failure),a}({blob:n,canvas:i,image:e,imageHeight:l,imageWidth:a,orientation:o.orientation,resize:o.resize,targetHeight:c,targetWidth:u}):(qq.supportedFeatures.unlimitedScaledImageSize||(r=function(e){if(!qq.ios())throw new qq.Error("Downsampled dimensions can only be reliably calculated for iOS!");if(e.origHeight*e.origWidth>5241e3)return{newHeight:Math.round(Math.sqrt(e.origHeight/e.origWidth*5241e3)),newWidth:Math.round(Math.sqrt(e.origWidth/e.origHeight*5241e3))}}({origWidth:u,origHeight:c}))&&(qq.log(qq.format("Had to reduce dimensions due to device limitations from {}w / {}h to {}w / {}h",u,c,r.newWidth,r.newHeight),"warn"),u=r.newWidth,c=r.newHeight),t(i,u,c,o.orientation),qq.ios()?function(){(function(e){var t,n=e.naturalWidth,i=e.naturalHeight,o=document.createElement("canvas");return n*i>1048576&&(o.width=o.height=1,(t=o.getContext("2d")).drawImage(e,1-n,0),0===t.getImageData(0,0,1,1).data[3])})(e)&&(a/=2,l/=2);var t,n,i,o=1024,r=document.createElement("canvas"),p=s?function(e,t,n){var i,o,s,r=document.createElement("canvas"),a=0,l=n,u=n;for(r.width=1,r.height=n,(i=r.getContext("2d")).drawImage(e,0,0),o=i.getImageData(0,0,1,n).data;u>a;)0===o[4*(u-1)+3]?l=u:a=u,u=l+a>>1;return 0==(s=u/n)?1:s}(e,0,l):1,h=Math.ceil(o*u/a),f=Math.ceil(o*c/l/p),g=0,m=0;for(r.width=r.height=o,t=r.getContext("2d");g<l;){for(n=0,i=0;n<a;)t.clearRect(0,0,o,o),t.drawImage(e,-n,-g),d.drawImage(r,0,0,o,o,i,m,h,f),n+=o,i+=h;g+=o,m+=f}d.restore(),r=t=null}():d.drawImage(e,0,0,u,c),i.qqImageRendered&&i.qqImageRendered(),p.success(),p)}function t(e,t,n,i){switch(i){case 5:case 6:case 7:case 8:e.width=n,e.height=t;break;default:e.width=t,e.height=n}var o=e.getContext("2d");switch(i){case 2:o.translate(t,0),o.scale(-1,1);break;case 3:o.translate(t,n),o.rotate(Math.PI);break;case 4:o.translate(0,n),o.scale(1,-1);break;case 5:o.rotate(.5*Math.PI),o.scale(1,-1);break;case 6:o.rotate(.5*Math.PI),o.translate(0,-n);break;case 7:o.rotate(.5*Math.PI),o.translate(t,-n),o.scale(-1,1);break;case 8:o.rotate(-.5*Math.PI),o.translate(-t,0)}}function n(e,t){var n=this;window.Blob&&e instanceof Blob&&function(){var t=new Image,i=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;if(!i)throw Error("No createObjectURL function found to create blob url");t.src=i.createObjectURL(e),n.blob=e,e=t}(),e.naturalWidth||e.naturalHeight||(e.onload=function(){var e=n.imageLoadListeners;e&&(n.imageLoadListeners=null,setTimeout(function(){for(var t=0,n=e.length;t<n;t++)e[t]()},0))},e.onerror=t,this.imageLoadListeners=[]),this.srcImage=e}n.prototype.render=function(t,n){n=n||{};var i,o,s=this,r=this.srcImage.naturalWidth,a=this.srcImage.naturalHeight,l=n.width,u=n.height,c=n.maxWidth,d=n.maxHeight,p=!this.blob||"image/jpeg"===this.blob.type,h=t.tagName.toLowerCase();this.imageLoadListeners?this.imageLoadListeners.push(function(){s.render(t,n)}):(l&&!u?u=a*l/r<<0:u&&!l?l=r*u/a<<0:(l=r,u=a),c&&l>c&&(u=a*(l=c)/r<<0),d&&u>d&&(l=r*(u=d)/a<<0),i={width:l,height:u},qq.each(n,function(e,t){i[e]=t}),"img"===h?(o=t.src,function(t,n,i,o){var s=document.createElement("canvas"),r=i.mime||"image/jpeg",a=new qq.Promise;return e(t,n,s,i,o).then(function(){a.success(s.toDataURL(r,i.quality||.8))}),a}(s.srcImage,s.blob,i,p).then(function(e){t.src=e,o===t.src&&t.onload()})):"canvas"===h&&e(this.srcImage,this.blob,t,i,p),"function"==typeof this.onrender&&this.onrender(t))},qq.MegaPixImage=n}(),qq.ImageGenerator=function(e){"use strict";function t(e){return"img"===e.tagName.toLowerCase()}function n(e){return"canvas"===e.tagName.toLowerCase()}function i(e){var t=e.split("/"),n=t[t.length-1].split("?")[0],i=qq.getExtension(n);switch(i=i&&i.toLowerCase()){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"bmp":return"image/bmp";case"gif":return"image/gif";case"tiff":case"tif":return"image/tiff"}}function o(e){var t,n,i,o=document.createElement("a");return o.href=e,t=o.protocol,i=o.port,n=o.hostname,t.toLowerCase()!==window.location.protocol.toLowerCase()||(n.toLowerCase()!==window.location.hostname.toLowerCase()||i!==window.location.port&&!qq.ie())}function s(i,o){var s=t(i)||n(i);return t(i)?function(t,n){t.onload=function(){t.onload=null,t.onerror=null,n.success(t)},t.onerror=function(){t.onload=null,t.onerror=null,e("Problem drawing thumbnail!","error"),n.failure(t,"Problem drawing thumbnail!")}}(i,o):n(i)?function(e,t){e.qqImageRendered=function(){t.success(e)}}(i,o):(o.failure(i),e(qq.format("Element container of type {} is not supported!",i.tagName),"error")),s}function r(e,t,n,r,a){var l=new Image,u=new qq.Promise;s(l,u),o(e)&&(l.crossOrigin="anonymous"),l.src=e,u.then(function(){s(t,n),new qq.MegaPixImage(l).render(t,{maxWidth:r,maxHeight:r,mime:i(e),resize:a})},n.failure)}function a(e,t,n,i){s(t,n),qq(t).css({maxWidth:i+"px",maxHeight:i+"px"}),t.src=e}function l(e,i,l){var u,c=new qq.Promise,d=l.scale,p=d?l.maxSize:null;return d&&t(i)?(u=document.createElement("canvas")).getContext&&u.getContext("2d")?o(e)&&void 0===(new Image).crossOrigin?a(e,i,c,p):r(e,i,c,p):a(e,i,c,p):n(i)?r(e,i,c,p):s(i,c)&&(i.src=e),c}qq.extend(this,{generate:function(t,n,i){return qq.isString(t)?(e("Attempting to update thumbnail based on server response."),l(t,n,i||{})):(e("Attempting to draw client-side image preview."),function(t,n,i){var o=new qq.Promise,r=new qq.Identify(t,e),a=i.maxSize,l=null==i.orient||i.orient,u=function(){n.onerror=null,n.onload=null,e("Could not render preview, file may be too large!","error"),o.failure(n,"Browser cannot render image!")};return r.isPreviewable().then(function(r){var c={parse:function(){return(new qq.Promise).success()}},d=l?new qq.Exif(t,e):c,p=new qq.MegaPixImage(t,u);s(n,o)&&d.parse().then(function(e){var t=e&&e.Orientation;p.render(n,{maxWidth:a,maxHeight:a,orientation:t,mime:r,resize:i.customResizeFunction})},function(t){e(qq.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",t)),p.render(n,{maxWidth:a,maxHeight:a,mime:r,resize:i.customResizeFunction})})},function(){e("Not previewable"),o.failure(n,"Not previewable")}),o}(t,n,i||{}))}}),this._testing={},this._testing.isImg=t,this._testing.isCanvas=n,this._testing.isCrossOrigin=o,this._testing.determineMimeOfFileName=i},qq.Exif=function(e,t){"use strict";var n=[274],i={274:{name:"Orientation",bytes:2}};function o(e){for(var t=0,n=0;e.length>0;)t+=parseInt(e.substring(0,2),16)*Math.pow(2,n),e=e.substring(2,e.length),n+=8;return t}function s(){var t=new qq.Promise;return qq.readBlobToHex(e,0,6).then(function(n){0!==n.indexOf("ffd8")?t.failure("Not a valid JPEG!"):function t(n,i){var o=n,s=i;return void 0===o&&(o=2,s=new qq.Promise),qq.readBlobToHex(e,o,4).then(function(e){var n,i=/^ffe([0-9])/.exec(e);i?"1"!==i[1]?(n=parseInt(e.slice(4,8),16),t(o+n+2,s)):s.success(o):s.failure("No EXIF header to be found!")}),s}().then(function(e){t.success(e)},function(e){t.failure(e)})}),t}qq.extend(this,{parse:function(){var r=new qq.Promise,a=function(e){t(qq.format("EXIF header parse failed: '{}' ",e)),r.failure(e)};return s().then(function(s){var l,u;t(qq.format("Moving forward with EXIF header parsing for '{}'",void 0===e.name?"blob":e.name)),(l=s,u=new qq.Promise,qq.readBlobToHex(e,l+10,2).then(function(e){u.success("4949"===e)}),u).then(function(l){t(qq.format("EXIF Byte order is {} endian",l?"little":"big")),function(t,n){var i=new qq.Promise;return qq.readBlobToHex(e,t+18,2).then(function(e){if(n)return i.success(o(e));i.success(parseInt(e,16))}),i}(s,l).then(function(u){var c,d,p,h;t(qq.format("Found {} APP1 directory entries",u)),(c=s,d=u,p=c+20,h=12*d,qq.readBlobToHex(e,p,h)).then(function(e){var s=function(e){for(var t=[],n=0;n+24<=e.length;)t.push(e.slice(n,n+24)),n+=24;return t}(e),a=function(e,t){var s=qq.extend([],n),r={};return qq.each(t,function(t,n){var a,l,u,c=n.slice(0,4),d=e?o(c):parseInt(c,16),p=s.indexOf(d);if(p>=0&&(l=i[d].name,u=i[d].bytes,a=n.slice(16,16+2*u),r[l]=e?o(a):parseInt(a,16),s.splice(p,1)),0===s.length)return!1}),r}(l,s);t("Successfully parsed some EXIF tags"),r.success(a)},a)},a)},a)},a),r}}),this._testing={},this._testing.parseLittleEndian=o},qq.Identify=function(e,t){"use strict";qq.extend(this,{isPreviewable:function(){var n=this,i=new qq.Promise,o=!1,s=void 0===e.name?"blob":e.name;return t(qq.format("Attempting to determine if {} can be rendered in this browser",s)),t("First pass: check type attribute of blob object."),this.isPreviewableSync()?(t("Second pass: check for magic bytes in file header."),qq.readBlobToHex(e,0,4).then(function(e){qq.each(n.PREVIEWABLE_MIME_TYPES,function(t,n){if(s=e,r=!1,a=[].concat(n),qq.each(a,function(e,t){if(0===s.indexOf(t))return r=!0,!1}),r)return("image/tiff"!==t||qq.supportedFeatures.tiffPreviews)&&(o=!0,i.success(t)),!1;var s,r,a}),t(qq.format("'{}' is {} able to be rendered in this browser",s,o?"":"NOT")),o||i.failure()},function(){t("Error reading file w/ name '"+s+"'.  Not able to be rendered in this browser."),i.failure()})):i.failure(),i},isPreviewableSync:function(){var n=e.type,i=qq.indexOf(Object.keys(this.PREVIEWABLE_MIME_TYPES),n)>=0,o=!1,s=void 0===e.name?"blob":e.name;return i&&(o="image/tiff"!==n||qq.supportedFeatures.tiffPreviews),!o&&t(s+" is not previewable in this browser per the blob's type attr"),o}})},qq.Identify.prototype.PREVIEWABLE_MIME_TYPES={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]},qq.ImageValidation=function(e,t){"use strict";this.validate=function(n){var i,o=new qq.Promise;return t("Attempting to validate image."),!function(e){var t=!1;return qq.each(e,function(e,n){if(n>0)return t=!0,!1}),t}(n)?o.success():(i=new qq.Promise,new qq.Identify(e,t).isPreviewable().then(function(){var n=new Image,o=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;o?(n.onerror=function(){t("Cannot determine dimensions for image.  May be too large.","error"),i.failure()},n.onload=function(){i.success({width:this.width,height:this.height})},n.src=o.createObjectURL(e)):(t("No createObjectURL function available to generate image URL!","error"),i.failure())},i.failure),i).then(function(e){var t=function(e,t){var n;return qq.each(e,function(e,i){if(i>0){var o=/(max|min)(Width|Height)/.exec(e),s=o[2].charAt(0).toLowerCase()+o[2].slice(1),r=t[s];switch(o[1]){case"min":if(r<i)return n=e,!1;break;case"max":if(r>i)return n=e,!1}}}),n}(n,e);t?o.failure(t):o.success()},o.success),o}},qq.Session=function(e){"use strict";var t={endpoint:null,params:{},customHeaders:{},cors:{},addFileRecord:function(e){},log:function(e,t){}};function n(e,n,i,o){var s=!1;(n=n&&function(e){if(qq.isArray(e))return!0;t.log("Session response is not an array.","error")}(e))&&qq.each(e,function(e,n){if(null==n.uuid)s=!0,t.log(qq.format("Session response item {} did not include a valid UUID - ignoring.",e),"error");else if(null==n.name)s=!0,t.log(qq.format("Session response item {} did not include a valid name - ignoring.",e),"error");else try{return t.addFileRecord(n),!0}catch(e){s=!0,t.log(e.message,"error")}return!1}),o[n&&!s?"success":"failure"](e,i)}qq.extend(t,e,!0),this.refresh=function(){var e=new qq.Promise,i=qq.extend({},t);return new qq.SessionAjaxRequester(qq.extend(i,{onComplete:function(t,i,o){n(t,i,o,e)}})).queryServer(),e}},qq.SessionAjaxRequester=function(e){"use strict";var t,n={endpoint:null,customHeaders:{},params:{},cors:{expected:!1,sendCredentials:!1},onComplete:function(e,t,n){},log:function(e,t){}};qq.extend(n,e),t=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["GET"],method:"GET",endpointStore:{get:function(){return n.endpoint}},customHeaders:n.customHeaders,log:n.log,onComplete:function(e,t,i){var o=null;if(null!=t.responseText)try{o=qq.parseJson(t.responseText)}catch(e){n.log("Problem parsing session response: "+e.message,"error"),i=!0}n.onComplete(o,!i,t)},cors:n.cors})),qq.extend(this,{queryServer:function(){var e=qq.extend({},n.params);n.log("Session query request."),t.initTransport("sessionRefresh").withParams(e).withCacheBuster().send()}})},qq.Scaler=function(e,t){"use strict";var n=e.customResizer,i=e.sendOriginal,o=e.orient,s=e.defaultType,r=e.defaultQuality/100,a=e.failureText,l=e.includeExif,u=this._getSortedSizes(e.sizes);qq.extend(this,{enabled:qq.supportedFeatures.scaling&&u.length>0,getFileRecords:function(e,c,d){var p=this,h=[],f=d.blob?d.blob:d;return new qq.Identify(f,t).isPreviewableSync()?(qq.each(u,function(e,i){var u=p._determineOutputType({defaultType:s,requestedType:i.type,refType:f.type});h.push({uuid:qq.getUniqueId(),name:p._getName(c,{name:i.name,type:u,refType:f.type}),blob:new qq.BlobProxy(f,qq.bind(p._generateScaledImage,p,{customResizeFunction:n,maxSize:i.maxSize,orient:o,type:u,quality:r,failedText:a,includeExif:l,log:t}))})}),h.push({uuid:e,name:c,size:f.size,blob:i?f:null})):h.push({uuid:e,name:c,size:f.size,blob:f}),h},handleNewFile:function(e,t,n,i,o,s,r,a){e.qqButtonId||e.blob&&e.blob.qqButtonId;var l,u=[],c=null,d=a.addFileToHandler,p=a.uploadData,h=a.paramsStore,f=qq.getUniqueId();qq.each(this.getFileRecords(n,t,e),function(e,t){var n,i=t.size;t.blob instanceof qq.BlobProxy&&(i=-1),n=p.addFile({uuid:t.uuid,name:t.name,size:i,batchId:s,proxyGroupId:f}),t.blob instanceof qq.BlobProxy?u.push(n):c=n,t.blob?(d(n,t.blob),o.push({id:n,file:t.blob})):p.setStatus(n,qq.status.REJECTED)}),null!==c&&(qq.each(u,function(e,t){var n={qqparentuuid:p.retrieve({id:c}).uuid,qqparentsize:p.retrieve({id:c}).size};n[r]=p.retrieve({id:t}).uuid,p.setParentId(t,c),h.addReadOnly(t,n)}),u.length&&((l={})[r]=p.retrieve({id:c}).uuid,h.addReadOnly(c,l)))}})},qq.extend(qq.Scaler.prototype,{scaleImage:function(e,t,n){"use strict";if(!qq.supportedFeatures.scaling)throw new qq.Error("Scaling is not supported in this browser!");var i=new qq.Promise,o=n.log,s=n.getFile(e),r=n.uploadData.retrieve({id:e}),a=r&&r.name,l=r&&r.uuid,u={customResizer:t.customResizer,sendOriginal:!1,orient:t.orient,defaultType:t.type||null,defaultQuality:t.quality,failedToScaleText:"Unable to scale",sizes:[{name:"",maxSize:t.maxSize}]},c=new qq.Scaler(u,o);return qq.Scaler&&qq.supportedFeatures.imagePreviews&&s?qq.bind(function(){var t=c.getFileRecords(l,a,s)[0];t&&t.blob instanceof qq.BlobProxy?t.blob.create().then(i.success,i.failure):(o(e+" is not a scalable image!","error"),i.failure())},this)():(i.failure(),o("Could not generate requested scaled image for "+e+".  Scaling is either not possible in this browser, or the file could not be located.","error")),i},_determineOutputType:function(e){"use strict";var t=e.requestedType,n=e.defaultType,i=e.refType;return n||t?t&&qq.indexOf(Object.keys(qq.Identify.prototype.PREVIEWABLE_MIME_TYPES),t)>=0?"image/tiff"===t?qq.supportedFeatures.tiffPreviews?t:n:t:n:"image/jpeg"!==i?"image/png":i},_getName:function(e,t){"use strict";var n=e.lastIndexOf("."),i=t.type||"image/png",o=t.refType,s="",r=qq.getExtension(e),a="";return t.name&&t.name.trim().length&&(a=" ("+t.name+")"),n>=0?(s=e.substr(0,n),o!==i&&(r=i.split("/")[1]),s+=a+"."+r):s=e+a,s},_getSortedSizes:function(e){"use strict";return(e=qq.extend([],e)).sort(function(e,t){return e.maxSize>t.maxSize?1:e.maxSize<t.maxSize?-1:0})},_generateScaledImage:function(e,t){"use strict";var n=this,i=e.customResizeFunction,o=e.log,s=e.maxSize,r=e.orient,a=e.type,l=e.quality,u=e.failedText,c=e.includeExif&&"image/jpeg"===t.type&&"image/jpeg"===a,d=new qq.Promise,p=new qq.ImageGenerator(o),h=document.createElement("canvas");return o("Attempting to generate scaled version for "+t.name),p.generate(t,h,{maxSize:s,orient:r,customResizeFunction:i}).then(function(){var e=h.toDataURL(a,l),i=function(){o("Success generating scaled version for "+t.name);var n=qq.dataUriToBlob(e);d.success(n)};c?n._insertExifHeader(t,e,o).then(function(t){e=t,i()},function(){o("Problem inserting EXIF header into scaled image.  Using scaled image w/out EXIF data.","error"),i()}):i()},function(){o("Failed attempt to generate scaled version for "+t.name,"error"),d.failure(u)}),d},_insertExifHeader:function(e,t,n){"use strict";var i=new FileReader,o=new qq.Promise,s="";return i.onload=function(){s=i.result,o.success(qq.ExifRestorer.restore(s,t))},i.onerror=function(){n("Problem reading "+e.name+" during attempt to transfer EXIF data to scaled version.","error"),o.failure()},i.readAsDataURL(e),o},_dataUriToBlob:function(e){"use strict";var t,n,i,o;return t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURI(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i),qq.each(t,function(e,t){o[e]=t.charCodeAt(0)}),this._createBlob(i,n)},_createBlob:function(e,t){"use strict";var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,i=n&&new n;return i?(i.append(e),i.getBlob(t)):new Blob([e],{type:t})}}),qq.ExifRestorer=(ExifRestorer={KEY_STR:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode64:function(e){var t,n,i,o,s,r="",a="",l="",u=0;do{i=(t=e[u++])>>2,o=(3&t)<<4|(n=e[u++])>>4,s=(15&n)<<2|(a=e[u++])>>6,l=63&a,isNaN(n)?s=l=64:isNaN(a)&&(l=64),r=r+this.KEY_STR.charAt(i)+this.KEY_STR.charAt(o)+this.KEY_STR.charAt(s)+this.KEY_STR.charAt(l),t=n=a="",i=o=s=l=""}while(u<e.length);return r},restore:function(e,t){if(!e.match("data:image/jpeg;base64,"))return t;var n=this.decode64(e.replace("data:image/jpeg;base64,","")),i=this.slice2Segments(n),o=this.exifManipulation(t,i);return"data:image/jpeg;base64,"+this.encode64(o)},exifManipulation:function(e,t){var n=this.getExifArray(t),i=this.insertExif(e,n);return new Uint8Array(i)},getExifArray:function(e){for(var t,n=0;n<e.length;n++)if(255==(t=e[n])[0]&225==t[1])return t;return[]},insertExif:function(e,t){var n=e.replace("data:image/jpeg;base64,",""),i=this.decode64(n),o=i.indexOf(255,3),s=i.slice(0,o),r=i.slice(o),a=s;return a=(a=a.concat(t)).concat(r)},slice2Segments:function(e){for(var t=0,n=[];!(255==e[t]&218==e[t+1]);){if(255==e[t]&216==e[t+1])t+=2;else{var i=t+(256*e[t+2]+e[t+3])+2,o=e.slice(t,i);n.push(o),t=i}if(t>e.length)break}return n},decode64:function(e){var t,n,i,o,s="",r="",a=0,l=[];if(/[^A-Za-z0-9\+\/\=]/g.exec(e))throw new Error("There were invalid base64 characters in the input text.  Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='");e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=this.KEY_STR.indexOf(e.charAt(a++))<<2|(i=this.KEY_STR.indexOf(e.charAt(a++)))>>4,n=(15&i)<<4|(o=this.KEY_STR.indexOf(e.charAt(a++)))>>2,s=(3&o)<<6|(r=this.KEY_STR.indexOf(e.charAt(a++))),l.push(t),64!=o&&l.push(n),64!=r&&l.push(s),t=n=s="",i=o=r=""}while(a<e.length);return l}},ExifRestorer),qq.TotalProgress=function(e,t){"use strict";var n={},i=0,o=0,s=-1,r=-1,a=function(t,n){t===s&&n===r||e(t,n),s=t,r=n},l=function(e){var i=t(e);i>0&&(u(e,0,i),n[e]={loaded:0,total:i})},u=function(e,t,s){var r=n[e]?n[e].loaded:0,l=n[e]?n[e].total:0;-1===t&&-1===s?(i-=r,o-=l):(t&&(i+=t-r),s&&(o+=s-l)),a(i,o)};qq.extend(this,{onAllComplete:function(e,t,n){(0===t.length||function(e,t){var n=!0;return qq.each(e,function(e,i){if(qq.indexOf(t,i)>=0)return n=!1,!1}),n}(t,n))&&(a(o,o),this.reset())},onStatusChange:function(e,t,i){i===qq.status.CANCELED||i===qq.status.REJECTED?function(e){u(e,-1,-1),delete n[e]}(e):i===qq.status.SUBMITTING&&l(e)},onIndividualProgress:function(e,t,i){u(e,t,i),n[e]={loaded:t,total:i}},onNewSize:function(e){l(e)},reset:function(){n={},i=0,o=0}})},qq.PasteSupport=function(e){"use strict";var t,n;t={targetElement:null,callbacks:{log:function(e,t){},pasteReceived:function(e){}}},qq.extend(t,e),n=qq(t.targetElement).attach("paste",function(e){var n=e.clipboardData;n&&qq.each(n.items,function(e,n){if(function(e){return e.type&&0===e.type.indexOf("image/")}(n)){var i=n.getAsFile();t.callbacks.pasteReceived(i)}})}),qq.extend(this,{reset:function(){n&&n()}})},qq.FormSupport=function(e,t,n){"use strict";var i=this,o=e.interceptSubmit,s=e.element,r=e.autoUpload;function a(e,t){if(!e.checkValidity||e.checkValidity())return!0;n("Form did not pass validation checks - will not upload.","error"),t()}qq.extend(this,{newEndpoint:null,newAutoUpload:r,attachedToForm:!1,getFormInputsAsObject:function(){return null==s?null:i._form2Obj(s)}}),s=function(e){return e&&(qq.isString(e)&&(e=document.getElementById(e)),e&&(n("Attaching to form element."),function(e){e.getAttribute("action")&&(i.newEndpoint=e.getAttribute("action"))}(e),o&&function(e){var n=e.submit;qq(e).attach("submit",function(i){(i=i||window.event).preventDefault?i.preventDefault():i.returnValue=!1,a(e,n)&&t()}),e.submit=function(){a(e,n)&&t()}}(e))),e}(s),this.attachedToForm=!!s},qq.extend(qq.FormSupport.prototype,{_form2Obj:function(e){"use strict";var t={},n=function(e){return t=e.type,qq.indexOf(["checkbox","radio"],t.toLowerCase())>=0&&!e.checked||e.disabled&&"hidden"!==e.type.toLowerCase();var t};return qq.each(e.elements,function(e,i){if((qq.isInput(i,!0)||"textarea"===i.tagName.toLowerCase())&&(s=i.type,qq.indexOf(["button","image","reset","submit"],s.toLowerCase())<0)&&!n(i))t[i.name]=i.value;else if("select"===i.tagName.toLowerCase()&&!n(i)){var o=function(e){var t=null;return qq.each(qq(e).children(),function(e,n){if("option"===n.tagName.toLowerCase()&&n.selected)return t=n.value,!1}),t}(i);null!==o&&(t[i.name]=o)}var s}),t}}),qq.traditional=qq.traditional||{},qq.traditional.FormUploadHandler=function(e,t){"use strict";var n=this,i=t.getName,o=t.getUuid,s=t.log;this.uploadFile=function(t){var r,a=n.getInput(t),l=n._createIframe(t),u=new qq.Promise;return(r=function(t,s){var r=e.paramsStore.get(t),a="get"===e.method.toLowerCase()?"GET":"POST",l=e.endpointStore.get(t),u=i(t);return r[e.uuidName]=o(t),r[e.filenameParam]=u,n._initFormForUpload({method:a,endpoint:l,params:r,paramsInBody:e.paramsInBody,targetName:s.name})}(t,l)).appendChild(a),n._attachLoadEvent(l,function(i){s("iframe loaded");var o=i||function(e,t){var i,o,r;try{r=(o=t.contentDocument||t.contentWindow.document).body.innerHTML,s("converting iframe's innerHTML to JSON"),s("innerHTML = "+r),r&&r.match(/^<pre/i)&&(r=o.body.firstChild.firstChild.nodeValue),i=n._parseJsonResponse(r)}catch(e){s("Error when attempting to parse form upload response ("+e.message+")","error"),i={success:!1}}return i}(0,l);n._detachLoadEvent(t),e.cors.expected||qq(l).remove(),o.success?u.success(o):u.failure(o)}),s("Sending upload request for "+t),r.submit(),qq(r).remove(),u},qq.extend(this,new qq.FormUploadHandler({options:{isCors:e.cors.expected,inputName:e.inputName},proxy:{onCancel:e.onCancel,getName:i,getUuid:o,log:s}}))},qq.traditional=qq.traditional||{},qq.traditional.XhrUploadHandler=function(e,t){"use strict";var n=this,i=t.getName,o=t.getSize,s=t.getUuid,r=t.log,a=e.forceMultipart||e.paramsInBody,l=new qq.traditional.AllChunksDoneAjaxRequester({cors:e.cors,endpoint:e.chunking.success.endpoint,headers:e.chunking.success.headers,jsonPayload:e.chunking.success.jsonPayload,log:r,method:e.chunking.success.method,params:e.chunking.success.params}),u=function(e,t){var n=new qq.Promise;return t.onreadystatechange=function(){if(4===t.readyState){var i=d(e,t);i.success?n.success(i.response,t):n.failure(i.response,t)}},n},c=function(t,n){return qq.indexOf([200,201,202,203,204],t.status)<0||e.requireSuccessJson&&!n.success||n.reset},d=function(e,t){var n;return r("xhr - server response received for "+e),r("responseText = "+t.responseText),n=p(!0,t),{success:!c(t,n),response:n}},p=function(t,n){var i={};try{r(qq.format("Received response status {} with body: {}",n.status,n.responseText)),i=qq.parseJson(n.responseText)}catch(n){t&&e.requireSuccessJson&&r("Error when attempting to parse xhr response text ("+n.message+")","error")}return i},h=function(t){var r=new qq.Promise;return l.complete(t,n._createXhr(t),function(t){var r=e.paramsStore.get(t),a=i(t),l=o(t);return r[e.uuidName]=s(t),r[e.filenameParam]=a,r[e.totalFileSizeName]=l,r[e.chunking.paramNames.totalParts]=n._getTotalChunks(t),r}(t),e.customHeaders.get(t)).then(function(e){r.success(p(!1,e),e)},function(e){r.failure(p(!1,e),e)}),r},f=function(t){var n,r=t.fileOrBlob,l=t.id,u=t.xhr,c=t.xhrOverrides||{},d=t.customParams||{},p=t.params||{},h=c.params||{},f=a?new FormData:null,g=c.method||e.method,m=c.endpoint||e.endpointStore.get(l),q=i(l),v=o(l);return e.omitDefaultParams?(n=qq.extend({},d),qq.extend(n,h)):(n=qq.extend({},d),qq.extend(n,h),qq.extend(n,p),n[e.uuidName]=s(l),n[e.filenameParam]=q,a?n[e.totalFileSizeName]=v:e.paramsInBody||(n[e.inputName]=q)),e.paramsInBody||(m=qq.obj2url(n,m)),u.open(g,m,!0),e.cors.expected&&e.cors.sendCredentials&&(u.withCredentials=!0),a?(e.paramsInBody&&qq.obj2FormData(n,f),f.append(e.inputName,r),f):r},g=function(t){var i=t.headerOverrides,o=t.id,s=t.xhr;if(i)qq.each(i,function(e,t){s.setRequestHeader(e,t)});else{var r=e.customHeaders.get(o),l=n.getFile(o);s.setRequestHeader("Accept","application/json"),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Cache-Control","no-cache"),a||(s.setRequestHeader("Content-Type","application/octet-stream"),s.setRequestHeader("X-Mime-Type",l.type)),qq.each(r,function(e,t){s.setRequestHeader(e,t)})}};qq.extend(this,{uploadChunk:function(t){var s,r,l,c=t.id,d=t.chunkIdx,p=t.overrides||{},h=t.resuming,m=n._getChunkData(c,d),q=n._createXhr(c,d),v={};return s=u(c,q),n._registerProgressHandler(c,d,m.size),l=e.paramsStore.get(c),function(t,n,s){var r=o(t),l=i(t);e.omitDefaultParams||(n[e.chunking.paramNames.partIndex]=s.part,n[e.chunking.paramNames.partByteOffset]=s.start,n[e.chunking.paramNames.chunkSize]=s.size,n[e.chunking.paramNames.totalParts]=s.count,n[e.totalFileSizeName]=r),a&&!e.omitDefaultParams&&(n[e.filenameParam]=l)}(c,v,m),h&&(v[e.resume.paramNames.resuming]=!0),r=f({fileOrBlob:m.blob,id:c,customParams:l,params:v,xhr:q,xhrOverrides:p}),g({headerOverrides:p.headers,id:c,xhr:q}),q.send(r),s},uploadFile:function(t){var i,o,s,r,a=n.getFile(t);return o=n._createXhr(t),n._registerProgressHandler(t),i=u(t,o),s=e.paramsStore.get(t),r=f({fileOrBlob:a,id:t,customParams:s,xhr:o}),g({id:t,xhr:o}),o.send(r),i}}),qq.extend(this,new qq.XhrUploadHandler({options:qq.extend({namespace:"traditional"},e),proxy:qq.extend({getEndpoint:e.endpointStore.get},t)})),qq.override(this,function(n){return{finalizeChunks:function(i){return t.onFinalizing(i),e.chunking.success.endpoint?h(i):n.finalizeChunks(i,qq.bind(p,this,!0))}}})},qq.traditional.AllChunksDoneAjaxRequester=function(e){"use strict";var t,n={cors:{allowXdr:!1,expected:!1,sendCredentials:!1},endpoint:null,log:function(e,t){},method:"POST"},i={},o={get:function(e){return qq.isFunction(n.endpoint)?n.endpoint(e):n.endpoint}};qq.extend(n,e),t=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",contentType:n.jsonPayload?"application/json":"application/x-www-form-urlencoded",validMethods:[n.method],method:n.method,endpointStore:o,allowXRequestedWithAndCacheControl:!1,cors:n.cors,log:n.log,onComplete:function(e,t,n){var o=i[e];delete i[e],n?o.failure(t):o.success(t)}})),qq.extend(this,{complete:function(e,o,s,r){var a=new qq.Promise;return n.log("Submitting All Chunks Done request for "+e),i[e]=a,t.initTransport(e).withParams(n.params(e)||s).withHeaders(n.headers(e)||r).send(o),a}})},qq.DragAndDrop=function(e){"use strict";var t,n,i,o="qq-hidezones",s="qq-hide-dropzone",r=[],a=[],l=new qq.DisposeSupport;function u(e){var n=new qq.Promise;return e.isFile?e.file(function(t){t.qqPath=c(e),a.push(t),n.success()},function(i){t.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+i.code+".","error"),n.failure()}):e.isDirectory&&function e(t,n,i,o){var s=o||new qq.Promise,r=n||t.createReader();r.readEntries(function(n){var o=i?i.concat(n):n;n.length?setTimeout(function(){e(t,r,o,s)},0):s.success(o)},s.failure);return s}(e).then(function(e){var t=e.length;qq.each(e,function(e,i){u(i).done(function(){0===(t-=1)&&n.success()})}),e.length||n.success()},function(i){t.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+i.code+".","error"),n.failure()}),n}function c(e){var t=e.name,n=e.fullPath,i=n.lastIndexOf(t);return"/"===(n=n.substr(0,i)).charAt(0)&&(n=n.substr(1)),n}function d(e){var n=new qq.UploadDropZone({HIDE_ZONES_EVENT_NAME:o,element:e,onEnter:function(n){qq(e).addClass(t.classes.dropActive),n.stopPropagation()},onLeaveNotDescendants:function(n){qq(e).removeClass(t.classes.dropActive)},onDrop:function(e){var i,o,s,r;(i=e.dataTransfer,o=n,s=[],r=new qq.Promise,t.callbacks.processingDroppedFiles(),o.dropDisabled(!0),i.files.length>1&&!t.allowMultipleItems?(t.callbacks.processingDroppedFilesComplete([]),t.callbacks.dropError("tooManyFilesError",""),o.dropDisabled(!1),r.failure()):(a=[],qq.isFolderDropSupported(i)?qq.each(i.items,function(e,t){var n=t.webkitGetAsEntry();n&&(n.isFile?a.push(t.getAsFile()):s.push(u(n).done(function(){s.pop(),0===s.length&&r.success()})))}):a=i.files,0===s.length&&r.success()),r).then(function(){var e,i,o;e=a,i=n,o=Array.prototype.slice.call(e),t.callbacks.dropLog("Grabbed "+e.length+" dropped files."),i.dropDisabled(!1),t.callbacks.processingDroppedFilesComplete(o,i.getElement())},function(){t.callbacks.dropLog("Drop event DataTransfer parsing failed.  No files will be uploaded.","error")})}});return l.addDisposer(function(){n.dispose()}),qq(e).hasAttribute(s)&&qq(e).hide(),r.push(n),n}function p(e){var t;return qq.each(e.dataTransfer.types,function(e,n){if("Files"===n)return t=!0,!1}),t}t={dropZoneElements:[],allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks},qq.extend(t,e,!0),n=t.dropZoneElements,i=function(){setTimeout(function(){qq.each(n,function(e,n){qq(n).hasAttribute(s)&&qq(n).hide(),qq(n).removeClass(t.classes.dropActive)})},10)},qq.each(n,function(e,t){var i=d(t);n.length&&qq.supportedFeatures.fileDrop&&l.attach(document,"dragenter",function(e){!i.dropDisabled()&&p(e)&&qq.each(n,function(e,t){t instanceof HTMLElement&&qq(t).hasAttribute(s)&&qq(t).css({display:"block"})})})}),l.attach(document,"dragleave",function(e){(function(e){return qq.safari()?e.x<0||e.y<0:0===e.x&&0===e.y})(e)&&i()}),l.attach(qq(document).children()[0],"mouseenter",function(e){i()}),l.attach(document,"drop",function(e){p(e)&&(e.preventDefault(),i())}),l.attach(document,o,i),qq.extend(this,{setupExtraDropzone:function(e){t.dropZoneElements.push(e),d(e)},removeDropzone:function(e){var n,i=t.dropZoneElements;for(n in i)if(i[n]===e)return i.splice(n,1)},dispose:function(){l.dispose(),qq.each(r,function(e,t){t.dispose()})}}),this._testing={},this._testing.extractDirectoryPath=c},qq.DragAndDrop.callbacks=function(){"use strict";return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(e,t){},dropError:function(e,t){qq.log("Drag & drop error code '"+e+" with these specifics: '"+t+"'","error")},dropLog:function(e,t){qq.log(e,t)}}},qq.UploadDropZone=function(e){"use strict";var t,n,i,o,s=new qq.DisposeSupport;function r(e){if(!qq.supportedFeatures.fileDrop)return!1;var t,n=e.dataTransfer,i=qq.safari();return t=!(!qq.ie()||!qq.supportedFeatures.fileDrop)||"none"!==n.effectAllowed,n&&t&&(n.files&&n.files.length||!i&&n.types.contains&&n.types.contains("Files")||n.types.includes&&n.types.includes("Files"))}function a(e){return void 0!==e&&(i=e),i}t={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}},qq.extend(t,e),n=t.element,o||(function(){return qq.safari()||qq.firefox()&&qq.windows()}?s.attach(document,"dragover",function(e){e.preventDefault()}):s.attach(document,"dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),o=!0),s.attach(n,"dragover",function(e){if(r(e)){var t=qq.ie()&&qq.supportedFeatures.fileDrop?null:e.dataTransfer.effectAllowed;e.dataTransfer.dropEffect="move"===t||"linkMove"===t?"move":"copy",e.stopPropagation(),e.preventDefault()}}),s.attach(n,"dragenter",function(e){if(!a()){if(!r(e))return;t.onEnter(e)}}),s.attach(n,"dragleave",function(e){if(r(e)){t.onLeave(e);var n=document.elementFromPoint(e.clientX,e.clientY);qq(this).contains(n)||t.onLeaveNotDescendants(e)}}),s.attach(n,"drop",function(e){if(!a()){if(!r(e))return;e.preventDefault(),e.stopPropagation(),t.onDrop(e),function(){var e;function n(){(e=document.createEvent("Event")).initEvent(t.HIDE_ZONES_EVENT_NAME,!0,!0)}if(window.CustomEvent)try{e=new CustomEvent(t.HIDE_ZONES_EVENT_NAME)}catch(e){n()}else n();document.dispatchEvent(e)}()}}),qq.extend(this,{dropDisabled:function(e){return a(e)},dispose:function(){s.dispose()},getElement:function(){return n}}),this._testing={},this._testing.isValidFileDrag=r},function(){"use strict";qq.uiPublicApi={addInitialFiles:function(e){this._parent.prototype.addInitialFiles.apply(this,arguments),this._templating.addCacheToDom()},clearStoredFiles:function(){this._parent.prototype.clearStoredFiles.apply(this,arguments),this._templating.clearFiles()},addExtraDropzone:function(e){this._dnd&&this._dnd.setupExtraDropzone(e)},removeExtraDropzone:function(e){if(this._dnd)return this._dnd.removeDropzone(e)},getItemByFileId:function(e){if(!this._templating.isHiddenForever(e))return this._templating.getFileContainer(e)},reset:function(){this._parent.prototype.reset.apply(this,arguments),this._templating.reset(),!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton(),title:this._options.text.fileInputTitle}).getButtonId()),this._dnd&&(this._dnd.dispose(),this._dnd=this._setupDragAndDrop()),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0,this._setupClickAndEditEventHandlers()},setName:function(e,t){var n=this._options.formatFileName(t);this._parent.prototype.setName.apply(this,arguments),this._templating.updateFilename(e,n)},pauseUpload:function(e){var t=this._parent.prototype.pauseUpload.apply(this,arguments);return t&&this._templating.uploadPaused(e),t},continueUpload:function(e){var t=this._parent.prototype.continueUpload.apply(this,arguments);return t&&this._templating.uploadContinued(e),t},getId:function(e){return this._templating.getFileId(e)},getDropTarget:function(e){return this.getFile(e).qqDropTarget}},qq.uiPrivateApi={_getButton:function(e){var t=this._parent.prototype._getButton.apply(this,arguments);return t||e===this._defaultButtonId&&(t=this._templating.getButton()),t},_removeFileItem:function(e){this._templating.removeFile(e)},_setupClickAndEditEventHandlers:function(){this._fileButtonsClickHandler=qq.FileButtonsClickHandler&&this._bindFileButtonsClickEvent(),this._focusinEventSupported=!qq.firefox(),this._isEditFilenameEnabled()&&(this._filenameClickHandler=this._bindFilenameClickEvent(),this._filenameInputFocusInHandler=this._bindFilenameInputFocusInEvent(),this._filenameInputFocusHandler=this._bindFilenameInputFocusEvent())},_setupDragAndDrop:function(){var e=this,t=this._options.dragAndDrop.extraDropzones,n=this._templating,i=n.getDropZone();return i&&t.push(i),new qq.DragAndDrop({dropZoneElements:t,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){n.showDropProcessing()},processingDroppedFilesComplete:function(t,i){n.hideDropProcessing(),qq.each(t,function(e,t){t.qqDropTarget=i}),t.length&&e.addFiles(t,null,null)},dropError:function(t,n){e._itemError(t,n)},dropLog:function(t,n){e.log(t,n)}}})},_bindFileButtonsClickEvent:function(){var e=this;return new qq.FileButtonsClickHandler({templating:this._templating,log:function(t,n){e.log(t,n)},onDeleteFile:function(t){e.deleteFile(t)},onCancel:function(t){e.cancel(t)},onRetry:function(t){e.retry(t)},onPause:function(t){e.pauseUpload(t)},onContinue:function(t){e.continueUpload(t)},onGetName:function(t){return e.getName(t)}})},_isEditFilenameEnabled:function(){return this._templating.isEditFilenamePossible()&&!this._options.autoUpload&&qq.FilenameClickHandler&&qq.FilenameInputFocusHandler&&qq.FilenameInputFocusHandler},_filenameEditHandler:function(){var e=this,t=this._templating;return{templating:t,log:function(t,n){e.log(t,n)},onGetUploadStatus:function(t){return e.getUploads({id:t}).status},onGetName:function(t){return e.getName(t)},onSetName:function(t,n){e.setName(t,n)},onEditingStatusChange:function(e,n){var i=qq(t.getEditInput(e)),o=qq(t.getFileContainer(e));n?(i.addClass("qq-editing"),t.hideFilename(e),t.hideEditIcon(e)):(i.removeClass("qq-editing"),t.showFilename(e),t.showEditIcon(e)),o.addClass("qq-temp").removeClass("qq-temp")}}},_onUploadStatusChange:function(e,t,n){this._parent.prototype._onUploadStatusChange.apply(this,arguments),this._isEditFilenameEnabled()&&this._templating.getFileContainer(e)&&n!==qq.status.SUBMITTED&&(this._templating.markFilenameEditable(e),this._templating.hideEditIcon(e)),t===qq.status.UPLOAD_RETRYING&&n===qq.status.UPLOADING?(this._templating.hideRetry(e),this._templating.setStatusText(e),qq(this._templating.getFileContainer(e)).removeClass(this._classes.retrying)):n===qq.status.UPLOAD_FAILED&&this._templating.hidePause(e)},_bindFilenameInputFocusInEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusInHandler(e)},_bindFilenameInputFocusEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusHandler(e)},_bindFilenameClickEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameClickHandler(e)},_storeForLater:function(e){this._parent.prototype._storeForLater.apply(this,arguments),this._templating.hideSpinner(e)},_onAllComplete:function(e,t){this._parent.prototype._onAllComplete.apply(this,arguments),this._templating.resetTotalProgress()},_onSubmit:function(e,t){var n=this.getFile(e);n&&n.qqPath&&this._options.dragAndDrop.reportDirectoryPaths&&this._paramsStore.addReadOnly(e,{qqpath:n.qqPath}),this._parent.prototype._onSubmit.apply(this,arguments),this._addToList(e,t)},_onSubmitted:function(e){this._isEditFilenameEnabled()&&(this._templating.markFilenameEditable(e),this._templating.showEditIcon(e),this._focusinEventSupported||this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(e)))},_onProgress:function(e,t,n,i){this._parent.prototype._onProgress.apply(this,arguments),this._templating.updateProgress(e,n,i),0===i||100===Math.round(n/i*100)?(this._templating.hideCancel(e),this._templating.hidePause(e),this._templating.hideProgress(e),this._templating.setStatusText(e,this._options.text.waitingForResponse),this._displayFileSize(e)):this._displayFileSize(e,n,i)},_onTotalProgress:function(e,t){this._parent.prototype._onTotalProgress.apply(this,arguments),this._templating.updateTotalProgress(e,t)},_onComplete:function(e,t,n,i){var o=this._parent.prototype._onComplete.apply(this,arguments),s=this._templating,r=s.getFileContainer(e),a=this;function l(t){r&&(s.setStatusText(e),qq(r).removeClass(a._classes.retrying),s.hideProgress(e),a.getUploads({id:e}).status!==qq.status.UPLOAD_FAILED&&s.hideCancel(e),s.hideSpinner(e),t.success?a._markFileAsSuccessful(e):(qq(r).addClass(a._classes.fail),s.showCancel(e),s.isRetryPossible()&&!a._preventRetries[e]&&(qq(r).addClass(a._classes.retryable),s.showRetry(e)),a._controlFailureTextDisplay(e,t)))}return o instanceof qq.Promise?o.done(function(e){l(e)}):l(n),o},_markFileAsSuccessful:function(e){var t=this._templating;this._isDeletePossible()&&t.showDeleteButton(e),qq(t.getFileContainer(e)).addClass(this._classes.success),this._maybeUpdateThumbnail(e)},_onUploadPrep:function(e){this._parent.prototype._onUploadPrep.apply(this,arguments),this._templating.showSpinner(e)},_onUpload:function(e,t){var n=this._parent.prototype._onUpload.apply(this,arguments);return this._templating.showSpinner(e),n},_onUploadChunk:function(e,t){this._parent.prototype._onUploadChunk.apply(this,arguments),t.partIndex>0&&this._handler.isResumable(e)&&this._templating.allowPause(e)},_onCancel:function(e,t){this._parent.prototype._onCancel.apply(this,arguments),this._removeFileItem(e),0===this._getNotFinished()&&this._templating.resetTotalProgress()},_onBeforeAutoRetry:function(e){var t,n,i;this._parent.prototype._onBeforeAutoRetry.apply(this,arguments),this._showCancelLink(e),this._options.retry.showAutoRetryNote&&(t=this._autoRetries[e],n=this._options.retry.maxAutoAttempts,i=(i=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,t)).replace(/\{maxAuto\}/g,n),this._templating.setStatusText(e,i),qq(this._templating.getFileContainer(e)).addClass(this._classes.retrying))},_onBeforeManualRetry:function(e){return this._parent.prototype._onBeforeManualRetry.apply(this,arguments)?(this._templating.resetProgress(e),qq(this._templating.getFileContainer(e)).removeClass(this._classes.fail),this._templating.setStatusText(e),this._templating.showSpinner(e),this._showCancelLink(e),!0):(qq(this._templating.getFileContainer(e)).addClass(this._classes.retryable),this._templating.showRetry(e),!1)},_onSubmitDelete:function(e){var t=qq.bind(this._onSubmitDeleteSuccess,this);this._parent.prototype._onSubmitDelete.call(this,e,t)},_onSubmitDeleteSuccess:function(e,t,n){this._options.deleteFile.forceConfirm?this._showDeleteConfirm.apply(this,arguments):this._sendDeleteRequest.apply(this,arguments)},_onDeleteComplete:function(e,t,n){this._parent.prototype._onDeleteComplete.apply(this,arguments),this._templating.hideSpinner(e),n?(this._templating.setStatusText(e,this._options.deleteFile.deletingFailedText),this._templating.showDeleteButton(e)):this._removeFileItem(e)},_sendDeleteRequest:function(e,t,n){this._templating.hideDeleteButton(e),this._templating.showSpinner(e),this._templating.setStatusText(e,this._options.deleteFile.deletingStatusText),this._deleteHandler.sendDelete.apply(this,arguments)},_showDeleteConfirm:function(e,t,n){var i,o=this.getName(e),s=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,o),r=(t=this.getUuid(e),arguments),a=this;i=this._options.showConfirm(s),qq.isGenericPromise(i)?i.then(function(){a._sendDeleteRequest.apply(a,r)}):!1!==i&&a._sendDeleteRequest.apply(a,r)},_addToList:function(e,t,n){var i,o,s=0,r=this._handler.isProxied(e)&&this._options.scaling.hideScaled;this._options.display.prependFiles&&(this._totalFilesInBatch>1&&this._filesInBatchAddedToUi>0&&(s=this._filesInBatchAddedToUi-1),i={index:s}),n||(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading&&this._templating.disableCancel(),this._options.multiple||(o=this.getUploads({id:e}),this._handledProxyGroup=this._handledProxyGroup||o.proxyGroupId,o.proxyGroupId===this._handledProxyGroup&&o.proxyGroupId||(this._handler.cancelAll(),this._clearList(),this._handledProxyGroup=null))),n?(this._templating.addFileToCache(e,this._options.formatFileName(t),i,r),this._templating.updateThumbnail(e,this._thumbnailUrls[e],!0,this._options.thumbnails.customResizer)):(this._templating.addFile(e,this._options.formatFileName(t),i,r),this._templating.generatePreview(e,this.getFile(e),this._options.thumbnails.customResizer)),this._filesInBatchAddedToUi+=1,(n||this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading)&&this._displayFileSize(e)},_clearList:function(){this._templating.clearFiles(),this.clearStoredFiles()},_displayFileSize:function(e,t,n){var i=this.getSize(e),o=this._formatSize(i);i>=0&&(void 0!==t&&void 0!==n&&(o=this._formatProgress(t,n)),this._templating.updateSize(e,o))},_formatProgress:function(e,t){var n=this._options.text.formatProgress;function i(e,t){n=n.replace(e,t)}return i("{percent}",Math.round(e/t*100)),i("{total_size}",this._formatSize(t)),n},_controlFailureTextDisplay:function(e,t){var n,i,o;n=this._options.failedUploadTextDisplay.mode,i=this._options.failedUploadTextDisplay.responseProperty,"custom"===n?((o=t[i])||(o=this._options.text.failUpload),this._templating.setStatusText(e,o),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(e,o)):"default"===n?this._templating.setStatusText(e,this._options.text.failUpload):"none"!==n&&this.log("failedUploadTextDisplay.mode value of '"+n+"' is not valid","warn")},_showTooltip:function(e,t){this._templating.getFileContainer(e).title=t},_showCancelLink:function(e){this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading||this._templating.showCancel(e)},_itemError:function(e,t,n){var i=this._parent.prototype._itemError.apply(this,arguments);this._options.showMessage(i)},_batchError:function(e){this._parent.prototype._batchError.apply(this,arguments),this._options.showMessage(e)},_setupPastePrompt:function(){var e=this;this._options.callbacks.onPasteReceived=function(){var t=e._options.paste.namePromptMessage,n=e._options.paste.defaultName;return e._options.showPrompt(t,n)}},_fileOrBlobRejected:function(e,t){this._totalFilesInBatch-=1,this._parent.prototype._fileOrBlobRejected.apply(this,arguments)},_prepareItemsForUpload:function(e,t,n){this._totalFilesInBatch=e.length,this._filesInBatchAddedToUi=0,this._parent.prototype._prepareItemsForUpload.apply(this,arguments)},_maybeUpdateThumbnail:function(e){var t=this._thumbnailUrls[e];this.getUploads({id:e}).status===qq.status.DELETED||!t&&!this._options.thumbnails.placeholders.waitUntilResponse&&qq.supportedFeatures.imagePreviews||this._templating.updateThumbnail(e,t,this._options.thumbnails.customResizer)},_addCannedFile:function(e){var t=this._parent.prototype._addCannedFile.apply(this,arguments);return this._addToList(t,this.getName(t),!0),this._templating.hideSpinner(t),this._templating.hideCancel(t),this._markFileAsSuccessful(t),t},_setSize:function(e,t){this._parent.prototype._setSize.apply(this,arguments),this._templating.updateSize(e,this._formatSize(t))},_sessionRequestComplete:function(){this._templating.addCacheToDom(),this._parent.prototype._sessionRequestComplete.apply(this,arguments)}}}(),qq.FineUploader=function(e,t){"use strict";var n=this;this._parent=t?qq[t].FineUploaderBasic:qq.FineUploaderBasic,this._parent.apply(this,arguments),qq.extend(this._options,{element:null,button:null,listElement:null,dragAndDrop:{extraDropzones:[],reportDirectoryPaths:!1},text:{formatProgress:"{percent}% of {total_size}",failUpload:"Upload failed",waitingForResponse:"Processing...",paused:"Paused"},template:"qq-template",classes:{retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",success:"qq-upload-success",fail:"qq-upload-fail",editable:"qq-editable",hide:"qq-hide",dropActive:"qq-upload-drop-area-active"},failedUploadTextDisplay:{mode:"default",responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}..."},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1,prependFiles:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},thumbnails:{customResizer:null,maxCount:0,placeholders:{waitUntilResponse:!1,notAvailablePath:null,waitingPath:null},timeBetweenThumbs:750},scaling:{hideScaled:!1},showMessage:function(e){if(n._templating.hasDialog("alert"))return n._templating.showDialog("alert",e);setTimeout(function(){window.alert(e)},0)},showConfirm:function(e){return n._templating.hasDialog("confirm")?n._templating.showDialog("confirm",e):window.confirm(e)},showPrompt:function(e,t){return n._templating.hasDialog("prompt")?n._templating.showDialog("prompt",e,t):window.prompt(e,t)}},!0),qq.extend(this._options,e,!0),this._templating=new qq.Templating({log:qq.bind(this.log,this),templateIdOrEl:this._options.template,containerEl:this._options.element,fileContainerEl:this._options.listElement,button:this._options.button,imageGenerator:this._imageGenerator,classes:{hide:this._options.classes.hide,editable:this._options.classes.editable},limits:{maxThumbs:this._options.thumbnails.maxCount,timeBetweenThumbs:this._options.thumbnails.timeBetweenThumbs},placeholders:{waitUntilUpdate:this._options.thumbnails.placeholders.waitUntilResponse,thumbnailNotAvailable:this._options.thumbnails.placeholders.notAvailablePath,waitingForThumbnail:this._options.thumbnails.placeholders.waitingPath},text:this._options.text}),this._options.workarounds.ios8SafariUploads&&qq.ios800()&&qq.iosSafari()?this._templating.renderFailure(this._options.messages.unsupportedBrowserIos8Safari):!qq.supportedFeatures.uploading||this._options.cors.expected&&!qq.supportedFeatures.uploadCors?this._templating.renderFailure(this._options.messages.unsupportedBrowser):(this._wrapCallbacks(),this._templating.render(),this._classes=this._options.classes,!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton(),title:this._options.text.fileInputTitle}).getButtonId()),this._setupClickAndEditEventHandlers(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop&&(this._dnd=this._setupDragAndDrop()),this._options.paste.targetElement&&this._options.paste.promptForName&&(qq.PasteSupport?this._setupPastePrompt():this.log("Paste support module not found.","error")),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0)},qq.extend(qq.FineUploader.prototype,qq.basePublicApi),qq.extend(qq.FineUploader.prototype,qq.basePrivateApi),qq.extend(qq.FineUploader.prototype,qq.uiPublicApi),qq.extend(qq.FineUploader.prototype,qq.uiPrivateApi),qq.Templating=function(e){"use strict";var t,n,i,o,s,r,a,l,u={content:document.createDocumentFragment(),map:{}},c=!1,d=0,p=!1,h=[],f=-1,g={log:null,limits:{maxThumbs:0,timeBetweenThumbs:750},templateIdOrEl:"qq-template",containerEl:null,fileContainerEl:null,button:null,imageGenerator:null,classes:{hide:"qq-hide",editable:"qq-editable"},placeholders:{waitUntilUpdate:!1,thumbnailNotAvailable:null,waitingForThumbnail:null},text:{paused:"Paused"}},m={button:"qq-upload-button-selector",alertDialog:"qq-alert-dialog-selector",dialogCancelButton:"qq-cancel-button-selector",confirmDialog:"qq-confirm-dialog-selector",dialogMessage:"qq-dialog-message-selector",dialogOkButton:"qq-ok-button-selector",promptDialog:"qq-prompt-dialog-selector",uploader:"qq-uploader-selector",drop:"qq-upload-drop-area-selector",list:"qq-upload-list-selector",progressBarContainer:"qq-progress-bar-container-selector",progressBar:"qq-progress-bar-selector",totalProgressBarContainer:"qq-total-progress-bar-container-selector",totalProgressBar:"qq-total-progress-bar-selector",file:"qq-upload-file-selector",spinner:"qq-upload-spinner-selector",size:"qq-upload-size-selector",cancel:"qq-upload-cancel-selector",pause:"qq-upload-pause-selector",continueButton:"qq-upload-continue-selector",deleteButton:"qq-upload-delete-selector",retry:"qq-upload-retry-selector",statusText:"qq-upload-status-text-selector",editFilenameInput:"qq-edit-filename-selector",editNameIcon:"qq-edit-filename-icon-selector",dropText:"qq-upload-drop-area-text-selector",dropProcessing:"qq-drop-processing-selector",dropProcessingSpinner:"qq-drop-processing-spinner-selector",thumbnail:"qq-thumbnail-selector"},q={},v=new qq.Promise,_=new qq.Promise,b=function(e){var t=new qq.Promise;return _.then(function(n){L(n,e),e.src?t.success():(e.src=n.src,e.onload=function(){e.onload=null,j(e),t.success()})},function(){B(e),t.success()}),t},y=function(){if(h.length){p=!0;var e=h.shift();e.update?H(e):z(e)}else p=!1},w=function(e){return R(E(e),m.cancel)},x=function(e){return R(E(e),m.continueButton)},S=function(e){return R(s,m[e+"Dialog"])},C=function(e){return R(E(e),m.deleteButton)},F=function(){return R(s,m.dropProcessing)},I=function(e){return R(E(e),m.editNameIcon)},E=function(e){return u.map[e]||qq(r).getFirstByClass("qq-file-id-"+e)},D=function(e){return R(E(e),m.file)},O=function(e){return R(E(e),m.pause)},T=function(e){return null==e?R(s,m.totalProgressBarContainer)||R(s,m.totalProgressBar):R(E(e),m.progressBarContainer)||R(E(e),m.progressBar)},k=function(e){return R(E(e),m.retry)},P=function(e){return R(E(e),m.size)},A=function(e){return R(E(e),m.spinner)},R=function(e,t){return e&&qq(e).getFirstByClass(t)},U=function(e){return a&&R(E(e),m.thumbnail)},B=function(e){e&&qq(e).addClass(g.classes.hide)},L=function(e,t){var n=e.style.maxWidth,i=e.style.maxHeight;i&&n&&!t.style.maxWidth&&!t.style.maxHeight&&qq(t).css({maxWidth:n,maxHeight:i})},N=function(e,t){var n=q[e]||(new qq.Promise).failure(),i=new qq.Promise;return v.then(function(e){n.then(function(){i.success()},function(){L(e,t),t.onload=function(){t.onload=null,i.success()},t.src=e.src,j(t)})}),i},z=function(e){var n=e.id,i=e.optFileOrBlob,o=i&&i.qqThumbnailId,s=U(n),r={customResizeFunction:e.customResizeFunction,maxSize:f,orient:!0,scale:!0};qq.supportedFeatures.imagePreviews?s?g.limits.maxThumbs&&g.limits.maxThumbs<=d?(N(n,s),y()):b(s).done(function(){q[n]=new qq.Promise,q[n].done(function(){setTimeout(y,g.limits.timeBetweenThumbs)}),null!=o?$(n,o):function(e,n,i){var o=U(e);t("Generating new thumbnail for "+e),n.qqThumbnailId=e,g.imageGenerator.generate(n,o,i).then(function(){d++,j(o),q[e].success()},function(){q[e].failure(),g.placeholders.waitUntilUpdate||N(e,o)})}(n,i,r)}):y():s&&(b(s),y())},H=function(e){var t=e.id,n=e.thumbnailUrl,i=e.showWaitingImg,o=U(t),s={customResizeFunction:e.customResizeFunction,scale:l,maxSize:f};if(o)if(n){if(!(g.limits.maxThumbs&&g.limits.maxThumbs<=d))return i&&b(o),g.imageGenerator.generate(n,o,s).then(function(){j(o),d++,setTimeout(y,g.limits.timeBetweenThumbs)},function(){N(t,o),setTimeout(y,g.limits.timeBetweenThumbs)});N(t,o),y()}else N(t,o),y()},M=function(e,t){var n=T(e),i=null==e?m.totalProgressBar:m.progressBar;n&&!qq(n).hasClass(i)&&(n=qq(n).getFirstByClass(i)),n&&(qq(n).css({width:t+"%"}),n.setAttribute("aria-valuenow",t))},j=function(e){e&&qq(e).removeClass(g.classes.hide)},$=function(e,n){var i=U(e),o=U(n);t(qq.format("ID {} is the same file as ID {}.  Will use generated thumbnail from ID {} instead.",e,n,n)),q[n].then(function(){d++,q[e].success(),t(qq.format("Now using previously generated thumbnail created for ID {} on ID {}.",n,e)),i.src=o.src,j(i)},function(){q[e].failure(),g.placeholders.waitUntilUpdate||N(e,i)})};qq.extend(g,e),t=g.log,qq.supportedFeatures.imagePreviews||(g.limits.timeBetweenThumbs=0,g.limits.maxThumbs=0),s=g.containerEl,a=void 0!==g.imageGenerator,o=function(){var e,o,s,r,u,c,d,p,h,q,v;if(t("Parsing template"),null==g.templateIdOrEl)throw new Error("You MUST specify either a template element or ID!");if(qq.isString(g.templateIdOrEl)){if(null===(e=document.getElementById(g.templateIdOrEl)))throw new Error(qq.format("Cannot find template script at ID '{}'!",g.templateIdOrEl));o=e.innerHTML}else{if(void 0===g.templateIdOrEl.innerHTML)throw new Error("You have specified an invalid value for the template option!  It must be an ID or an Element.");o=g.templateIdOrEl.innerHTML}if(o=qq.trimStr(o),(r=document.createElement("div")).appendChild(qq.toElement(o)),v=qq(r).getFirstByClass(m.uploader),g.button&&(c=qq(r).getFirstByClass(m.button))&&qq(c).remove(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop||(h=qq(r).getFirstByClass(m.dropProcessing))&&qq(h).remove(),(d=qq(r).getFirstByClass(m.drop))&&!qq.DragAndDrop&&(t("DnD module unavailable.","info"),qq(d).remove()),qq.supportedFeatures.fileDrop?qq(v).hasAttribute("qq-drop-area-text")&&d&&(q=qq(d).getFirstByClass(m.dropText))&&qq(q).remove():(v.removeAttribute("qq-drop-area-text"),d&&qq(d).hasAttribute("qq-hide-dropzone")&&qq(d).css({display:"none"})),p=qq(r).getFirstByClass(m.thumbnail),a?p&&(f=(f=parseInt(p.getAttribute("qq-max-size")))>0?f:null,l=qq(p).hasAttribute("qq-server-scale")):p&&qq(p).remove(),a=a&&p,n=qq(r).getByClass(m.editFilenameInput).length>0,i=qq(r).getByClass(m.retry).length>0,null==(s=qq(r).getFirstByClass(m.list)))throw new Error("Could not find the file list container in the template!");return u=s.children[0].cloneNode(!0),s.innerHTML="",r.getElementsByTagName("DIALOG").length&&document.createElement("dialog"),t("Template parsing complete"),{template:r,fileTemplate:u}}(),function(){var e=g.placeholders.thumbnailNotAvailable,n=g.placeholders.waitingForThumbnail,i={maxSize:f,scale:l};a&&(e?g.imageGenerator.generate(e,new Image,i).then(function(e){v.success(e)},function(){v.failure(),t("Problem loading 'not available' placeholder image at "+e,"error")}):v.failure(),n?g.imageGenerator.generate(n,new Image,i).then(function(e){_.success(e)},function(){_.failure(),t("Problem loading 'waiting for thumbnail' placeholder image at "+n,"error")}):_.failure())}(),qq.extend(this,{render:function(){t("Rendering template in DOM."),d=0,s.appendChild(o.template.cloneNode(!0)),B(F()),this.hideTotalProgress(),r=g.fileContainerEl||R(s,m.list),t("Template rendering complete")},renderFailure:function(e){var t=qq.toElement(e);s.innerHTML="",s.appendChild(t)},reset:function(){s.innerHTML="",this.render()},clearFiles:function(){r.innerHTML=""},disableCancel:function(){c=!0},addFile:function(e,t,n,i,a){var l,d=o.fileTemplate.cloneNode(!0),p=R(d,m.file),h=R(s,m.uploader),f=a?u.content:r;a&&(u.map[e]=d),qq(d).addClass("qq-file-id-"+e),h.removeAttribute("qq-drop-area-text"),p&&(qq(p).setText(t),p.setAttribute("title",t)),d.setAttribute("qq-file-id",e),n?function(e,t,n){var i=n,o=i.firstChild;t>0&&(o=qq(i).children()[t].nextSibling),i.insertBefore(e,o)}(d,n.index,f):f.appendChild(d),i?(d.style.display="none",qq(d).addClass("qq-hidden-forever")):(B(T(e)),B(P(e)),B(C(e)),B(k(e)),B(O(e)),B(x(e)),c&&this.hideCancel(e),(l=U(e))&&!l.src&&_.then(function(e){l.src=e.src,e.style.maxHeight&&e.style.maxWidth&&qq(l).css({maxHeight:e.style.maxHeight,maxWidth:e.style.maxWidth}),j(l)}))},addFileToCache:function(e,t,n,i){this.addFile(e,t,n,i,!0)},addCacheToDom:function(){r.appendChild(u.content),u.content=document.createDocumentFragment(),u.map={}},removeFile:function(e){qq(E(e)).remove()},getFileId:function(e){var t=e;if(t){for(;null==t.getAttribute("qq-file-id");)t=t.parentNode;return parseInt(t.getAttribute("qq-file-id"))}},getFileList:function(){return r},markFilenameEditable:function(e){var t=D(e);t&&qq(t).addClass(g.classes.editable)},updateFilename:function(e,t){var n=D(e);n&&(qq(n).setText(t),n.setAttribute("title",t))},hideFilename:function(e){B(D(e))},showFilename:function(e){j(D(e))},isFileName:function(e){return qq(e).hasClass(m.file)},getButton:function(){return g.button||R(s,m.button)},hideDropProcessing:function(){B(F())},showDropProcessing:function(){j(F())},getDropZone:function(){return R(s,m.drop)},isEditFilenamePossible:function(){return n},hideRetry:function(e){B(k(e))},isRetryPossible:function(){return i},showRetry:function(e){j(k(e))},getFileContainer:function(e){return E(e)},showEditIcon:function(e){var t=I(e);t&&qq(t).addClass(g.classes.editable)},isHiddenForever:function(e){return qq(E(e)).hasClass("qq-hidden-forever")},hideEditIcon:function(e){var t=I(e);t&&qq(t).removeClass(g.classes.editable)},isEditIcon:function(e){return qq(e).hasClass(m.editNameIcon,!0)},getEditInput:function(e){return R(E(e),m.editFilenameInput)},isEditInput:function(e){return qq(e).hasClass(m.editFilenameInput,!0)},updateProgress:function(e,t,n){var i,o=T(e);o&&n>0&&(100===(i=Math.round(t/n*100))?B(o):j(o),M(e,i))},updateTotalProgress:function(e,t){this.updateProgress(null,e,t)},hideProgress:function(e){var t=T(e);t&&B(t)},hideTotalProgress:function(){this.hideProgress()},resetProgress:function(e){M(e,0),this.hideTotalProgress(e)},resetTotalProgress:function(){this.resetProgress()},showCancel:function(e){if(!c){var t=w(e);t&&qq(t).removeClass(g.classes.hide)}},hideCancel:function(e){B(w(e))},isCancel:function(e){return qq(e).hasClass(m.cancel,!0)},allowPause:function(e){j(O(e)),B(x(e))},uploadPaused:function(e){this.setStatusText(e,g.text.paused),this.allowContinueButton(e),B(A(e))},hidePause:function(e){B(O(e))},isPause:function(e){return qq(e).hasClass(m.pause,!0)},isContinueButton:function(e){return qq(e).hasClass(m.continueButton,!0)},allowContinueButton:function(e){j(x(e)),B(O(e))},uploadContinued:function(e){this.setStatusText(e,""),this.allowPause(e),j(A(e))},showDeleteButton:function(e){j(C(e))},hideDeleteButton:function(e){B(C(e))},isDeleteButton:function(e){return qq(e).hasClass(m.deleteButton,!0)},isRetry:function(e){return qq(e).hasClass(m.retry,!0)},updateSize:function(e,t){var n=P(e);n&&(j(n),qq(n).setText(t))},setStatusText:function(e,t){var n=R(E(e),m.statusText);n&&(null==t?qq(n).clearText():qq(n).setText(t))},hideSpinner:function(e){qq(E(e)).removeClass("qq-in-progress"),B(A(e))},showSpinner:function(e){qq(E(e)).addClass("qq-in-progress"),j(A(e))},generatePreview:function(e,t,n){this.isHiddenForever(e)||(h.push({id:e,customResizeFunction:n,optFileOrBlob:t}),!p&&y())},updateThumbnail:function(e,t,n,i){this.isHiddenForever(e)||(h.push({customResizeFunction:i,update:!0,id:e,thumbnailUrl:t,showWaitingImg:n}),!p&&y())},hasDialog:function(e){return qq.supportedFeatures.dialogElement&&!!S(e)},showDialog:function(e,t,n){var i=S(e),o=R(i,m.dialogMessage),s=i.getElementsByTagName("INPUT")[0],r=R(i,m.dialogCancelButton),a=R(i,m.dialogOkButton),l=new qq.Promise,u=function(){r.removeEventListener("click",c),a&&a.removeEventListener("click",d),l.failure()},c=function(){r.removeEventListener("click",c),i.close()},d=function(){i.removeEventListener("close",u),a.removeEventListener("click",d),i.close(),l.success(s&&s.value)};return i.addEventListener("close",u),r.addEventListener("click",c),a&&a.addEventListener("click",d),s&&(s.value=n),o.textContent=t,i.showModal(),l}})},qq.UiEventHandler=function(e,t){"use strict";var n=new qq.DisposeSupport,i={eventType:"click",attachTo:null,onHandled:function(e,t){}};function o(e){n.attach(e,i.eventType,function(e){var t=(e=e||window.event).target||e.srcElement;i.onHandled(t,e)})}qq.extend(this,{addHandler:function(e){o(e)},dispose:function(){n.dispose()}}),qq.extend(t,{getFileIdFromItem:function(e){return e.qqFileId},getDisposeSupport:function(){return n}}),qq.extend(i,e),i.attachTo&&o(i.attachTo)},qq.FileButtonsClickHandler=function(e){"use strict";var t={templating:null,log:function(e,t){},onDeleteFile:function(e){},onCancel:function(e){},onRetry:function(e){},onPause:function(e){},onContinue:function(e){},onGetName:function(e){}},n={cancel:function(e){t.onCancel(e)},retry:function(e){t.onRetry(e)},deleteButton:function(e){t.onDeleteFile(e)},pause:function(e){t.onPause(e)},continueButton:function(e){t.onContinue(e)}};qq.extend(t,e),t.eventType="click",t.onHandled=function(e,i){qq.each(n,function(n,o){var s,r=n.charAt(0).toUpperCase()+n.slice(1);if(t.templating["is"+r](e))return s=t.templating.getFileId(e),qq.preventDefault(i),t.log(qq.format("Detected valid file button click event on file '{}', ID: {}.",t.onGetName(s),s)),o(s),!1})},t.attachTo=t.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(t,{}))},qq.FilenameClickHandler=function(e){"use strict";var t={},n={templating:null,log:function(e,t){},classes:{file:"qq-upload-file",editNameIcon:"qq-edit-filename-icon"},onGetUploadStatus:function(e){},onGetName:function(e){}};qq.extend(n,e),n.eventType="click",n.onHandled=function(e,i){if(n.templating.isFileName(e)||n.templating.isEditIcon(e)){var o=n.templating.getFileId(e);n.onGetUploadStatus(o)===qq.status.SUBMITTED&&(n.log(qq.format("Detected valid filename click event on file '{}', ID: {}.",n.onGetName(o),o)),qq.preventDefault(i),t.handleFilenameEdit(o,e,!0))}},qq.extend(this,new qq.FilenameEditHandler(n,t))},qq.FilenameInputFocusInHandler=function(e,t){"use strict";var n={templating:null,onGetUploadStatus:function(e){},log:function(e,t){}};t||(t={}),n.eventType="focusin",n.onHandled=function(e,i){if(n.templating.isEditInput(e)){var o=n.templating.getFileId(e);n.onGetUploadStatus(o)===qq.status.SUBMITTED&&(n.log(qq.format("Detected valid filename input focus event on file '{}', ID: {}.",n.onGetName(o),o)),t.handleFilenameEdit(o,e))}},qq.extend(n,e),qq.extend(this,new qq.FilenameEditHandler(n,t))},qq.FilenameInputFocusHandler=function(e){"use strict";e.eventType="focus",e.attachTo=null,qq.extend(this,new qq.FilenameInputFocusInHandler(e,{}))},qq.FilenameEditHandler=function(e,t){"use strict";var n={templating:null,log:function(e,t){},onGetUploadStatus:function(e){},onGetName:function(e){},onSetName:function(e,t){},onEditingStatusChange:function(e,t){}};function i(e,t){var i,o=e.value;void 0!==o&&qq.trimStr(o).length>0&&(void 0!==(i=function(e){var t=n.onGetName(e);return qq.getExtension(t)}(t))&&(o=o+"."+i),n.onSetName(t,o)),n.onEditingStatusChange(t,!1)}qq.extend(n,e),n.attachTo=n.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(n,t)),qq.extend(t,{handleFilenameEdit:function(e,o,s){var r,a,l,u=n.templating.getEditInput(e);n.onEditingStatusChange(e,!0),u.value=(r=e,a=n.onGetName(r),(l=a.lastIndexOf("."))>0&&(a=a.substr(0,l)),a),s&&u.focus(),function(e,n){t.getDisposeSupport().attach(e,"blur",function(){i(e,n)})}(u,e),function(e,n){t.getDisposeSupport().attach(e,"keyup",function(t){13===(t.keyCode||t.which)&&i(e,n)})}(u,e)}})}}(window)}}]);