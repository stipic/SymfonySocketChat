(window.webpackJsonp=window.webpackJsonp||[]).push([["conversation"],{k6dk:function(n,t,e){(function(n){e("ng4s");var t=window.location.hostname,o=WS.connect("ws://"+t+":5510");o.on("socket/connect",function(t){function e(n){n.scrollTop=n.scrollHeight}e(document.getElementById("content"));var o={appendMessage:function(t){n("#org-msg-zone").append(t),e(document.getElementById("content"))},appendMessageChunk:function(t){console.log("CHUNK #1"),n("#org-msg-zone .message:last").find(".text").append(t),e(document.getElementById("content"))}};function i(i){t.subscribe(i,function(n,t){"msg_block"==t.msg.msgType?o.appendMessage(t.msg.template):o.appendMessageChunk(t.msg.template)}),t.subscribe(i+"/notifications",function(t,o){console.log(o);var i=JSON.parse(o),s='\n            <div class="message" data-writing="'+clientInformation.username+'">\n                <img class="avatar-md" src="/avatar.jpg" data-toggle="tooltip" data-placement="top" title="" alt="avatar" data-original-title="Keith">\n                <div class="text-main">\n                    <div class="text-group">\n                        <div class="text typing">\n                            <div class="wave">\n                                <span class="dot"></span>\n                                <span class="dot"></span>\n                                <span class="dot"></span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>';for(var a in n('[data-writing="'+clientInformation.username+'"]').remove(),i)i.hasOwnProperty(a)&&!n('[data-writing="'+clientInformation.username+'"]').length&&clientInformation.username!=a&&(n("#writing-notif-zone").append(s),e(document.getElementById("content")))})}n(document).on("click","#submit-message",function(e){e.preventDefault();var o=n("#form-message").val();o&&n.ajax({url:"/message/"+clientInformation.conversationId+"/new",type:"POST",data:{message:o},complete:function(n){}}),n("#form-message").val("").change(),n("#form-message").html(""),clientInformation.isWriting=!1,t.publish(clientInformation.wsConversationRoute+"/notifications",clientInformation.isWriting)}),document.getElementById("form-message").focus(),n(document).on("keypress","#form-message",function(t){13===t.keyCode&&(t.preventDefault(),n("#submit-message").trigger("click"),n("#form-message").val(""))}),n(document).on("input","#form-message",function(e){e.preventDefault();var o=n("#form-message").val();o.length>0&&0==clientInformation.isWriting?(clientInformation.isWriting=!0,t.publish(clientInformation.wsConversationRoute+"/notifications",clientInformation.isWriting)):0==o.length&&1==clientInformation.isWriting&&(clientInformation.isWriting=!1,t.publish(clientInformation.wsConversationRoute+"/notifications",clientInformation.isWriting))}),i(clientInformation.wsConversationRoute),n(document).on("click",".discussions li",function(o){o.preventDefault(),n(".discussions li").removeClass("active"),n(this).addClass("active");var s=n(this).attr("data-cid");window.history.pushState({foo:"bar"},"Conversation","/conversation/"+s),t.unsubscribe(clientInformation.wsConversationRoute),t.unsubscribe(clientInformation.wsConversationRoute+"/notifications"),clientInformation.wsConversationRoute="conversation/"+s,clientInformation.conversationId=s,i(clientInformation.wsConversationRoute),n.ajax({url:"/message/"+s+"/section",type:"GET",success:function(t){n("#msg-section").remove(),n(t).insertAfter("#sidebar"),e(document.getElementById("content"))}})}),t.subscribe("online",function(t,e){var o=JSON.parse(e);n("li[data-usid]").each(function(t){var e=n(this).attr("data-usid");for(var i in n('li[data-usid="'+e+'"]').find(".user-details").removeClass("online"),o)o.hasOwnProperty(i)&&i==e&&n('li[data-usid="'+e+'"]').find(".user-details").addClass("online")})}),console.log("Successfully Connected!")}),o.on("socket/disconnect",function(n){console.log("Disconnected for "+n.reason+" with code "+n.code)})}).call(this,e("EVdn"))}},[["k6dk","runtime",1,0]]]);